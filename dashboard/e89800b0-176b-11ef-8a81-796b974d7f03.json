{
  "entityType" : "DASHBOARD",
  "entity" : {
    "assignedCustomers" : null,
    "configuration" : {
      "description" : "Main app",
      "widgets" : {
        "a2487dca-2519-923b-63b0-086d190be70f" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "type",
                "type" : "entityField",
                "label" : "Type",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.6128556635205882
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1685462005597,
                  "endTimeMs" : 1685548405597
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#FFFFFF01",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "\n\n\n\nreturn `<div class=\"market-layout\" style=\"width: 100%; height: 100%; padding: 0;\" fxLayout=\"column\">\n    <div class=\"header-group\">\n        <div class=\"logo-tenant\">\n            <img src=\"https://vdms.tesacom.net/images/custom/logo/sullair.svg\" \n                alt=\"Sullair Argentina\" height=\"14\">\n        </div>\n        <div class=\"view-options\" >\n            <button id='view_map' mat-button color=\"primary\" matTooltip=\"Mapa\" >\n                <mat-icon >\n                    place\n                </mat-icon> Mapa\n            </button>\n            <button id='view_detail_machine' mat-button color=\"primary\" matTooltip=\"Listado\" >\n                <mat-icon >\n                    view_list\n                </mat-icon> Listado\n            </button>\n        </div>\n    </div> \n    <mat-divider></mat-divider>\n    <div fxFlex fxLayout=\"column\" style=\"width: 100%; height: 100%; padding: 0;\">\n        <tb-dashboard-state style=\"padding: 0;\" fxFlex *ngIf=\"!ctx.stateController.getStateParams()?.viewMap || ctx.stateController.getStateParams()?.viewMap ==='map'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_map\"></tb-dashboard-state>\n        <tb-dashboard-state fxFlex *ngIf=\"ctx.stateController.getStateParams()?.viewMap ==='detail'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_grid\"></tb-dashboard-state>\n        <tb-dashboard-state fxFlex *ngIf=\"ctx.stateController.getStateParams()?.viewMap ==='report'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_report\"></tb-dashboard-state>\n        <tb-dashboard-state fxFlex *ngIf=\"ctx.stateController.getStateParams()?.viewMap ==='report_time_series'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_report_time_series\"></tb-dashboard-state>\n    </div>\n</div>`\n\n// <button id='view_report' mat-button color=\"primary\" matTooltip=\"View Report\" >\n//             <mat-icon >\n//                 grid_on\n//             </mat-icon> Reporte\n//         </button>\n//         <button id='view_report_time_serie' mat-button color=\"primary\" matTooltip=\"View Report time series\" >\n//             <mat-icon >\n//                 grid_on\n//             </mat-icon> Reporte\n//         </button>",
              "applyDefaultMarkdownStyle" : true,
              "markdownCss" : ".market-layout{\n    background-color: transparent;\n}\n\n.header-group {\n    display: flex;\n    justify-content: space-between;\n    background: #008657;\n}\n.logo-tenant {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: transparent;\n    padding: 0px 10px;\n}\n.view-options {\n    z-index: 10;\n    padding: 0px 10px;\n    display: flex;\n    flex-direction: row;\n    gap: 0rem;\n    justify-content: flex-end;\n    align-items: flex-end;\n    background-color: transparent;\n}\n\n.view-options > button {\n    color: white;\n}\n\n.view-options > div {\n    border-radius: 50%;\n    max-width: 2rem;\n    max-height: 2rem;\n    width:100%;\n    height: 100%;\n    padding:.25rem;\n    background-color:#22222239;\n    cursor: pointer;\n}"
            },
            "title" : "View container",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem",
              "padding" : "0"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "enableDataExport" : false,
            "widgetCss" : "",
            "noDataDisplayMessage" : "",
            "actions" : {
              "elementClick" : [ {
                "name" : "view_detail_machine",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\nconsole.log(\"clicklist=>\",widgetContext.stateController.getStateId())\n\nconsole.log(\"Params map=>\", params)\n\nconst hydrateParams = {...params, viewMap:\"detail\"}\n\nwidgetContext.stateController.updateState(null, hydrateParams)",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "52c34d86-3391-2899-b6b3-180a5d44722d"
              }, {
                "name" : "view_report",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\nconsole.log(\"clicklist=>\",widgetContext.stateController.getStateId())\n\n// console.log(\"Params map=>\", params)\n\nconst hydrateParams = {...params, viewMap:\"report\"}\n\nwidgetContext.stateController.updateState(null, hydrateParams)",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "8589b442-3351-271a-49eb-3c12baf2ee09"
              }, {
                "name" : "view_map",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\nconsole.log(\"clicklist=>\",widgetContext.stateController.getStateId())\n\nconsole.log(\"Params map=>\", params)\n\nconst hydrateParams = {...params, viewMap:\"map\"}\n\nwidgetContext.stateController.updateState(null, hydrateParams)",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "c2dfed96-e724-af62-dfe8-a5bb751feada"
              }, {
                "name" : "view_report_time_serie",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\nconsole.log(\"clicklist=>\",widgetContext.stateController.getStateId())\n\n// console.log(\"Params map=>\", params)\n\nconst hydrateParams = {...params, viewMap:\"report_time_series\"}\n\nwidgetContext.stateController.updateState(null, hydrateParams)",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "0e81d8b2-7372-fdb8-98c3-771c74d39ca6"
              } ]
            },
            "pageSize" : 1024,
            "useDashboardTimewindow" : true
          },
          "row" : 0,
          "col" : 0,
          "id" : "a2487dca-2519-923b-63b0-086d190be70f"
        },
        "af660201-4530-a4c2-29d9-f81ea94f331e" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "type",
                "type" : "entityField",
                "label" : "type",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.13929703663266224,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "Name",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.643985534902711
              }, {
                "name" : "deviceType",
                "type" : "attribute",
                "label" : "deviceType",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.8044120986511722,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1691322068047,
                  "endTimeMs" : 1691408468047
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "const params = ctx.stateController.getStateParams();\n// console.log(\"DetailParams=>\", params)\n\n\nconst typeMachine = ['ClearSkyClient',\n    'MicroTRACKClient',\n    'JDeereClient',\n    'JCBClient',\n    'ScaniaClient',\n    'VolvoClient',\n    'KomatsuClient',\n    'SMART_ONE_C'\n]\n\nconst dictionaryTypeMachine = {\n        'ClearSkyClient': \"ClearSky\",\n        'MicroTRACKClient': \"MicroTRACK\",\n        'JDeereClient': \"JDeere\",\n        'JCBClient': 'JCB',\n        'ScaniaClient': \"Scania\",\n        \"VolvoClient\":\"Volvo\",\n        KomatsuClient:\"Komatsu\",\n        'SMART_ONE_C': \"SMARTONE C\",\n    }\n\nconst isMachine = typeMachine.includes(data[0]['DataOrigin']);\n// console.log(\"data[0]\",data[0])\n\nconst isDevice = data[0]['entityType'] === 'DEVICE';\n\nconst isDeviceWithType = isDevice && typeMachine.includes(\n    data[0]['DataOrigin']);\n\n// console.log(\"TypeDevice=>\", data)\n\n///--- General views ---///\n\nconst generalDashboardStates = {\n    ClearSkyClient: 'detail_default_general',\n    'JCBClient' : 'detail_default_general',\n    'MicroTRACKClient': 'detail_default_general',\n    'JDeereClient': 'detail_default_general',\n    'ScaniaClient': 'detail_default_general',\n    'VolvoClient':'detail_default_general',\n    'KomatsuClient': 'detail_default_general',\n    'SMART_ONE_C': 'detail_default_general',\n}\n\n///--- Utilization views ---///\n\nconst utilizationDashboardStates = {\n    ClearSkyClient: 'detail_default_monitoring',\n    'JCBClient' : 'detail_default_monitoring',\n    'MicroTRACKClient': 'detail_default_monitoring',\n    'JDeereClient': 'detail_default_monitoring',\n    'ScaniaClient': 'detail_default_monitoring',\n    'VolvoClient':'detail_default_monitoring',\n    'KomatsuClient': 'detail_default_monitoring',\n    'SMART_ONE_C': 'detail_default_monitoring',\n}\n\n///--- Alarm Views ---///\n\nconst alarmsDashboardStates = {\n    ClearSkyClient: 'detail_default_alarms',\n    'JCBClient' : 'detail_default_alarms',\n    'MicroTRACKClient': 'detail_default_alarms',\n    'JDeereClient': 'detail_default_alarms',\n    'ScaniaClient': 'detail_default_alarms',\n    'VolvoClient':'detail_default_alarms',\n    'KomatsuClient': 'detail_default_alarms',\n    'SMART_ONE_C': 'detail_default_alarms',\n}\n\nlet generalStateId = '',\n    utilizationStateId = '',\n    historyStateId = '',\n    alarmStateId = '';\n\nif (isMachine && !isDevice) {\n    generalStateId = generalDashboardStates[data[0]['DataOrigin']]\n    utilizationStateId = utilizationDashboardStates[data[0][\n        'type'\n    ]]\n\n    alarmStateId = alarmsDashboardStates[data[0]['DataOrigin']]\n}\n\nif (!isMachine && isDevice) {\n    generalStateId = 'detail_default_general'\n    utilizationStateId = 'detail_default_monitoring'\n    alarmStateId = 'detail_default_alarms'\n}\n\nif (!isMachine && isDeviceWithType) {\n    generalStateId = generalDashboardStates[data[0][\n        'DataOrigin'\n    ]]\n    utilizationStateId = utilizationDashboardStates[data[0][\n        'DataOrigin'\n    ]]\n\n    alarmStateId = alarmsDashboardStates[data[0][\n        'DataOrigin'\n    ]]\n}\n\n\nconst indexsTabs = {\n    general: 0,\n    utilization: 1,\n    alarms: 2,\n    history: 3\n}\n\nlet indextTab = 0\n\nif (params.showDescriptionAsset) {\n    indextTab = indexsTabs[params.showDescriptionAsset.view]\n}\n\n// console.log(\"DataMon=>\", isMachine, generalStateId,\n//     utilizationStateId, historyStateId, alarmStateId)\n\nconst templateOneMachine = `<div class=\"navbar-layout\">\n    <div>\n      <div class='navbar'>\n        <mat-tab-group mat-stretch-tabs=\"false\" mat-align-tabs=\"start\" [selectedIndex]=${indextTab} >\n          <mat-tab>\n            <ng-template mat-tab-label  >\n              <span class=\"navbar-item\" id='general_button'>General</span>\n            </ng-template>\n            <ng-template matTabContent style=\"flex:1;\" >\n              <div class=\"content-detail\" fxLayout=\"column\">\n                <tb-dashboard-state class=\"general-view\" fxFlex\n                  *ngIf=\"(!ctx?.stateController.getStateParams().showDescriptionAsset?.view) || ctx?.stateController.getStateParams().showDescriptionAsset?.view==='general'\"\n                  [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"${generalStateId}\"></tb-dashboard-state>\n              </div>\n            </ng-template>\n          </mat-tab>\n          <mat-tab>\n            <ng-template mat-tab-label>\n              <span class=\"navbar-item\" id='general_button'>Monitoreo</span>\n            </ng-template>\n            <ng-template matTabContent>\n              <div class=\"content-utilization\" fxLayout=\"column\">\n                <tb-dashboard-state fxFlex\n                  *ngIf=\"ctx?.stateController.getStateParams().showDescriptionAsset?.view==='utilization'\" [ctx]=\"ctx\"\n                  [syncParentStateParams]=\"true\" stateId=\"${utilizationStateId}\"></tb-dashboard-state>\n              </div>\n            </ng-template>\n          </mat-tab>\n          <mat-tab>\n            <ng-template mat-tab-label>\n              <span class=\"navbar-item\" id='general_button'>Alarmas</span>\n            </ng-template>\n            <ng-template matTabContent>\n              <div class=\"content-alarms\" fxLayout=\"column\">\n                <tb-dashboard-state fxFlex\n                  *ngIf=\"ctx?.stateController.getStateParams().showDescriptionAsset?.view==='alarms'\" [ctx]=\"ctx\"\n                  [syncParentStateParams]=\"true\" stateId=\"${alarmStateId}\"></tb-dashboard-state>\n              </div>\n            </ng-template>\n          </mat-tab>\n        </mat-tab-group>\n      </div>\n    </div>\n  </div>`\n\nconst templateGrid = `<div   class=\"navbar-layout\" >\n        Select device\n    </div>`\n\n\nreturn (isMachine || isDevice) ? templateOneMachine :\n    templateGrid",
              "applyDefaultMarkdownStyle" : false,
              "markdownCss" : ".market-layout{\n  background-color: #eee;\n}\n\n\n.navbar-item {\n    position: absolute;\n    width: 90px;\n    height: 100%;\n    left: -45px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.mdc-tab__content{\n    padding: 0;\n}\n\n\n.navbar-layout {\n    /*height: 4.5rem;*/\n    background-color: #eee;\n    pointer-events: all;\n    border-radius: 0;\n    height: -moz-available;          /* WebKit-based browsers will ignore this. */\n    height: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */\n    height: fill-available;\n    padding:0;\n}\n\n.navbar-layout > div {\n    height: 100%;\n}\n\n.navbar {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-start;\n    gap:.75rem;\n     height: 100%;\n}\n\n.content-detail{\n    width: 100vw; \n    height: 100vh; \n    padding: 0; \n    max-width: -moz-available; \n    max-width: -webkit-fill-available; \n    max-height: -moz-available;\n    max-height: -webkit-fill-available;\n    min-height: 1560px;\n    flex:1;\n}\n\n.content-utilization{\n    width: 100vw; \n    height: 75vh; \n    padding: 0; \n    max-width: -moz-available; \n    max-width: -webkit-fill-available; \n    /*max-height: -webkit-fill-available;*/\n    /*min-height: 500px;*/\n}\n\n.content-alarms{\n    width: 100vw; \n    height: 75vh; \n    padding: 0; \n    max-width: -webkit-fill-available;\n    max-width: -moz-available; \n    max-height: -moz-available; \n    max-height: -webkit-fill-available;\n}\n\n.content-history{\n    width: 100vw; \n    height: 80vh; \n    padding: 0; \n    max-width: -webkit-fill-available; \n    max-width: -moz-available; \n    max-height: -moz-available;\n    max-height: -webkit-fill-available;\n}\n\n.mat-divider {\n\tdisplay: block;\n\tmargin: 0;\n\tborder-top-style: solid;\n\tborder-top-color: rgba(0, 0, 0, .12);\n\tborder-top-width: 1px;\n}\n\n\n\n.general-view{\n    background-color: #fff;\n}\n\n@media screen and (min-width: 1200px) {\n    .content-detail{ \n        height: 100vh;\n        min-height: 1560px;\n    }\n    \n    .content-utilization{\n        height: 75vh; \n        /*min-height: 500px;*/\n    }\n\n}\n\n@media screen and (min-width: 1536px) {\n    .content-detail{ \n        height: 100vh; \n        min-height: 1560px;\n    }\n    \n    .content-utilization{\n        height: 75vh; \n        /*min-height: 500px;*/\n    }\n\n}"
            },
            "title" : "switch container",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : false,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "backgroundColor" : "#fff",
              "padding" : "0",
              "height" : "-webkit-fill-available"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : "",
            "actions" : {
              "elementClick" : [ {
                "name" : "general_button",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "$event.stopPropagation()\nconst params = widgetContext.stateController.getStateParams();\nconst actualState = widgetContext.stateController.getStateId()\n\n// console.log(\"$event=>\",$event  )\n\n\nconst value = removeAccents($event.srcElement.innerText.toLowerCase())\n\n\nconst viewDictionary = {\n    general:\"general\",\n    monitoreo:\"utilization\",\n    alarmas:'alarms',\n    historial:'history'\n    \n}\nconst view = viewDictionary[value]\n\nparams['showDescriptionAsset'] = {...params['showDescriptionAsset'], view};\n// widgetContext.stateController.updateStateParam(actualState, params);\nwidgetContext.updateWidgetParams(actualState, params);\n\n// widgetContext.detectContainerChanges()\n\n// widgetContext.updateWidgetParams(actualState, params);\n\n// console.log(\"PostDetetChange=>\"  )\n\nfunction removeAccents(text) {\n  const sustitutions = {\n    àáâãäå: \"a\",\n    ÀÁÂÃÄÅ: \"A\",\n    èéêë: \"e\",\n    ÈÉÊË: \"E\",\n    ìíîï: \"i\",\n    ÌÍÎÏ: \"I\",\n    òóôõö: \"o\",\n    ÒÓÔÕÖ: \"O\",\n    ùúûü: \"u\",\n    ÙÚÛÜ: \"U\",\n  };\n  // Devuelve un valor si 'letter' esta incluido en la clave\n  function getLetterReplacement(letter, replacements) {\n    const findKey = Object.keys(replacements).reduce(\n      (origin, item, index) => (item.includes(letter) ? item : origin),\n      false\n    );\n    return findKey !== false ? replacements[findKey] : letter;\n  }\n  // Recorre letra por letra en busca de una sustitución\n  return text\n    .split(\"\")\n    .map((letter) => getLetterReplacement(letter, sustitutions))\n    .join(\"\");\n}",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "4889bd3e-ea86-75f7-e599-e05c52f0f8f2"
              } ]
            },
            "useDashboardTimewindow" : true
          },
          "row" : 0,
          "col" : 0,
          "id" : "af660201-4530-a4c2-29d9-f81ea94f331e"
        },
        "daca4f4d-fa6e-c376-a988-05cb822fcc1f" : {
          "isSystemType" : true,
          "bundleAlias" : "maps_v2",
          "typeAlias" : "openstreetmap",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 8.5,
          "sizeY" : 6,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "latitude",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.620810688014624,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : false,
                "postFuncBody" : null
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "longitude",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.7769026643282235,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : false,
                "postFuncBody" : null
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.954323649973533
              }, {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "horometer",
                "color" : "#ffc107",
                "settings" : { },
                "_hash" : 0.07811159531135092,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "internalName",
                "color" : "#607d8b",
                "settings" : { },
                "_hash" : 0.35198868496815505
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.9681447264723719
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1691350680914,
                  "endTimeMs" : 1691437080914
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "provider" : "openstreet-map",
              "mapProvider" : "OpenStreetMap.Mapnik",
              "useCustomProvider" : false,
              "customProviderTileUrl" : "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
              "latKeyName" : "latitude",
              "lngKeyName" : "longitude",
              "xPosKeyName" : "xPos",
              "yPosKeyName" : "yPos",
              "defaultZoomLevel" : 0,
              "defaultCenterPosition" : "0,0",
              "disableScrollZooming" : true,
              "disableDoubleClickZooming" : true,
              "disableZoomControl" : true,
              "fitMapBounds" : true,
              "useDefaultCenterPosition" : false,
              "mapPageSize" : 16384,
              "markerOffsetX" : 0.5,
              "markerOffsetY" : 1,
              "draggableMarker" : false,
              "showLabel" : false,
              "showTooltip" : false,
              "color" : "#fe7569",
              "useColorFunction" : false,
              "useMarkerImageFunction" : true,
              "markerImageFunction" : "const url = \"https://qr.twindimension.com/api/marker\"\n\nlet urlIcon = `${url}?color=${data.active==\"true\"?'66cc12':'b8b6b6'}`\n\nif(isJson(data.img)){\n    urlIcon = `${urlIcon}&name=${JSON.parse(data.img).name?JSON.parse(data.img).name.replace(\".png\",''):'default'}`\n    return {\n        url:urlIcon,\n        size:40\n    }\n}\n\nreturn {\n    url: urlIcon,\n    size:40\n}\n\n// var type = dsData[dsIndex]['Type'];\n// if (type == 'thermometer') {\n// \tvar res = {\n// \t    url: images[0],\n// \t    size: 40\n// \t}\n// \tvar temperature = dsData[dsIndex]['temperature'];\n// \tif (typeof temperature !== undefined) {\n// \t    var percent = (temperature + 60)/120;\n// \t    var index = Math.min(3, Math.floor(4 * percent));\n// \t    res.url = images[index];\n// \t}\n// \treturn res;\n// }\n\n\nfunction isJson(text){\n  try {\n    JSON.parse(text);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}",
              "markerImages" : [ "data:image/png;base64,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", "data:image/png;base64,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", "data:image/png;base64,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", "data:image/png;base64,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" ],
              "showPolygon" : false,
              "polygonKeyName" : "perimeter",
              "editablePolygon" : false,
              "showPolygonLabel" : false,
              "usePolygonLabelFunction" : false,
              "polygonLabel" : "${entityName}",
              "showPolygonTooltip" : false,
              "showPolygonTooltipAction" : "click",
              "autoClosePolygonTooltip" : true,
              "usePolygonTooltipFunction" : false,
              "polygonTooltipPattern" : "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
              "polygonColor" : "#3388ff",
              "polygonOpacity" : 0.2,
              "usePolygonColorFunction" : false,
              "polygonStrokeColor" : "#3388ff",
              "polygonStrokeOpacity" : 1,
              "polygonStrokeWeight" : 3,
              "usePolygonStrokeColorFunction" : false,
              "showCircle" : false,
              "circleKeyName" : "perimeter",
              "editableCircle" : false,
              "showCircleLabel" : false,
              "useCircleLabelFunction" : false,
              "circleLabel" : "${entityName}",
              "showCircleTooltip" : false,
              "showCircleTooltipAction" : "click",
              "autoCloseCircleTooltip" : true,
              "useCircleTooltipFunction" : false,
              "circleTooltipPattern" : "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
              "circleFillColor" : "#3388ff",
              "circleFillColorOpacity" : 0.2,
              "useCircleFillColorFunction" : false,
              "circleStrokeColor" : "#3388ff",
              "circleStrokeOpacity" : 1,
              "circleStrokeWeight" : 3,
              "useCircleStrokeColorFunction" : false,
              "useClusterMarkers" : false,
              "zoomOnClick" : true,
              "maxClusterRadius" : 80,
              "animate" : true,
              "spiderfyOnMaxZoom" : false,
              "showCoverageOnHover" : true,
              "chunkedLoading" : false,
              "removeOutsideVisibleBounds" : true,
              "useIconCreateFunction" : false
            },
            "title" : "Mini map",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : true,
            "showLegend" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "actions" : { },
            "showTitleIcon" : false,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "daca4f4d-fa6e-c376-a988-05cb822fcc1f"
        },
        "954e4e7b-5605-94cf-fcb3-2fe51a5b6e36" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "latitude",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.7190517552464497,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : false,
                "postFuncBody" : null
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "longitude",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.7377046465325054,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : false,
                "postFuncBody" : null
              }, {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "horometer",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.9391018099286941,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return round10(value,-4);\n\nfunction decimalAdjust(type, value, exp) {\n  type = String(type);\n  if (![\"round\", \"floor\", \"ceil\"].includes(type)) {\n    return value\n  }\n  exp = Number(exp);\n  value = Number(value);\n  if (exp % 1 !== 0 || Number.isNaN(value)) {\n    return NaN;\n  } else if (exp === 0) {\n    return Math[type](value);\n  }\n  const [magnitude, exponent = 0] = value.toString().split(\"e\");\n  const adjustedValue = Math[type](`${magnitude}e${exponent - exp}`);\n  // Shift back\n  const [newMagnitude, newExponent = 0] = adjustedValue.toString().split(\"e\");\n  return Number(`${newMagnitude}e${+newExponent + exp}`);\n}\n\nfunction round10  (value, exp){ return decimalAdjust(\"round\", value, exp)}"
              }, {
                "name" : "ExtPowInputQualifiedValue",
                "type" : "timeseries",
                "label" : "Encendido",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.5806871875191875,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return value == 'ON';"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1692906621075,
                  "endTimeMs" : 1692993021075
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "console.log(\"dataCards=>\", data)\n\nconst machine = data[0]\n\nconst teleAttPriority = {\n    position: {\n        label: \"Posicion\",\n        keys: [\"latitude\", \"longitude\"],\n        matIcon: \"place\",\n        unit: \"\",\n        separator: ' : ',\n        isGoogleMap: true\n    },\n    power: {\n        label: \"Potencia (real)\",\n        keys: [\"POT\", \"PREACT\"],\n        matIcon: \"flash_auto\",\n        unit: \"(Kw - Kva)\",\n        separator: ' - '\n    },\n    utilization: {\n        label: \"Horómetro\",\n        keys: [\"horometer\"],\n        matIcon: \"schedule\",\n        unit: \"hrs\"\n    },\n    speed: {\n        label: \"Velocidad\",\n        keys: [\"speed\"],\n        matIcon: \"speed\",\n        unit: \"km/hrs\"\n    },\n    onOff: {\n        label: \"Encendido\",\n        keys: [\"Encendido\"],\n        matIcon: ['toggle_on', 'toggle_off'],\n        isBoolean: true,\n        unit: \"\"\n    },\n    fuelUsed: {\n        label: \"Combustible usado\",\n        keys: ['fuelUsed'],\n        matIcon: 'opacity',\n        unit: \"lts\"\n    },\n    slowism: {\n        label: \"Relentismo\",\n        keys: ['slowism'],\n        matIcon: 'slow_motion_video',\n        unit: \"hrs\"\n    },\n    temperature: {\n        label: \"Temperatura\",\n        keys: ['TEMP'],\n        matIcon: 'thermostat',\n        unit: \"°C\"\n    }\n\n}\n\n\nlet arrCard = []\n\nlet arrTs = []\n\nfor (const prop in teleAttPriority) {\n\n    const {\n        label,\n        keys,\n        matIcon,\n        isBoolean,\n        unit,\n        separator,\n        isGoogleMap\n    } = teleAttPriority[prop];\n    // console.log(\"teleAttPriority=>\", label, keys, matIcon, isBoolean)\n\n\n    const value = keys.map((el) => machine[el])\n\n\n    // console.log(\"Value=>\", value)\n\n    if (!value.some((el) => typeof el === 'undefined')) {\n\n\n\n\n        const icon = isBoolean ? matIcon[value[0] ? 0 : 1] :\n            matIcon\n\n        let htmlTemplate = `<div class='card'>\n                                <div class='content'>\n                                    <div class='column full-width center mat-typography'>\n                                        <div class='row' >\n                                        <mat-icon class=\"material-icons\"  aria-hidden=\"false\" aria-label=\"Example home icon\" fontIcon=${icon}></mat-icon>\n                                        <h5 class=\"title-value\" style=\"margin-bottom:0rem; font-weight:500;\" matTooltip=\"${label}\" matTooltipPosition=\"above\"  >${label}:</h5>\n                                        </div>\n                                        ${!isGoogleMap \n                                        ? `<div class='value'>\n                                            <p style=\"margin-bottom:0rem;\" class=\"mat-headline-5 text-value\" matTooltip=\"${Array.isArray(value)? value.join(separator): value}\">${Array.isArray(value)? value.join(separator) : value} ${unit || ''}</p>\n                                        </div>`\n                                        : `<a class='value' target=\"blank\" href=\"https://maps.google.com/maps?q=${value.join(\",\")}\" >\n                                            <p style=\"margin-bottom:0rem;\" class=\"mat-headline-5 text-value\" matTooltip=\"Ver en Google Maps\">${Array.isArray(value)? value.map((val)=>round10(val,-4)).join(separator): value}</p>\n                                        </a>` }   \n                                    </div>\n                                </div>\n                            </div>`\n\n\n\n        arrCard = [...arrCard, htmlTemplate]\n\n        const tsValue = keys.map((el) => machine[\n            `${el}|ts`]);\n\n        arrTs = [...arrTs, ...tsValue]\n    };\n\n}\n\nconst lastTs = Math.max(...arrTs)\n\nreturn `\n    <div class=\"container\">\n        <div><p><b>Información reportada el ${lastTs? new Date(lastTs).toLocaleString('es-Ln', {\n              year: 'numeric',\n              month: 'numeric',\n              hour: 'numeric',\n\n              minute: 'numeric',\n              day: 'numeric',\n            }): '' }</b></p></div>\n        <div class=\"container-cards\" >\n            ${arrCard.join(\"\")}\n        </div>\n        <tb-dashboard-state class=\"tables-att\" fxFlex [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"telemetry_table_default\"></tb-dashboard-state>\n    </div>`;\n\nfunction decimalAdjust(type, value, exp) {\n    type = String(type);\n    if (![\"round\", \"floor\", \"ceil\"].includes(type)) {\n        return value\n    }\n    exp = Number(exp);\n    value = Number(value);\n    if (exp % 1 !== 0 || Number.isNaN(value)) {\n        return NaN;\n    } else if (exp === 0) {\n        return Math[type](value);\n    }\n    const [magnitude, exponent = 0] = value.toString()\n        .split(\"e\");\n    const adjustedValue = Math[type](\n        `${magnitude}e${exponent - exp}`);\n    // Shift back\n    const [newMagnitude, newExponent = 0] = adjustedValue\n        .toString().split(\"e\");\n    return Number(`${newMagnitude}e${+newExponent + exp}`);\n}\n\nfunction round10(value, exp) {\n    return decimalAdjust(\"round\", value, exp)\n}",
              "applyDefaultMarkdownStyle" : true,
              "markdownCss" : ".container{\n    width: 100%;\n    height: 100%;\n    background-color: #eee;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: flex-start;\n    gap:.5rem;\n    padding: 0 0 0;\n}\n\n.tables-att{\n    /*max-height: 1000px;*/\n    height: 100%;\n    flex:1;\n}\n\n.container-cards{\n    width: 100%;\n    display:grid;\n    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n    justify-items: center;\n    align-items: center;\n    justify-content:center;\n    grid-auto-rows: 1fr;\n    gap: .5rem .1rem;\n    padding: 0 0.25rem;\n}\n\n\n.card {\n   width: 100%;\n   max-width: 180px;\n   height: 100%;\n   min-height: 80px;\n   /*border: 2px solid #ccc;*/\n   box-sizing: border-box;\n   border-radius: .75rem;\n   background-color: #fff;\n   box-shadow: 0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;\n}\n\n.card .content {\n   padding: 0.25rem;\n   display: flex;\n   flex-direction: row;\n   align-items: center;\n   justify-content: center;\n   height: 100%;\n   box-sizing: border-box;\n}\n\n.card .content .column {\n   display: flex;\n   flex-direction: column;    \n   justify-content: center;\n   height: 100%;\n   flex:1;\n}\n\n.row {\n    display: flex;\n   flex-direction: row;\n   align-items: center;\n   gap:.5rem;\n   /*flex-wrap: wrap;*/\n}\n\n.column {\n   display: flex;\n   flex-direction: column;\n   align-items: center;\n   gap:.5rem; \n}\n\n.full-width {\n    width: 100%;\n}\n\n.space-between {\n    justify-content: space-between;\n}\n\n.center {\n    justify-content: center;\n}\n\n.material-icons {\n    font-size: 1.5rem;\n    color:#6C63FF;\n    width: 1.55rem;\n    height: 1.5rem;\n}\n\n.value {\n    display: flex;\n    flex-direction: column;    \n    /*justify-content: center;*/\n    align-items: center;\n    gap:.5rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.value >p {\n    /*display:flex;*/\n    /*justify-content: center;*/\n    text-align: center;\n    margin:0;\n}\n\n\n.card .description {\n    font-size: 20px;\n    color: #999;\n}\n\n.title-value{\n    max-width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.text-value{\n    max-width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    margin-top: 0 !important;\n}"
            },
            "title" : "New Markdown/HTML Card",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : false,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "useDashboardTimewindow" : true,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "954e4e7b-5605-94cf-fcb3-2fe51a5b6e36"
        },
        "01bc3ab6-adf2-3321-7570-67b83df8f5f0" : {
          "isSystemType" : true,
          "bundleAlias" : "alarm_widgets",
          "typeAlias" : "alarms_table",
          "type" : "alarm",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 10.5,
          "sizeY" : 6.5,
          "config" : {
            "timewindow" : {
              "realtime" : {
                "interval" : 1000,
                "timewindowMs" : 86400000
              },
              "aggregation" : {
                "type" : "NONE",
                "limit" : 200
              }
            },
            "showTitle" : true,
            "backgroundColor" : "rgb(255, 255, 255)",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "enableSelection" : true,
              "enableSearch" : true,
              "displayDetails" : true,
              "allowAcknowledgment" : true,
              "allowClear" : true,
              "allowAssign" : true,
              "displayActivity" : true,
              "displayPagination" : true,
              "defaultPageSize" : 10,
              "defaultSortOrder" : "-createdTime",
              "enableSelectColumnDisplay" : true,
              "enableStickyAction" : false,
              "enableFilter" : true
            },
            "title" : "New Alarms table",
            "dropShadow" : true,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400,
              "padding" : "5px 10px 5px 10px"
            },
            "useDashboardTimewindow" : false,
            "showLegend" : false,
            "alarmSource" : {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "2ee511d4-4bb1-9250-3c88-44f2accf70c6",
              "dataKeys" : [ {
                "name" : "createdTime",
                "type" : "alarm",
                "label" : "Created time",
                "color" : "#2196f3",
                "settings" : {
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : false,
                  "cellContentFunction" : ""
                },
                "_hash" : 0.021092237451093787
              }, {
                "name" : "originator",
                "type" : "alarm",
                "label" : "Originator",
                "color" : "#4caf50",
                "settings" : {
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : false,
                  "cellContentFunction" : ""
                },
                "_hash" : 0.2780007688856758
              }, {
                "name" : "type",
                "type" : "alarm",
                "label" : "Type",
                "color" : "#f44336",
                "settings" : {
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : false,
                  "cellContentFunction" : ""
                },
                "_hash" : 0.7323586880398418
              }, {
                "name" : "severity",
                "type" : "alarm",
                "label" : "Severity",
                "color" : "#ffc107",
                "settings" : {
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : false
                },
                "_hash" : 0.09927019860088193
              }, {
                "name" : "status",
                "type" : "alarm",
                "label" : "Status",
                "color" : "#607d8b",
                "settings" : {
                  "useCellStyleFunction" : false,
                  "cellStyleFunction" : "",
                  "useCellContentFunction" : false,
                  "cellContentFunction" : ""
                },
                "_hash" : 0.6588418951443418
              }, {
                "name" : "assignee",
                "type" : "alarm",
                "label" : "Assignee",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.5008441077416634
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            },
            "alarmsPollingInterval" : 5,
            "showTitleIcon" : false,
            "titleIcon" : "more_horiz",
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "displayTimewindow" : true,
            "actions" : { },
            "datasources" : [ ],
            "alarmFilterConfig" : {
              "statusList" : [ ],
              "severityList" : [ ],
              "typeList" : [ ],
              "searchPropagatedAlarms" : false
            },
            "enableDataExport" : true,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "01bc3ab6-adf2-3321-7570-67b83df8f5f0"
        },
        "234ee92b-317f-4aa6-0666-ece734898b21" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "materialIcon",
                "type" : "attribute",
                "label" : "materialIcon",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.5754780949646505
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "name",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.876542488899027,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "model",
                "type" : "attribute",
                "label" : "model",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.7540327256060237
              }, {
                "name" : "type",
                "type" : "entityField",
                "label" : "Type",
                "color" : "#a34ac3",
                "settings" : { },
                "_hash" : 0.8804413988512712
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.07153554549944419
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#455a64",
                "settings" : { },
                "_hash" : 0.9938750626713542,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "client",
                "type" : "attribute",
                "label" : "client",
                "color" : "#d50000",
                "settings" : { },
                "_hash" : 0.6725067495662933
              }, {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "internalName",
                "color" : "#009688",
                "settings" : { },
                "_hash" : 0.8020317556249801
              }, {
                "name" : "buildingSite",
                "type" : "attribute",
                "label" : "buildingSite",
                "color" : "#795548",
                "settings" : { },
                "_hash" : 0.32374814042780486
              }, {
                "name" : "brand",
                "type" : "attribute",
                "label" : "brand",
                "color" : "#795548",
                "settings" : { },
                "_hash" : 0.592721101530574
              }, {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "DataOrigin",
                "color" : "#00bcd4",
                "settings" : { },
                "_hash" : 0.2965068976289791
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            }, {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "f45aaaea-6d34-fd34-3586-fbc04f3b37fb",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "type",
                "type" : "entityField",
                "label" : "Type",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.684368764195797,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "Name",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.3654932544696443,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "whiteLabelParams",
                "type" : "attribute",
                "label" : "whiteLabelParams",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.519748225226
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1685364519342,
                  "endTimeMs" : 1685450919342
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "let $injector = ctx.$scope.$injector;\nlet $scope = ctx.$scope\nlet customDialog = $injector.get(ctx.servicesMap.get(\n    'customDialog'));\nlet entityService = $injector.get(ctx.servicesMap.get(\n    'entityService'));\nlet assetService = $injector.get(ctx.servicesMap.get(\n    'assetService'));\nlet deviceService = $injector.get(ctx.servicesMap.get(\n    'deviceService'));\nlet attributeService = $injector.get(ctx.servicesMap.get(\n    'attributeService'));\nlet entityRelationService = $injector.get(\n    ctx.servicesMap.get('entityRelationService')\n);\n\n\nconst machine = data.find((el) => {\n    return el['entityType'] === 'DEVICE';\n});\n\n// console.log(\"DetailMediunGenerator=>\", data)\n\nif (!machine) return 'Cargando...';\n\n\nlet html = \"Cargando...\"\n\nasyncHtml()\n    .then((res) => {\n        html = res;\n        $scope.markdownWidget.markdownText = html\n        $scope.markdownWidget.cd.detectChanges()\n\n\n    })\n\n\n\n    .catch((err) => console.log(\"ErrorHtml=>\", err))\n\n\nreturn html\n\nasync function asyncHtml() {\n    let hydrateAllData = []\n\n    for (var i = data.length; i--;) {\n        const element = data[i];\n        const hydrateData = await getEntityInfo({\n            id: {\n                id: element.entityId,\n                entityType: element.entityType\n            }\n        }, 1)\n        hydrateAllData = [...hydrateAllData, {\n            ...hydrateData,\n            data: element\n        }]\n    }\n\n\n\n    const lastRelations = hydrateAllData.filter((el) =>\n        !el.haveParentNode)\n    const restRelations = hydrateAllData.filter((el) =>\n        el.haveParentNode)\n    // console.log(\"Relations=>\", lastRelations,\n        // restRelations)\n\n    let organizedRelations = []\n\n    for (var i = 0; i < lastRelations.length; i++) {\n        let relationChild = lastRelations[i]\n        let isNotLastChild = true\n        let organizedRelation = [relationChild]\n\n        do {\n            const child = restRelations.find((el) => el\n                .parentNode.some((parent) => parent\n                    .from.id === relationChild.data\n                    .entityId))\n\n\n            if (child) {\n                organizedRelation = [...\n                    organizedRelation, child\n                ]\n                relationChild = child\n                isNotLastChild = true\n            } else {\n                isNotLastChild = false\n            }\n\n        } while (isNotLastChild);\n        organizedRelations = [...organizedRelations,\n            organizedRelation\n        ]\n    }\n\n\n\n    const machine = data.find((el) => {\n        return el['entityType'] ===\n            'DEVICE';\n    });\n\n    const client = data.find((el) => {\n        return el['Type'] == 'CUSTOMER'\n    })\n\n    // const device = data.find((el) => {\n    //     return el.entityType == 'DEVICE'\n    // })\n\n    // const devices = data.filter((el) => {\n    //     return el.entityType == 'DEVICE'\n    // }).map((el) =>\n    //     `${el.Name} ( ${ el.active === 'true' ? '<b style=\"color:#4caf50\" >Activo</b>' :'<b style=\"color:#ff9800\" >Inactivo</b>'  } )`\n    // ).join(\" - \")\n\n\n\n    const relationTenant = organizedRelations.find((\n        arr) => !arr.some(el => el.data\n        .entityType === 'CUSTOMER'))\n    const relationCustomer = organizedRelations.find((\n        arr) => arr.some(el => el.data\n        .entityType === 'CUSTOMER'))\n\n    const onlyRelationName = relationTenant ?\n        relationTenant.filter((el) => el.data\n            .entityType != 'DEVICE').map(el => el.data\n            .Name).join(' -> ') : ''\n    const onlyRelationNameCustomer = relationCustomer ?\n        relationCustomer.filter(el => el.data\n            .entityType != 'CUSTOMER').map(el => el.data\n            .Name).join(' -> ') : ''\n\n\n    const materialIconMachine = {\n        'ClearSkyClient': \"memory\",\n        'MicroTRACKClient': \"memory\",\n        'JDeereClient': \"memory\",\n        'JCBClient': 'memory',\n        'ScaniaClient': \"memory\",\n        'VolvoClient': \"memory\",\n        KomatsuClient:\"memory\",\n        'SMART_ONE_C': \"memory\",\n        'default':'memory'\n    }\n\n    const dictionaryTypeMachine = {\n        'ClearSkyClient': \"ClearSky\",\n        'MicroTRACKClient': \"MicroTRACK\",\n        'JDeereClient': \"JDeere\",\n        'JCBClient': 'JCB',\n        'ScaniaClient': \"Scania\",\n        \"VolvoClient\":\"Volvo\",\n        KomatsuClient:\"Komatsu\",\n        'SMART_ONE_C': \"SMARTONE C\",\n    }\n\n    // console.log(\"Machine=>\", machine)\n    if (!machine) return 'Cargando...';\n\n    const deviceType = machine.DataOrigin ?\n        dictionaryTypeMachine[machine.DataOrigin] ?\n        dictionaryTypeMachine[machine.DataOrigin] :\n        machine.DataOrigin : ''\n\n    const titleHeader = machine.internalName ? machine\n        .internalName : machine.name\n\n    let img = {};\n    let IconMachine =\n        `<mat-icon >${materialIconMachine[machine.DataOrigin || 'default']}</mat-icon>`\n\n    if (isJson(machine.img)) {\n        img = JSON.parse(machine.img)\n\n        IconMachine =\n            `<div class=\"img_machine\" style=\"background-image:url(${img.src});\" ></div>`;\n    }\n\n    return `<div class='container' >\n<div fxLayout=\"column\" fxLayoutAlign=\"start stretch\" fxLayoutGap=\".5rem\" >\n    <div  fxLayout=\"row\" fxLayoutAlign=\"space-between center\" fxLayoutGap=\".5rem\" style=\"margin-bottom:0;\"   >\n        <div fxLayout=\"row\" fxLayoutAlign=\"start center\" fxLayoutGap=\".25rem\" style=\"margin-bottom:0; flex:1; max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\" >\n            ${IconMachine}\n            <h6>${titleHeader ? titleHeader : 'Maquina'} </h6> \n            ${machine.active === 'true' \n            ? `<div class=\"status-badge active-badge\">Active</div>`\n            : `<div class=\"status-badge inactive-badge\">Inactive</div>`}\n        </div>\n        <div class=\"actions-buttons\" >\n            <button color=\"primary\" mat-icon-button id=\"edit_asset\" class=\"button-small\" matTooltip=\"Editar Activo\" type=\"button\">\n                    <mat-icon >\n                        edit\n                    </mat-icon>\n            </button>\n        </div>\n      </div>\n      <mat-divider style=\"margin-top: 0px; margin-bottom: 10px;\"></mat-divider>\n    <div fxLayout=\"column\" fxLayoutAlign=\"start stretch\" fxLayoutGap=\"0\">\n      <p class=\"mat-small\" ><b>Nombre interno:</b> ${\n        machine.internalName ? machine.internalName : ''\n      }</p>\n      <p class=\"mat-small\" ><b>Numero de serie:</b> ${\n        machine.name ? machine.name : ''\n      }</p>\n      <p class=\"mat-small\" ><b>Tipo de activo:</b> ${\n        img.title ? img.title: ''\n      }</p>\n      <p class=\"mat-small\" ><b>Marca:</b> ${\n        machine.brand ? machine.brand : ''\n      }</p>\n      <p class=\"mat-small\" ><b>Modelo:</b> ${machine.model ? machine.model : ''}</p>\n      <p class=\"mat-small\" ><b>Profile:</b> ${machine.Type || 'Desconocido'}</p>\n      <p class=\"mat-small\" ><b>Origen de los datos:</b> ${deviceType}</p>\n      <mat-divider style=\"margin-top: 0px; margin-bottom: 10px;\"></mat-divider>\n      <p class=\"mat-small\" ><b>Alquilado a:</b> ${machine.client ? machine.client : 'Sin asignar'}</p>\n      <p class=\"mat-small\" ><b>Obra:</b> ${\n        machine.buildingSite ? machine.buildingSite : ''\n      }</p>\n      <p class=\"mat-small\" ><b>Flota:</b> ${onlyRelationName}</p>\n    </div>\n  </div>\n  </div>`;\n}\n    //   <p class=\"mat-small\" ><b>Organigrama cliente:</b> ${onlyRelationNameCustomer}</p>\n\n\nfunction getEntityInfo(node, level) {\n    return new Promise((res, rej) => {\n        ctx.rxjs\n            .forkJoin([\n                entityRelationService\n                .findInfoByFrom(node.id),\n                entityRelationService\n                .findInfoByTo(node.id),\n            ])\n            .subscribe((dataEntity) => {\n                const relationInfo = dataEntity[\n                    1].filter(\n                    (relation) => relation\n                    .from.entityType !=\n                    'USER'\n                );\n\n\n             \n\n                res({\n                    haveParentNode: !!\n                        relationInfo\n                        .length,\n                    parentNode: relationInfo,\n                    level: level,\n                });\n            });\n    });\n};\n\nfunction isJson(text) {\n    try {\n        JSON.parse(text);\n    } catch (err) {\n        return false;\n    }\n    return true;\n}\n",
              "applyDefaultMarkdownStyle" : true,
              "markdownCss" : ".container {\n    padding:1rem 1rem;\n}\n\n.icon_machine {\n    font-size: 2rem;\n    color:#6C63FF;\n    width:100%;\n    height: 100%;\n    max-width: 3rem;\n    max-height: 3rem;\n}\n\n.img_machine {\n    display: inline-block;\n    width: 34px;\n    height: 34px;\n    background-color: transparent;\n    background-repeat: no-repeat;\n    background-attachment: scroll;\n    background-position: center center;\n    background-size: 34px 34px;\n}\n\n.actions-buttons{\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap:.0rem;\n    \n}\n\n.mat-icon {\n    min-width: 24px;\n}\n\n.mat-small {\n    font-size: 10pt;\n    margin:0 !important;\n}\n\n.button-small {\n    padding:0;\n    width:1.75rem;\n    height: 1.75rem;\n    display:flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.button-small > .mat-icon {\n    font-size:1rem;\n    min-width: initial;\n}\n\n.status-badge {\n    border-radius: 16px;\n    height: 32px;\n    line-height: 32px;\n    padding: 0 12px;\n    width: fit-content;\n}\n.active-badge {\n    color: rgb(25, 128, 56);\n    background-color: rgba(25, 128, 56, 0.08);\n}\n.inactive-badge {\n    color: rgb(209, 39, 48);\n    background-color: rgba(209, 39, 48, 0.08);\n}"
            },
            "title" : "New Markdown/HTML Card",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "borderRadius" : "1.5rem"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "enableDataExport" : false,
            "widgetCss" : "",
            "noDataDisplayMessage" : "",
            "useDashboardTimewindow" : true,
            "pageSize" : 1024,
            "actions" : {
              "elementClick" : [ {
                "name" : "edit_asset",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "<!--=======================================================================-->\n<!--=====  There are two example templates: for edit and add entity   =====-->\n<!--=======================================================================-->\n<!--========================  Edit entity example  ========================-->\n<!--=======================================================================-->\n<!-- -->\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\n    <mat-toolbar fxLayout=\"row\" color=\"basic\">\n        <h2>Editar {{entityType.toLowerCase()}} {{internalName ?? entityName}}</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content class=\"dialog-content\" fxLayout=\"column\">\n        <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Numero interno</mat-label>-->\n        <!--        <input matInput formControlName=\"internal_number\"  >-->\n        <!--    </mat-form-field>-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Obra</mat-label>-->\n        <!--        <input matInput formControlName=\"building_site\">-->\n        <!--    </mat-form-field>-->\n        <!--</div>-->\n        <div formGroupName=\"attributes\" fxLayout=\"column\">\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n            <mat-form-field fxFlex class=\"mat-block\">\n                <mat-label>Nombre interno</mat-label>\n                <input matInput formControlName=\"internalName\" >\n            </mat-form-field>\n            </div>\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Modelo</mat-label>\n                    <input matInput formControlName=\"model\">\n                </mat-form-field>\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Marca</mat-label>\n                    <input matInput formControlName=\"brand\">\n                </mat-form-field>\n            </div>\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Obra</mat-label>\n                    <input matInput formControlName=\"buildingSite\" >\n                </mat-form-field>\n                <mat-form-field fxFlex class=\"mat-block\">\n                    <mat-label>Cliente</mat-label>\n                    <input matInput formControlName=\"client\">\n                </mat-form-field>\n            </div>\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Status</mat-label>-->\n            <!--        <mat-select placeholder=\"Selecciona un status\" name=\"status\" (selectionChange)=\"onChangeSelectStatus(status)\" [(ngModel)]=\"status\" >-->\n            <!--            <mat-option *ngFor=\"let status of statusOptions\" [value]=\"status\" >{{ status }}</mat-option>-->\n            <!--         </mat-select>-->\n            <!--    </mat-form-field>-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Ubicación YPF</mat-label>-->\n            <!--        <input matInput formControlName=\"ypf_location\">-->\n            <!--    </mat-form-field>-->\n            <!--</div>-->\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Tipo de Combustible</mat-label>-->\n            <!--        <mat-select placeholder=\"Tipo de Combustible\" name=\"fuel_type\" (selectionChange)=\"onChangeSelectFuelType(fuel_type)\" [(ngModel)]=\"fuel_type\" >-->\n            <!--            <mat-option *ngFor=\"let fuel_type of typeFuelOptions\" [value]=\"fuel_type\" >{{ fuel_type }}</mat-option>-->\n            <!--         </mat-select>-->\n            <!--    </mat-form-field>-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Telecomando</mat-label>-->\n            <!--        <mat-select placeholder=\"Telecomando\" name=\"telecommand\" (selectionChange)=\"onChangeSelectTelecommand(telecommand)\" [(ngModel)]=\"telecommand\" >-->\n            <!--            <mat-option *ngFor=\"let telecommand of telecommandOptions\" [value]=\"telecommand.value\" >{{ telecommand.label }}</mat-option>-->\n            <!--         </mat-select>-->\n            <!--    </mat-form-field>-->\n            <!--</div>-->\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Potencia Activa (Kw)</mat-label>-->\n            <!--        <input matInput type=\"number\" formControlName=\"active_power\">-->\n            <!--    </mat-form-field>-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Potencia Reactiva (Kva)</mat-label>-->\n            <!--        <input matInput type=\"number\" formControlName=\"reactive_power\">-->\n            <!--    </mat-form-field>-->\n            <!--</div>-->\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Rango de facturación</mat-label>-->\n            <!--        <mat-select placeholder=\"Rango de facturación\" name=\"billing_range\" (selectionChange)=\"onChangeSelectBillingRange(billing_range)\" [(ngModel)]=\"billing_range\" >-->\n            <!--            <mat-option *ngFor=\"let billing_range of billingRangeOptions\" [value]=\"billing_range.value\" >{{ billing_range.label }}</mat-option>-->\n            <!--         </mat-select>-->\n            <!--    </mat-form-field>-->\n                <!--<mat-form-field fxFlex class=\"mat-block\">-->\n                <!--    <mat-label>Tipo de Dispositivo</mat-label>-->\n                <!--    <mat-select placeholder=\"Tipo\" name=\"deviceType\" (selectionChange)=\"onChangeSelectDeviceType(deviceType)\" [(ngModel)]=\"deviceType\" >-->\n                <!--        <mat-option *ngFor=\"let deviceType of deviceTypeOptions\" [value]=\"deviceType.value\" >{{ deviceType.label }}</mat-option>-->\n                <!--     </mat-select>-->\n                <!--</mat-form-field>-->\n            </div>\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"start center\">\n                <button (click)=\"onOpenListImg()\" color=\"accent\" mat-icon-button matTooltip=\"Selecciona una imagen\" type=\"button\">\n                    <mat-icon class=\"material-icons-outlined\">\n                        {{!imgToSet ? \"add\" : \"change_circle\"}}\n                    </mat-icon>\n                </button>\n                <h5 *ngIf=\"!(!!imgToSet || showListImg)\" >Haz click en el button \"+\" para setear una imagen al asset\n                </h5>\n                <div *ngIf=\"!!imgToSet\" class=\"img-to-set\" [matTooltip]=\"imgToSet.title\" mat-raised-button color=\"accent\" matBadge=\"✓\"  >\n                    <img  width=\"42\"  [src]=\"imgToSet.src\" [alt]=\"imgToSet.name\">\n                </div>\n            </div>\n            <div *ngIf=\"imgs.length > 0 && showListImg\" class=\"list-img\" >\n                <div *ngFor=\"let img of imgs\" (click)=\"onSelectImg(img)\" [matTooltip]=\"img.title\" mat-raised-button class=\"img-to-set\" color=\"accent\" matBadge=\"✓\" [matBadgeHidden]=\"!(img.name===imgToSet?.name)\" style=\"cursor:pointer;\"  >\n                    <img *ngIf=\"!!img.name\" width=\"42\"  [src]=\"img.src\" [alt]=\"img.name\">\n                </div>\n            </div>\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n            <!--        <mat-label>Integer Value</mat-label>-->\n            <!--        <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n            <!--        <mat-error *ngIf=\"editEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n            <!--            Invalid integer value.-->\n            <!--        </mat-error>-->\n            <!--    </mat-form-field>-->\n            <!--    <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n            <!--        <label class=\"checkbox-label\">Boolean Value</label>-->\n            <!--        <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n            <!--            {{ (editEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n            <!--        </mat-checkbox>-->\n            <!--    </div>-->\n            <!--</div>-->\n        </div>\n        <!--<div class=\"relations-list old-relations\">-->\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\n        <!--    <div class=\"body\" [fxShow]=\"oldRelations().length\">-->\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"oldRelations\" -->\n        <!--             *ngFor=\"let relation of oldRelations().controls; let i = index;\">-->\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n        <!--                <div fxFlex fxLayout=\"column\">-->\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n        <!--                            <mat-label>Direction</mat-label>-->\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n        <!--                                </mat-option>-->\n        <!--                            </mat-select>-->\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n        <!--                                Relation direction is required.-->\n        <!--                            </mat-error>-->\n        <!--                        </mat-form-field>-->\n        <!--                        <tb-relation-type-autocomplete-->\n        <!--                                fxFlex class=\"mat-block\"-->\n        <!--                                formControlName=\"relationType\"-->\n        <!--                                required=\"true\">-->\n        <!--                        </tb-relation-type-autocomplete>-->\n        <!--                    </div>-->\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n        <!--                        <tb-entity-select-->\n        <!--                                fxFlex class=\"mat-block\"-->\n        <!--                                required=\"true\"-->\n        <!--                                formControlName=\"relatedEntity\">-->\n        <!--                        </tb-entity-select>-->\n        <!--                    </div>-->\n        <!--                </div>-->\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n        <!--                    <button mat-icon-button color=\"primary\"-->\n        <!--                            aria-label=\"Remove\"-->\n        <!--                            type=\"button\"-->\n        <!--                            (click)=\"removeOldRelation(i, relation.value)\"-->\n        <!--                            matTooltip=\"Remove relation\"-->\n        <!--                            matTooltipPosition=\"above\">-->\n        <!--                        <mat-icon>close</mat-icon>-->\n        <!--                    </button>-->\n        <!--                </div>-->\n        <!--            </div>-->\n        <!--        </div>-->\n        <!--    </div>-->\n        <!--</div>-->\n        <!--<div class=\"relations-list\">-->\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">New Relations</div>-->\n        <!--    <div class=\"body\" [fxShow]=\"relations().length\">-->\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n        <!--                <div fxFlex fxLayout=\"column\">-->\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n        <!--                            <mat-label>Direction</mat-label>-->\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n        <!--                                </mat-option>-->\n        <!--                            </mat-select>-->\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n        <!--                                Relation direction is required.-->\n        <!--                            </mat-error>-->\n        <!--                        </mat-form-field>-->\n        <!--                        <tb-relation-type-autocomplete-->\n        <!--                                fxFlex class=\"mat-block\"-->\n        <!--                                formControlName=\"relationType\"-->\n        <!--                                [required]=\"true\">-->\n        <!--                        </tb-relation-type-autocomplete>-->\n        <!--                    </div>-->\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n        <!--                        <tb-entity-select-->\n        <!--                                fxFlex class=\"mat-block\"-->\n        <!--                                [required]=\"true\"-->\n        <!--                                formControlName=\"relatedEntity\">-->\n        <!--                        </tb-entity-select>-->\n        <!--                    </div>-->\n        <!--                </div>-->\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n        <!--                    <button mat-icon-button color=\"primary\"-->\n        <!--                            aria-label=\"Remove\"-->\n        <!--                            type=\"button\"-->\n        <!--                            (click)=\"removeRelation(i)\"-->\n        <!--                            matTooltip=\"Remove relation\"-->\n        <!--                            matTooltipPosition=\"above\">-->\n        <!--                        <mat-icon>close</mat-icon>-->\n        <!--                    </button>-->\n        <!--                </div>-->\n        <!--            </div>-->\n        <!--        </div>-->\n        <!--    </div>-->\n        <!--    <div>-->\n        <!--        <button mat-raised-button color=\"primary\"-->\n        <!--                type=\"button\"-->\n        <!--                (click)=\"addRelation()\"-->\n        <!--                matTooltip=\"Add Relation\"-->\n        <!--                matTooltipPosition=\"above\">-->\n        <!--            Add-->\n        <!--        </button>-->\n        <!--    </div>-->\n        <!--</div>-->\n    </div>\n    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">\n        <button mat-button color=\"primary\"\n                type=\"button\"\n                [disabled]=\"(isLoading$ | async)\"\n                (click)=\"cancel()\" cdkFocusInitial>\n            Cancel\n        </button>\n        <button mat-button mat-raised-button color=\"primary\"\n                type=\"submit\"\n                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid\">\n            Save\n        </button>\n    </div>\n</form>\n<!---->\n<!--========================================================================-->\n<!--=========================  Add entity example  =========================-->\n<!--========================================================================-->\n<!---->\n<!--<form #addEntityForm=\"ngForm\" [formGroup]=\"addEntityFormGroup\"-->\n<!--      (ngSubmit)=\"save()\" class=\"add-entity-form\">-->\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\n<!--        <h2>Add entity</h2>-->\n<!--        <span fxFlex></span>-->\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\n<!--        </button>-->\n<!--    </mat-toolbar>-->\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\n<!--    </mat-progress-bar>-->\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Name</mat-label>-->\n<!--                <input matInput formControlName=\"entityName\" required>-->\n<!--                <mat-error *ngIf=\"addEntityFormGroup.get('entityName').hasError('required')\">-->\n<!--                    Entity name is required.-->\n<!--                </mat-error>-->\n<!--            </mat-form-field>-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Label</mat-label>-->\n<!--                <input matInput formControlName=\"entityLabel\" >-->\n<!--            </mat-form-field>-->\n<!--        </div>-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <tb-entity-type-select-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"entityType\"-->\n<!--                    [showLabel]=\"true\"-->\n<!--                    [allowedEntityTypes]=\"allowedEntityTypes\"-->\n<!--            ></tb-entity-type-select>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value == 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'ASSET'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value != 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'DEVICE'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--        </div>-->\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Latitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Longitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Address</mat-label>-->\n<!--                    <input matInput formControlName=\"address\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Owner</mat-label>-->\n<!--                    <input matInput formControlName=\"owner\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Integer Value</mat-label>-->\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n<!--                    <mat-error *ngIf=\"addEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n<!--                        Invalid integer value.-->\n<!--                    </mat-error>-->\n<!--                </mat-form-field>-->\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n<!--                        {{ (addEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n<!--                    </mat-checkbox>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--        <div class=\"relations-list\">-->\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n<!--                        <div fxFlex fxLayout=\"column\">-->\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n<!--                                    <mat-label>Direction</mat-label>-->\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n<!--                                        </mat-option>-->\n<!--                                    </mat-select>-->\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n<!--                                        Relation direction is required.-->\n<!--                                    </mat-error>-->\n<!--                                </mat-form-field>-->\n<!--                                <tb-relation-type-autocomplete-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        formControlName=\"relationType\"-->\n<!--                                        [required]=\"true\">-->\n<!--                                </tb-relation-type-autocomplete>-->\n<!--                            </div>-->\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n<!--                                <tb-entity-select-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        [required]=\"true\"-->\n<!--                                        formControlName=\"relatedEntity\">-->\n<!--                                </tb-entity-select>-->\n<!--                            </div>-->\n<!--                        </div>-->\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n<!--                            <button mat-icon-button color=\"primary\"-->\n<!--                                    aria-label=\"Remove\"-->\n<!--                                    type=\"button\"-->\n<!--                                    (click)=\"removeRelation(i)\"-->\n<!--                                    matTooltip=\"Remove relation\"-->\n<!--                                    matTooltipPosition=\"above\">-->\n<!--                                <mat-icon>close</mat-icon>-->\n<!--                            </button>-->\n<!--                        </div>-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--            <div>-->\n<!--                <button mat-raised-button color=\"primary\"-->\n<!--                        type=\"button\"-->\n<!--                        (click)=\"addRelation()\"-->\n<!--                        matTooltip=\"Add Relation\"-->\n<!--                        matTooltipPosition=\"above\">-->\n<!--                    Add-->\n<!--                </button>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--    </div>-->\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\n<!--        <button mat-button color=\"primary\"-->\n<!--                type=\"button\"-->\n<!--                [disabled]=\"(isLoading$ | async)\"-->\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\n<!--            Cancel-->\n<!--        </button>-->\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\n<!--                type=\"submit\"-->\n<!--                [disabled]=\"(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty\">-->\n<!--            Create-->\n<!--        </button>-->\n<!--    </div>-->\n<!--</form>-->\n",
                "customCss" : "\n.dialog-content{\n   min-width: 45rem; \n}\n\n.list-img{\n    display:grid; \n    grid-template-columns:repeat(auto-fit, minmax(60px, 1fr)); \n    justify-items:center; \n    align-items: flex-start; \n    grid-auto-rows:1fr; \n    gap:1rem;\n}\n\n.img-to-set{\n    background:#eee; \n    border-radius:3px; \n    width:60px; \n    height:60px; \n    margin:2px;    \n    display:flex; \n    align-items:center; \n    justify-content:center;\n}\n\n\n/*=======================================================================*/\n/*==========  There are two examples: for edit and add entity  ==========*/\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n/*\n.edit-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.edit-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n/*\n.add-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.add-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n",
                "customFunction" : "/*=======================================================================*/\n/*=====  There are three examples: for delete, edit and add entity  =====*/\n/*=======================================================================*/\n/*=======================  Delete entity example  =======================*/\n/*=======================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//\n//openDeleteEntityDialog();\n//\n//function openDeleteEntityDialog() {\n//    let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\n//                 entityName;\n//    let content = 'Are you sure you want to delete the ' +\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\n//    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\n//        function(result) {\n//            if (result) {\n//                deleteEntity();\n//            }\n//        }\n//    );\n//}\n//\n//function deleteEntity() {\n//    deleteEntityObservable(entityId).subscribe(\n//        function success() {\n//            widgetContext.updateAliases();\n//        },\n//        function fail() {\n//            showErrorDialog();\n//        }\n//    );\n//}\n//\n//function deleteEntityObservable(entityId) {\n//    if (entityId.entityType == \"ASSET\") {\n//        return assetService.deleteAsset(entityId.id);\n//    } else if (entityId.entityType == \"DEVICE\") {\n//        return deviceService.deleteDevice(entityId.id);\n//    }\n//}\n//\n//function showErrorDialog() {\n//    let title = 'Error';\n//    let content = 'An error occurred while deleting the entity. Please try again.';\n//    dialogs.alert(title, content, 'CLOSE').subscribe(\n//        function(result) {}\n//    );\n//}\n//\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n//\nlet $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\nlet dateService =  $injector.get(widgetContext.servicesMap.get('date'));\n\nconst aliases = widgetContext.aliasController.getEntityAliases()\nconst params = widgetContext.stateController.getStateParams()\nconst dataEntity = params.only_selected\nconsole.log(\"dateService=>\",dateService)\n\nopenEditEntityDialog();\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n\n    vm.entityName = dataEntity ? dataEntity.entityName : \"\";\n    vm.entityType = dataEntity ? dataEntity.entityId.entityType : \"\";\n    vm.entitySearchDirection = {\n        from: \"FROM\",\n        to: \"TO\"\n    };\n    vm.attributes = {};\n    vm.oldRelationsData = [];\n    vm.relationsToDelete = [];\n    vm.entity = {};\n    \n    vm.showListImg = false;\n    vm.imgToSet = null;\n    \n    //--get info from repositories --//\n    vm.imgs = imgRepository();\n    // vm.deviceTypeOptions = deviceTypeRepository()\n    //--------//\n\n    vm.editEntityFormGroup = vm.fb.group({\n        entityName: ['', [vm.validators.required]],\n        entityType: [null],\n        entityLabel: [null],\n        type: ['', [vm.validators.required]],\n        attributes: vm.fb.group({\n            model: [null],\n            img : [null],\n            internalName: [null],\n            buildingSite: [null],\n            client: [null],\n            brand: [null]\n        }),\n    });\n\n    getEntityInfo();\n    \n    vm.onOpenListImg = ()=>{\n        vm.showListImg = true\n    }\n    \n    vm.onSelectImg = (image)=>{\n        // console.log(\"onSelect=>\",e)\n        vm.imgToSet = image\n        vm.showListImg = false\n    } \n    \n    //-- handlers selects --//\n    vm.onChangeSelectStatus = (status)=>{\n        vm.editEntityFormGroup.patchValue({\n                    entityName: vm.entity.name,\n                    entityType: vm.entityType,\n                    entityLabel: vm.entity.label,\n                    type: vm.entity.type,\n                    attributes: {...vm.attributes,status },\n                }, {emitEvent: false});\n    }\n    \n    vm.onChangeSelectModel = (model)=>{\n        vm.editEntityFormGroup.patchValue({\n                    entityName: vm.entity.name,\n                    entityType: vm.entityType,\n                    entityLabel: vm.entity.label,\n                    type: vm.entity.type,\n                    attributes: {...vm.attributes,model },\n                }, {emitEvent: false});\n    }\n  \n    \n   \n    \n    \n//-----------------------------------------------------------------------//\n\n    vm.cancel = function() {\n        vm.dialogRef.close(null);\n    };\n\n    vm.relations = function() {\n        return vm.editEntityFormGroup.get('relations');\n    };\n\n    vm.oldRelations = function() {\n        return vm.editEntityFormGroup.get('oldRelations');\n    };\n\n    vm.addRelation = function() {\n        vm.relations().push(vm.fb.group({\n            relatedEntity: [null, [vm.validators.required]],\n            relationType: [null, [vm.validators.required]],\n            direction: [null, [vm.validators.required]]\n        }));\n    };\n\n    function addOldRelation() {\n        vm.oldRelations().push(vm.fb.group({\n            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\n            relationType: [{value: null, disabled: true}, [vm.validators.required]],\n            direction: [{value: null, disabled: true}, [vm.validators.required]]\n        }));\n    }\n\n    vm.removeRelation = function(index) {\n        vm.relations().removeAt(index);\n        vm.relations().markAsDirty();\n    };\n\n    vm.removeOldRelation = function(index, relation) {\n        vm.oldRelations().removeAt(index);\n        vm.relationsToDelete.push(relation);\n        vm.oldRelations().markAsDirty();\n    };\n\n    vm.save = function() {\n        vm.editEntityFormGroup.markAsPristine();\n        widgetContext.rxjs.forkJoin([\n            saveAttributes(dataEntity.entityId),\n            saveEntity()\n        ]).subscribe(\n            function () {\n                widgetContext.updateAliases();\n                vm.dialogRef.close(null);\n            }\n        );\n    };\n\n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            vm.attributes[attributes[i].key] = attributes[i].value;\n        }\n    }\n\n    function getEntityRelations(relations) {\n        let relationsFrom = relations[0];\n        let relationsTo = relations[1];\n        for (let i=0; i < relationsFrom.length; i++) {\n            let relation = {\n                direction: 'FROM',\n                relationType: relationsFrom[i].type,\n                relatedEntity: relationsFrom[i].to\n            };\n            vm.oldRelationsData.push(relation);\n            addOldRelation();\n        }\n        for (let i=0; i < relationsTo.length; i++) {\n            let relation = {\n                direction: 'TO',\n                relationType: relationsTo[i].type,\n                relatedEntity: relationsTo[i].from\n            };\n            vm.oldRelationsData.push(relation);\n            addOldRelation();\n        }\n    }\n\n    function getEntityInfo() {\n        widgetContext.rxjs.forkJoin([\n            entityRelationService.findInfoByFrom(dataEntity.entityId),\n            entityRelationService.findInfoByTo(dataEntity.entityId),\n            attributeService.getEntityAttributes(dataEntity.entityId, 'SERVER_SCOPE'),\n            entityService.getEntity(dataEntity.entityId.entityType, dataEntity.entityId.id)\n        ]).subscribe(\n            function (data) {\n                // getEntityRelations(data.slice(0,2));\n                getEntityAttributes(data[2]);\n                vm.internalName = vm.attributes.internalName\n                vm.entity = data[3];\n                vm.editEntityFormGroup.patchValue({\n                    entityName: vm.entity.name,\n                    entityType: vm.entityType,\n                    entityLabel: vm.entity.label,\n                    type: vm.entity.type,\n                    attributes: vm.attributes,\n                }, {emitEvent: false});\n                // console.log(\"GetEntityIfo=>\",vm.attributes)\n                if(isJson(vm.attributes.img)){\n                    vm.imgToSet = JSON.parse(vm.attributes.img)\n                }\n            }\n        );\n    }\n\n    function saveEntity() {\n        const formValues = vm.editEntityFormGroup.value;\n        if (vm.entity.name !== formValues.entityName){\n            vm.entity.name = formValues.entityName;\n            if (formValues.entityType == 'ASSET') {\n                return assetService.saveAsset(vm.entity);\n            } else if (formValues.entityType == 'DEVICE') {\n                return deviceService.saveDevice(vm.entity);\n            }\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveAttributes(entityId) {\n        let attributes = vm.editEntityFormGroup.get('attributes').value;\n        \n        if(vm.imgToSet!= vm.attributes.img){\n            attributes = {...attributes, img:JSON.stringify(vm.imgToSet)}\n        }\n        \n        let attributesArray = [];\n        for (let key in attributes) {\n            if (attributes[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: attributes[key]});\n            }\n        }\n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveRelations(entityId) {\n        let relations = vm.editEntityFormGroup.get('relations').value;\n        let tasks = [];\n        for(let i=0; i < relations.length; i++) {\n            let relation = {\n                type: relations[i].relationType,\n                typeGroup: 'COMMON'\n            };\n            if (relations[i].direction == 'FROM') {\n                relation.to = relations[i].relatedEntity;\n                relation.from = entityId;\n            } else {\n                relation.to = entityId;\n                relation.from = relations[i].relatedEntity;\n            }\n            tasks.push(entityRelationService.saveRelation(relation));\n        }\n        for (let i=0; i < vm.relationsToDelete.length; i++) {\n            let relation = {\n                type: vm.relationsToDelete[i].relationType\n            };\n            if (vm.relationsToDelete[i].direction == 'FROM') {\n                relation.to = vm.relationsToDelete[i].relatedEntity;\n                relation.from = entityId;\n            } else {\n                relation.to = entityId;\n                relation.from = vm.relationsToDelete[i].relatedEntity;\n            }\n            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\n        }\n        if (tasks.length > 0) {\n            return widgetContext.rxjs.forkJoin(tasks);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n    \n    function isJson(text){\n      try {\n        JSON.parse(text);\n      } catch (err) {\n        return false;\n      }\n      return true;\n    }\n}\n\n\n\nfunction imgRepository(){\n    const externalUrl = 'https://qr.twindimension.com/'\n    const endpoint = `${externalUrl}/icons/profiles`\n    return [\n        {\n        name: false,\n        title: 'Default',\n        src: ``,\n        },\n          {\n            name: 'AIRE-small-air.png',\n            title: 'Aire chico',\n            src: `${endpoint}/AIRE-small-air.png`,\n          },\n          {\n            name: 'AIRE-big-air.png',\n            title: 'Aire grande',\n            src: `${endpoint}/AIRE-big-air.png`,\n          },\n          {\n            name: 'AIRE-electrico-M75.png',\n            title: 'Aire Hasta 75kw',\n            src: `${endpoint}/AIRE-electrico-H75.png`,\n          },\n          {\n            name: 'AIRE-electrico-M75.png',\n            title: 'Aire más de 75kw',\n            src: `${endpoint}/AIRE-electrico-M75.png`,\n          },\n          {\n            name: 'AWP-elevador-pers.png',\n            title: 'Elevador personal',\n            src: `${endpoint}/AWP-elevador-pers.png`,\n          },\n          {\n            name: 'AWP-pluma-artic.png',\n            title: 'Pluma articulada',\n            src: `${endpoint}/AWP-pluma-artic.png`,\n          },\n          {\n            name: 'AWP-pluma-telesc.png',\n            title: 'Pluma telescópica',\n            src: `${endpoint}/AWP-pluma-telesc.png`,\n          },\n          {\n            name: 'AWP-tijeras.png',\n            title: 'Tijeras',\n            src: `${endpoint}/AWP-tijeras.png`,\n          },\n          {\n            name: 'ERADC-container.png',\n            title: 'Generador Container',\n            src: `${endpoint}/ERADC-container.png`,\n          },{\n            name: 'ERADC-diesel.png',\n            title: 'Generador diesel',\n            src: `${endpoint}/ERADC-diesel.png`,\n          },\n          {\n            name: 'ERADC-trailer.png',\n            title: 'Generador trailer',\n            src: `${endpoint}/ERADC-trailer.png`,\n          },\n          {\n            name: 'TIERRA-camion-artic.png',\n            title: 'Camión articulado',\n            src: `${endpoint}/TIERRA-camion-artic.png`,\n          },\n          {\n            name: 'TIERRA-camioneta.png',\n            title: 'Camión rígido',\n            src: `${endpoint}/TIERRA-camion-rigido.png`,\n          },\n          {\n            name: 'TIERRA-camion-rigido.png',\n            title: 'Camioneta',\n            src: `${endpoint}/TIERRA-camioneta.png`,\n          },\n          {\n            name: 'TIERRA-cargador-frontal.png',\n            title: 'Cargador frontal',\n            src: `${endpoint}/TIERRA-cargador-frontal.png`,\n          },\n          {\n            name: 'TIERRA-carg-frt-retroex.png',\n            title: 'Cargador retroexcavadora',\n            src: `${endpoint}/TIERRA-carg-frt-retroex.png`,\n          },\n          {\n            name: 'TIERRA-compactadora.png',\n            title: 'Compactadora',\n            src: `${endpoint}/TIERRA-compactadora.png`,\n          },\n          {\n            name: 'TIERRA-excavadora.pn',\n            title: 'Excavadora',\n            src: `${endpoint}/TIERRA-excavadora.png`,\n          },\n          {\n            name: 'TIERRA-minicargadora.png',\n            title: 'Minicargadora',\n            src: `${endpoint}/TIERRA-minicargadora.png`,\n          },\n          {\n            name: 'TIERRA-miniexcavadora.png',\n            title: 'Miniexcavadora',\n            src: `${endpoint}/TIERRA-miniexcavadora.png`,\n          },\n          {\n            name: 'TIERRA-motoniveladora.png',\n            title: 'Motoniveladora',\n            src: `${endpoint}/TIERRA-motoniveladora.png`,\n          },\n          {\n            name: 'TIERRA-topadora.png',\n            title: 'Topadora',\n            src: `${endpoint}/TIERRA-topadora.png`,\n          },\n          {\n            name: 'TIERRA-tractor.png',\n            title: 'Tractor',\n            src: `${endpoint}/TIERRA-tractor.png`,\n          },\n          {\n            name: 'TLH-autoelevadora-D.png',\n            title: 'Autoelevador diesel',\n            src: `${endpoint}/TLH-autoelevadora-D.png`,\n          },\n          {\n            name: 'TLH-autoelevadora-E.png',\n            title: 'Autoelevador eléctrico',\n            src: `${endpoint}/TLH-autoelevadora-E.png`,\n          },\n          {\n            name: 'TLH-compacto-oruga.png',\n            title: 'Compacto con oruga',\n            src: `${endpoint}/TLH-compacto-oruga.png`,\n          },\n          {\n            name: 'TLH-manipuladora-H6.png',\n            title: 'Manipuladora hasta 6tn',\n            src: `${endpoint}/TLH-manipuladora-H6.png`,\n          },\n          {\n            name: 'TLH-manipuladora-M6.png',\n            title: 'Manipuladora más de 6tn',\n            src: `${endpoint}/TLH-manipuladora-M6.png`,\n          },\n      {\n        name: 'TORRE-torre.png',\n        title: 'Torre',\n        src: `${endpoint}/TORRE-torre.png`,\n      },\n];\n}\n\n\n\n\n\n\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openAddEntityDialog();\n//\n//function openAddEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\n//}\n//\n//function AddEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    }\n//\n//    vm.addEntityFormGroup = vm.fb.group({\n//      entityName: ['', [vm.validators.required]],\n//      entityType: ['DEVICE'],\n//      entityLabel: [null],\n//      type: ['', [vm.validators.required]],\n//      attributes: vm.fb.group({\n//          latitude: [null],\n//          longitude: [null],\n//          address: [null],\n//          owner: [null],\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//          booleanValue: [null]\n//      }),\n//      relations: vm.fb.array([])\n//    });\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.addEntityFormGroup.get('relations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//          relatedEntity: [null, [vm.validators.required]],\n//          relationType: [null, [vm.validators.required]],\n//          direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.addEntityFormGroup.markAsPristine();\n//        saveEntityObservable().subscribe(\n//            function (entity) {\n//                widgetContext.rxjs.forkJoin([\n//                    saveAttributes(entity.id),\n//                    saveRelations(entity.id)\n//                ]).subscribe(\n//                    function () {\n//                        widgetContext.updateAliases();\n//                        vm.dialogRef.close(null);\n//                    }\n//                );\n//            }\n//        );\n//    };\n//\n//    function saveEntityObservable() {\n//        const formValues = vm.addEntityFormGroup.value;\n//        let entity = {\n//            name: formValues.entityName,\n//            type: formValues.type,\n//            label: formValues.entityLabel\n//        };\n//        if (formValues.entityType == 'ASSET') {\n//            return assetService.saveAsset(entity);\n//        } else if (formValues.entityType == 'DEVICE') {\n//            return deviceService.saveDevice(entity);\n//        }\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if(attributes[key] !== null) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.addEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//}\n",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "51600c61-d54a-6986-da5d-fda74ae170f7"
              }, {
                "name" : "telecomander",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "<div class='container-detail mat-typography'>\n        <div class='header-detail'>\n            <button class=\"icon-button-small\" color=\"primary\" mat-icon-button (click)=\"cancel()\" type=\"button\">\n                <mat-icon class=\"material-icons\">close</mat-icon>\n            </button>\n        </div>\n    \n    <div class=\" detail-content\">\n    <tb-dashboard-state fxFlex  [ctx]=\"widgetContext\" [syncParentStateParams]=\"true\" stateId=\"telecomander_view\"></tb-dashboard-state>\n    </div>\n    <mat-progress-bar color=\"accent\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <!--<mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"center center\" fxLayoutGap=\"1.5rem\">-->\n    <!--<button mat-button mat-dialog-close-->\n    <!--        type=\"button\"-->\n    <!--        (click)=\"cancel()\"-->\n    <!--        matTooltip=\"Close Dialog\"-->\n    <!--        matTooltipPosition=\"above\">-->\n    <!--    Cerrar-->\n    <!--</button>-->\n    <!--</mat-dialog-actions>-->\n</div>\n\n\n<!--=======================================================================-->\n<!--=====  There are two example templates: for edit and add entity   =====-->\n<!--=======================================================================-->\n<!--========================  Edit entity example  ========================-->\n<!--=======================================================================-->\n<!-- -->\n<!--<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"-->\n<!--      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">-->\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\n<!--        <h2>Edit {{entityType.toLowerCase()}} {{entityName}}</h2>-->\n<!--        <span fxFlex></span>-->\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\n<!--        </button>-->\n<!--    </mat-toolbar>-->\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\n<!--    </mat-progress-bar>-->\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Name</mat-label>-->\n<!--                <input matInput formControlName=\"entityName\" required readonly=\"\">-->\n<!--            </mat-form-field>-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Label</mat-label>-->\n<!--                <input matInput formControlName=\"entityLabel\">-->\n<!--            </mat-form-field>-->\n<!--        </div>-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Type</mat-label>-->\n<!--                <input matInput formControlName=\"entityType\" readonly>-->\n<!--            </mat-form-field>-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Type</mat-label>-->\n<!--                <input matInput formControlName=\"type\" readonly>-->\n<!--            </mat-form-field>-->\n<!--        </div>-->\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Latitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Longitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Address</mat-label>-->\n<!--                    <input matInput formControlName=\"address\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Owner</mat-label>-->\n<!--                    <input matInput formControlName=\"owner\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Integer Value</mat-label>-->\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n<!--                    <mat-error *ngIf=\"editEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n<!--                        Invalid integer value.-->\n<!--                    </mat-error>-->\n<!--                </mat-form-field>-->\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n<!--                        {{ (editEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n<!--                    </mat-checkbox>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--        <div class=\"relations-list old-relations\">-->\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\n<!--            <div class=\"body\" [fxShow]=\"oldRelations().length\">-->\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"oldRelations\" -->\n<!--                     *ngFor=\"let relation of oldRelations().controls; let i = index;\">-->\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n<!--                        <div fxFlex fxLayout=\"column\">-->\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n<!--                                    <mat-label>Direction</mat-label>-->\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n<!--                                        </mat-option>-->\n<!--                                    </mat-select>-->\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n<!--                                        Relation direction is required.-->\n<!--                                    </mat-error>-->\n<!--                                </mat-form-field>-->\n<!--                                <tb-relation-type-autocomplete-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        formControlName=\"relationType\"-->\n<!--                                        required=\"true\">-->\n<!--                                </tb-relation-type-autocomplete>-->\n<!--                            </div>-->\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n<!--                                <tb-entity-select-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        required=\"true\"-->\n<!--                                        formControlName=\"relatedEntity\">-->\n<!--                                </tb-entity-select>-->\n<!--                            </div>-->\n<!--                        </div>-->\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n<!--                            <button mat-icon-button color=\"primary\"-->\n<!--                                    aria-label=\"Remove\"-->\n<!--                                    type=\"button\"-->\n<!--                                    (click)=\"removeOldRelation(i, relation.value)\"-->\n<!--                                    matTooltip=\"Remove relation\"-->\n<!--                                    matTooltipPosition=\"above\">-->\n<!--                                <mat-icon>close</mat-icon>-->\n<!--                            </button>-->\n<!--                        </div>-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--        <div class=\"relations-list\">-->\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">New Relations</div>-->\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n<!--                        <div fxFlex fxLayout=\"column\">-->\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n<!--                                    <mat-label>Direction</mat-label>-->\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n<!--                                        </mat-option>-->\n<!--                                    </mat-select>-->\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n<!--                                        Relation direction is required.-->\n<!--                                    </mat-error>-->\n<!--                                </mat-form-field>-->\n<!--                                <tb-relation-type-autocomplete-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        formControlName=\"relationType\"-->\n<!--                                        [required]=\"true\">-->\n<!--                                </tb-relation-type-autocomplete>-->\n<!--                            </div>-->\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n<!--                                <tb-entity-select-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        [required]=\"true\"-->\n<!--                                        formControlName=\"relatedEntity\">-->\n<!--                                </tb-entity-select>-->\n<!--                            </div>-->\n<!--                        </div>-->\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n<!--                            <button mat-icon-button color=\"primary\"-->\n<!--                                    aria-label=\"Remove\"-->\n<!--                                    type=\"button\"-->\n<!--                                    (click)=\"removeRelation(i)\"-->\n<!--                                    matTooltip=\"Remove relation\"-->\n<!--                                    matTooltipPosition=\"above\">-->\n<!--                                <mat-icon>close</mat-icon>-->\n<!--                            </button>-->\n<!--                        </div>-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--            <div>-->\n<!--                <button mat-raised-button color=\"primary\"-->\n<!--                        type=\"button\"-->\n<!--                        (click)=\"addRelation()\"-->\n<!--                        matTooltip=\"Add Relation\"-->\n<!--                        matTooltipPosition=\"above\">-->\n<!--                    Add-->\n<!--                </button>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--    </div>-->\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\n<!--        <button mat-button color=\"primary\"-->\n<!--                type=\"button\"-->\n<!--                [disabled]=\"(isLoading$ | async)\"-->\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\n<!--            Cancel-->\n<!--        </button>-->\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\n<!--                type=\"submit\"-->\n<!--                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty\">-->\n<!--            Save-->\n<!--        </button>-->\n<!--    </div>-->\n<!--</form>-->\n<!---->\n<!--========================================================================-->\n<!--=========================  Add entity example  =========================-->\n<!--========================================================================-->\n<!---->\n<!--<form #addEntityForm=\"ngForm\" [formGroup]=\"addEntityFormGroup\"-->\n<!--      (ngSubmit)=\"save()\" class=\"add-entity-form\">-->\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\n<!--        <h2>Add entity</h2>-->\n<!--        <span fxFlex></span>-->\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\n<!--        </button>-->\n<!--    </mat-toolbar>-->\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\n<!--    </mat-progress-bar>-->\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Name</mat-label>-->\n<!--                <input matInput formControlName=\"entityName\" required>-->\n<!--                <mat-error *ngIf=\"addEntityFormGroup.get('entityName').hasError('required')\">-->\n<!--                    Entity name is required.-->\n<!--                </mat-error>-->\n<!--            </mat-form-field>-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Label</mat-label>-->\n<!--                <input matInput formControlName=\"entityLabel\" >-->\n<!--            </mat-form-field>-->\n<!--        </div>-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <tb-entity-type-select-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"entityType\"-->\n<!--                    [showLabel]=\"true\"-->\n<!--                    [allowedEntityTypes]=\"allowedEntityTypes\"-->\n<!--            ></tb-entity-type-select>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value == 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'ASSET'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value != 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'DEVICE'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--        </div>-->\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Latitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Longitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Address</mat-label>-->\n<!--                    <input matInput formControlName=\"address\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Owner</mat-label>-->\n<!--                    <input matInput formControlName=\"owner\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Integer Value</mat-label>-->\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n<!--                    <mat-error *ngIf=\"addEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n<!--                        Invalid integer value.-->\n<!--                    </mat-error>-->\n<!--                </mat-form-field>-->\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n<!--                        {{ (addEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n<!--                    </mat-checkbox>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--        <div class=\"relations-list\">-->\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n<!--                        <div fxFlex fxLayout=\"column\">-->\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n<!--                                    <mat-label>Direction</mat-label>-->\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n<!--                                        </mat-option>-->\n<!--                                    </mat-select>-->\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n<!--                                        Relation direction is required.-->\n<!--                                    </mat-error>-->\n<!--                                </mat-form-field>-->\n<!--                                <tb-relation-type-autocomplete-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        formControlName=\"relationType\"-->\n<!--                                        [required]=\"true\">-->\n<!--                                </tb-relation-type-autocomplete>-->\n<!--                            </div>-->\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n<!--                                <tb-entity-select-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        [required]=\"true\"-->\n<!--                                        formControlName=\"relatedEntity\">-->\n<!--                                </tb-entity-select>-->\n<!--                            </div>-->\n<!--                        </div>-->\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n<!--                            <button mat-icon-button color=\"primary\"-->\n<!--                                    aria-label=\"Remove\"-->\n<!--                                    type=\"button\"-->\n<!--                                    (click)=\"removeRelation(i)\"-->\n<!--                                    matTooltip=\"Remove relation\"-->\n<!--                                    matTooltipPosition=\"above\">-->\n<!--                                <mat-icon>close</mat-icon>-->\n<!--                            </button>-->\n<!--                        </div>-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--            <div>-->\n<!--                <button mat-raised-button color=\"primary\"-->\n<!--                        type=\"button\"-->\n<!--                        (click)=\"addRelation()\"-->\n<!--                        matTooltip=\"Add Relation\"-->\n<!--                        matTooltipPosition=\"above\">-->\n<!--                    Add-->\n<!--                </button>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--    </div>-->\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\n<!--        <button mat-button color=\"primary\"-->\n<!--                type=\"button\"-->\n<!--                [disabled]=\"(isLoading$ | async)\"-->\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\n<!--            Cancel-->\n<!--        </button>-->\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\n<!--                type=\"submit\"-->\n<!--                [disabled]=\"(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty\">-->\n<!--            Create-->\n<!--        </button>-->\n<!--    </div>-->\n<!--</form>-->\n",
                "customCss" : ".cdk-overlay-pane{\n   max-width: 85vw !important; \n}\n\n.container-detail{\n    width:50vw; \n    min-width:400px;\n    max-width: 500px;\n    height:50vh;\n    min-height: 400px;\n    max-height: 500;\n    border-radius:1rem;\n    display: flex;\n    flex-direction: column;\n    gap:.5rem;\n    position: relative;\n    \n}\n\n.header-detail{\n    top: 18px;\n    right: 3rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    position:absolute;\n    z-index: 999;\n}\n\n.detail-content {\n    flex:1;\n    padding: 0;\n}\n\n.icon-button-small {\n      width: 32px !important;\n      height: 32px !important;\n      padding: 0 !important;\n      display: flex;\n    justify-content: center;\n    align-items: center;\n }\n  \n .icon-button-small> .material-icons {\n      font-size: 20px !important;\n      width: 20px;\n      height: 20px;\n}\n\n.mat-mdc-dialog-surface {\n   border-radius: 20px !important;\n}\n\n\n\n\n\n/*=======================================================================*/\n/*==========  There are two examples: for edit and add entity  ==========*/\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n/*\n.edit-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.edit-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n/*\n.add-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.add-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n",
                "customFunction" : "let $injector = widgetContext.$scope.$injector;\nconst customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet entityGroupService = $injector.get(widgetContext.servicesMap.get('entityGroupService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n\nconst aliases = widgetContext.aliasController.getEntityAliases()\nlet params = widgetContext.stateController.getStateParams();\n\nconst dataEntity = params.only_selected\n\nopenEditEntityDialog();\nfunction openEditEntityDialog() {\n    widgetContext.stateController.updateState(null, params)\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController,{panelClass: 'custom-container'}).subscribe();\n    \n    \n}\n\nfunction EditEntityDialogController(instance) {\n\n    let vm = instance;\n    vm.entityName = dataEntity ? dataEntity.entityName : \"\";\n    vm.entityType = dataEntity ? dataEntity.entityId.entityType : \"\";\n    vm.widgetContext = widgetContext\n    \n    vm.cancel = function() {\n        vm.dialogRef.close(null);\n    };\n}\n\n\n\n/*=======================================================================*/\n/*=====  There are three examples: for delete, edit and add entity  =====*/\n/*=======================================================================*/\n/*=======================  Delete entity example  =======================*/\n/*=======================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//\n//openDeleteEntityDialog();\n//\n//function openDeleteEntityDialog() {\n//    let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\n//                 entityName;\n//    let content = 'Are you sure you want to delete the ' +\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\n//    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\n//        function(result) {\n//            if (result) {\n//                deleteEntity();\n//            }\n//        }\n//    );\n//}\n//\n//function deleteEntity() {\n//    deleteEntityObservable(entityId).subscribe(\n//        function success() {\n//            widgetContext.updateAliases();\n//        },\n//        function fail() {\n//            showErrorDialog();\n//        }\n//    );\n//}\n//\n//function deleteEntityObservable(entityId) {\n//    if (entityId.entityType == \"ASSET\") {\n//        return assetService.deleteAsset(entityId.id);\n//    } else if (entityId.entityType == \"DEVICE\") {\n//        return deviceService.deleteDevice(entityId.id);\n//    }\n//}\n//\n//function showErrorDialog() {\n//    let title = 'Error';\n//    let content = 'An error occurred while deleting the entity. Please try again.';\n//    dialogs.alert(title, content, 'CLOSE').subscribe(\n//        function(result) {}\n//    );\n//}\n//\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openEditEntityDialog();\n//\n//function openEditEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n//}\n//\n//function EditEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.entityName = entityName;\n//    vm.entityType = entityId.entityType;\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    };\n//    vm.attributes = {};\n//    vm.oldRelationsData = [];\n//    vm.relationsToDelete = [];\n//    vm.entity = {};\n//\n//    vm.editEntityFormGroup = vm.fb.group({\n//        entityName: ['', [vm.validators.required]],\n//        entityType: [null],\n//        entityLabel: [null],\n//        type: ['', [vm.validators.required]],\n//        attributes: vm.fb.group({\n//            latitude: [null],\n//            longitude: [null],\n//            address: [null],\n//            owner: [null],\n//            number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//            booleanValue: [false]\n//        }),\n//        oldRelations: vm.fb.array([]),\n//        relations: vm.fb.array([])\n//    });\n//\n//    getEntityInfo();\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.editEntityFormGroup.get('relations');\n//    };\n//\n//    vm.oldRelations = function() {\n//        return vm.editEntityFormGroup.get('oldRelations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//            relatedEntity: [null, [vm.validators.required]],\n//            relationType: [null, [vm.validators.required]],\n//            direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    function addOldRelation() {\n//        vm.oldRelations().push(vm.fb.group({\n//            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\n//            relationType: [{value: null, disabled: true}, [vm.validators.required]],\n//            direction: [{value: null, disabled: true}, [vm.validators.required]]\n//        }));\n//    }\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.removeOldRelation = function(index, relation) {\n//        vm.oldRelations().removeAt(index);\n//        vm.relationsToDelete.push(relation);\n//        vm.oldRelations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.editEntityFormGroup.markAsPristine();\n//        widgetContext.rxjs.forkJoin([\n//            saveAttributes(entityId),\n//            saveRelations(entityId),\n//            saveEntity()\n//        ]).subscribe(\n//            function () {\n//                widgetContext.updateAliases();\n//                vm.dialogRef.close(null);\n//            }\n//        );\n//    };\n//\n//    function getEntityAttributes(attributes) {\n//        for (var i = 0; i < attributes.length; i++) {\n//            vm.attributes[attributes[i].key] = attributes[i].value;\n//        }\n//    }\n//\n//    function getEntityRelations(relations) {\n//        let relationsFrom = relations[0];\n//        let relationsTo = relations[1];\n//        for (let i=0; i < relationsFrom.length; i++) {\n//            let relation = {\n//                direction: 'FROM',\n//                relationType: relationsFrom[i].type,\n//                relatedEntity: relationsFrom[i].to\n//            };\n//            vm.oldRelationsData.push(relation);\n//            addOldRelation();\n//        }\n//        for (let i=0; i < relationsTo.length; i++) {\n//            let relation = {\n//                direction: 'TO',\n//                relationType: relationsTo[i].type,\n//                relatedEntity: relationsTo[i].from\n//            };\n//            vm.oldRelationsData.push(relation);\n//            addOldRelation();\n//        }\n//    }\n//\n//    function getEntityInfo() {\n//         widgetContext.rxjs.forkJoin([\n//             entityRelationService.findInfoByFrom(entityId),\n//             entityRelationService.findInfoByTo(entityId),\n//             attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\n//             entityService.getEntity(entityId.entityType, entityId.id)\n//         ]).subscribe(\n//             function (data) {\n//                 getEntityRelations(data.slice(0,2));\n//                 getEntityAttributes(data[2]);\n//                 vm.entity = data[3];\n//                 vm.editEntityFormGroup.patchValue({\n//                     entityName: vm.entity.name,\n//                     entityType: vm.entityType,\n//                     entityLabel: vm.entity.label,\n//                     type: vm.entity.type,\n//                     attributes: vm.attributes,\n//                     oldRelations: vm.oldRelationsData\n//                 }, {emitEvent: false});\n//             }\n//         );\n//     }\n//\n//    function saveEntity() {\n//        const formValues = vm.editEntityFormGroup.value;\n//        if (vm.entity.label !== formValues.entityLabel){\n//            vm.entity.label = formValues.entityLabel;\n//            if (formValues.entityType == 'ASSET') {\n//                return assetService.saveAsset(vm.entity);\n//            } else if (formValues.entityType == 'DEVICE') {\n//                return deviceService.saveDevice(vm.entity);\n//            }\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.editEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if (attributes[key] !== vm.attributes[key]) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.editEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        for (let i=0; i < vm.relationsToDelete.length; i++) {\n//            let relation = {\n//                type: vm.relationsToDelete[i].relationType\n//            };\n//            if (vm.relationsToDelete[i].direction == 'FROM') {\n//                relation.to = vm.relationsToDelete[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = vm.relationsToDelete[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//}\n//\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openAddEntityDialog();\n//\n//function openAddEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\n//}\n//\n//function AddEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    }\n//\n//    vm.addEntityFormGroup = vm.fb.group({\n//      entityName: ['', [vm.validators.required]],\n//      entityType: ['DEVICE'],\n//      entityLabel: [null],\n//      type: ['', [vm.validators.required]],\n//      attributes: vm.fb.group({\n//          latitude: [null],\n//          longitude: [null],\n//          address: [null],\n//          owner: [null],\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//          booleanValue: [null]\n//      }),\n//      relations: vm.fb.array([])\n//    });\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.addEntityFormGroup.get('relations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//          relatedEntity: [null, [vm.validators.required]],\n//          relationType: [null, [vm.validators.required]],\n//          direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.addEntityFormGroup.markAsPristine();\n//        saveEntityObservable().subscribe(\n//            function (entity) {\n//                widgetContext.rxjs.forkJoin([\n//                    saveAttributes(entity.id),\n//                    saveRelations(entity.id)\n//                ]).subscribe(\n//                    function () {\n//                        widgetContext.updateAliases();\n//                        vm.dialogRef.close(null);\n//                    }\n//                );\n//            }\n//        );\n//    };\n//\n//    function saveEntityObservable() {\n//        const formValues = vm.addEntityFormGroup.value;\n//        let entity = {\n//            name: formValues.entityName,\n//            type: formValues.type,\n//            label: formValues.entityLabel\n//        };\n//        if (formValues.entityType == 'ASSET') {\n//            return assetService.saveAsset(entity);\n//        } else if (formValues.entityType == 'DEVICE') {\n//            return deviceService.saveDevice(entity);\n//        }\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if(attributes[key] !== null) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.addEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//}\n",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "02dfec67-3191-4297-f67d-679fc626c8b7"
              }, {
                "name" : "edit_relation",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "<!--=======================================================================-->\n<!--=====  There are two example templates: for edit and add entity   =====-->\n<!--=======================================================================-->\n<!--========================  Edit entity example  ========================-->\n<!--=======================================================================-->\n<!-- -->\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\n    <mat-toolbar fxLayout=\"row\" color=\"basic\">\n        <h2>Editar {{entityType.toLowerCase()}} {{entityName}}</h2>\n        <span fxFlex></span>\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\n            <mat-icon class=\"material-icons\">close</mat-icon>\n        </button>\n    </mat-toolbar>\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\n    </mat-progress-bar>\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\n    <div mat-dialog-content fxLayout=\"column\">\n        <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Entity Name</mat-label>-->\n        <!--        <input matInput formControlName=\"entityName\" required readonly=\"\">-->\n        <!--    </mat-form-field>-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Entity Label</mat-label>-->\n        <!--        <input matInput formControlName=\"entityLabel\">-->\n        <!--    </mat-form-field>-->\n        <!--</div>-->\n        <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Entity Type</mat-label>-->\n        <!--        <input matInput formControlName=\"entityType\" readonly>-->\n        <!--    </mat-form-field>-->\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--        <mat-label>Type</mat-label>-->\n        <!--        <input matInput formControlName=\"type\" readonly>-->\n        <!--    </mat-form-field>-->\n        <!--</div>-->\n        <!--<div formGroupName=\"attributes\" fxLayout=\"column\">-->\n        <!--    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--        <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--            <mat-label>Latitude</mat-label>-->\n        <!--            <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\n        <!--        </mat-form-field>-->\n        <!--        <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--            <mat-label>Longitude</mat-label>-->\n        <!--            <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\n        <!--        </mat-form-field>-->\n        <!--    </div>-->\n        <!--    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--        <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--            <mat-label>Address</mat-label>-->\n        <!--            <input matInput formControlName=\"address\">-->\n        <!--        </mat-form-field>-->\n        <!--        <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--            <mat-label>Owner</mat-label>-->\n        <!--            <input matInput formControlName=\"owner\">-->\n        <!--        </mat-form-field>-->\n        <!--    </div>-->\n        <!--    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n        <!--        <mat-form-field fxFlex class=\"mat-block\">-->\n        <!--            <mat-label>Integer Value</mat-label>-->\n        <!--            <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n        <!--            <mat-error *ngIf=\"editEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n        <!--                Invalid integer value.-->\n        <!--            </mat-error>-->\n        <!--        </mat-form-field>-->\n        <!--        <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n        <!--            <label class=\"checkbox-label\">Boolean Value</label>-->\n        <!--            <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n        <!--                {{ (editEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n        <!--            </mat-checkbox>-->\n        <!--        </div>-->\n        <!--    </div>-->\n        <!--</div>-->\n        <div class=\"relations-list old-relations\">\n            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relaciones existentes</div>\n            <div class=\"body\" [fxShow]=\"oldRelations().length\">\n                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"oldRelations\" \n                     *ngFor=\"let relation of oldRelations().controls; let i = index;\">\n                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">\n                        <div fxFlex fxLayout=\"column\">\n                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">\n                                    <mat-label>Dirección</mat-label>\n                                    <mat-select formControlName=\"direction\" name=\"direction\">\n                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">\n                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}\n                                        </mat-option>\n                                    </mat-select>\n                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">\n                                        Relation direction is required.\n                                    </mat-error>\n                                </mat-form-field>\n                                <tb-relation-type-autocomplete\n                                        fxFlex class=\"mat-block\"\n                                        formControlName=\"relationType\"\n                                        required=\"true\">\n                                </tb-relation-type-autocomplete>\n                            </div>\n                            <div fxLayout=\"row\" fxLayout.xs=\"column\">\n                                <tb-entity-select\n                                        fxFlex class=\"mat-block\"\n                                        required=\"true\"\n                                        formControlName=\"relatedEntity\">\n                                </tb-entity-select>\n                            </div>\n                        </div>\n                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">\n                            <button mat-icon-button color=\"primary\"\n                                    aria-label=\"Remove\"\n                                    type=\"button\"\n                                    (click)=\"removeOldRelation(i, relation.value)\"\n                                    matTooltip=\"Remover relación\"\n                                    matTooltipPosition=\"above\">\n                                <mat-icon>close</mat-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"relations-list\">\n            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Nuevas Relaciones</div>\n            <div class=\"body\" [fxShow]=\"relations().length\">\n                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">\n                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">\n                        <div fxFlex fxLayout=\"column\">\n                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\n                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">\n                                    <mat-label>Dirección</mat-label>\n                                    <mat-select formControlName=\"direction\" name=\"direction\">\n                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">\n                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}\n                                        </mat-option>\n                                    </mat-select>\n                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">\n                                        Relation direction is required.\n                                    </mat-error>\n                                </mat-form-field>\n                                <tb-relation-type-autocomplete\n                                        fxFlex class=\"mat-block\"\n                                        formControlName=\"relationType\"\n                                        [required]=\"true\">\n                                </tb-relation-type-autocomplete>\n                            </div>\n                            <div fxLayout=\"row\" fxLayout.xs=\"column\">\n                                <tb-entity-select\n                                        fxFlex class=\"mat-block\"\n                                        [required]=\"true\"\n                                        formControlName=\"relatedEntity\">\n                                </tb-entity-select>\n                            </div>\n                        </div>\n                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">\n                            <button mat-icon-button color=\"primary\"\n                                    aria-label=\"Remove\"\n                                    type=\"button\"\n                                    (click)=\"removeRelation(i)\"\n                                    matTooltip=\"Remover relación\"\n                                    matTooltipPosition=\"above\">\n                                <mat-icon>close</mat-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div>\n                <button mat-raised-button color=\"primary\"\n                        type=\"button\"\n                        (click)=\"addRelation()\"\n                        matTooltip=\"Agregar realción\"\n                        matTooltipPosition=\"above\">\n                    Add\n                </button>\n            </div>\n        </div>\n    </div>\n    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">\n        <button mat-button color=\"primary\"\n                type=\"button\"\n                [disabled]=\"(isLoading$ | async)\"\n                (click)=\"cancel()\" cdkFocusInitial>\n            Cancelar\n        </button>\n        <button mat-button mat-raised-button color=\"primary\"\n                type=\"submit\"\n                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty\">\n            Guardar\n        </button>\n    </div>\n</form>\n<!---->\n<!--========================================================================-->\n<!--=========================  Add entity example  =========================-->\n<!--========================================================================-->\n<!---->\n<!--<form #addEntityForm=\"ngForm\" [formGroup]=\"addEntityFormGroup\"-->\n<!--      (ngSubmit)=\"save()\" class=\"add-entity-form\">-->\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\n<!--        <h2>Add entity</h2>-->\n<!--        <span fxFlex></span>-->\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\n<!--        </button>-->\n<!--    </mat-toolbar>-->\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\n<!--    </mat-progress-bar>-->\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Name</mat-label>-->\n<!--                <input matInput formControlName=\"entityName\" required>-->\n<!--                <mat-error *ngIf=\"addEntityFormGroup.get('entityName').hasError('required')\">-->\n<!--                    Entity name is required.-->\n<!--                </mat-error>-->\n<!--            </mat-form-field>-->\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                <mat-label>Entity Label</mat-label>-->\n<!--                <input matInput formControlName=\"entityLabel\" >-->\n<!--            </mat-form-field>-->\n<!--        </div>-->\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--            <tb-entity-type-select-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"entityType\"-->\n<!--                    [showLabel]=\"true\"-->\n<!--                    [allowedEntityTypes]=\"allowedEntityTypes\"-->\n<!--            ></tb-entity-type-select>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value == 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'ASSET'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--            <tb-entity-subtype-autocomplete-->\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value != 'ASSET'\"-->\n<!--                    class=\"mat-block\"-->\n<!--                    formControlName=\"type\"-->\n<!--                    [required]=\"true\"-->\n<!--                    [entityType]=\"'DEVICE'\"-->\n<!--            ></tb-entity-subtype-autocomplete>-->\n<!--        </div>-->\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Latitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Longitude</mat-label>-->\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Address</mat-label>-->\n<!--                    <input matInput formControlName=\"address\">-->\n<!--                </mat-form-field>-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Owner</mat-label>-->\n<!--                    <input matInput formControlName=\"owner\">-->\n<!--                </mat-form-field>-->\n<!--            </div>-->\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\n<!--                    <mat-label>Integer Value</mat-label>-->\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\n<!--                    <mat-error *ngIf=\"addEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\n<!--                        Invalid integer value.-->\n<!--                    </mat-error>-->\n<!--                </mat-form-field>-->\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\n<!--                        {{ (addEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\n<!--                    </mat-checkbox>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--        <div class=\"relations-list\">-->\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\n<!--                        <div fxFlex fxLayout=\"column\">-->\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\n<!--                                    <mat-label>Direction</mat-label>-->\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\n<!--                                        </mat-option>-->\n<!--                                    </mat-select>-->\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\n<!--                                        Relation direction is required.-->\n<!--                                    </mat-error>-->\n<!--                                </mat-form-field>-->\n<!--                                <tb-relation-type-autocomplete-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        formControlName=\"relationType\"-->\n<!--                                        [required]=\"true\">-->\n<!--                                </tb-relation-type-autocomplete>-->\n<!--                            </div>-->\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\n<!--                                <tb-entity-select-->\n<!--                                        fxFlex class=\"mat-block\"-->\n<!--                                        [required]=\"true\"-->\n<!--                                        formControlName=\"relatedEntity\">-->\n<!--                                </tb-entity-select>-->\n<!--                            </div>-->\n<!--                        </div>-->\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\n<!--                            <button mat-icon-button color=\"primary\"-->\n<!--                                    aria-label=\"Remove\"-->\n<!--                                    type=\"button\"-->\n<!--                                    (click)=\"removeRelation(i)\"-->\n<!--                                    matTooltip=\"Remove relation\"-->\n<!--                                    matTooltipPosition=\"above\">-->\n<!--                                <mat-icon>close</mat-icon>-->\n<!--                            </button>-->\n<!--                        </div>-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n<!--            <div>-->\n<!--                <button mat-raised-button color=\"primary\"-->\n<!--                        type=\"button\"-->\n<!--                        (click)=\"addRelation()\"-->\n<!--                        matTooltip=\"Add Relation\"-->\n<!--                        matTooltipPosition=\"above\">-->\n<!--                    Add-->\n<!--                </button>-->\n<!--            </div>-->\n<!--        </div>-->\n<!--    </div>-->\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\n<!--        <button mat-button color=\"primary\"-->\n<!--                type=\"button\"-->\n<!--                [disabled]=\"(isLoading$ | async)\"-->\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\n<!--            Cancel-->\n<!--        </button>-->\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\n<!--                type=\"submit\"-->\n<!--                [disabled]=\"(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty\">-->\n<!--            Create-->\n<!--        </button>-->\n<!--    </div>-->\n<!--</form>-->\n",
                "customCss" : "/*=======================================================================*/\n/*==========  There are two examples: for edit and add entity  ==========*/\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n/*\n.edit-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.edit-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n/*\n.add-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.add-entity-form .boolean-value-input .checkbox-label {\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n",
                "customFunction" : "/*=======================================================================*/\n/*=====  There are three examples: for delete, edit and add entity  =====*/\n/*=======================================================================*/\n/*=======================  Delete entity example  =======================*/\n/*=======================================================================*/\n//\n// let $injector = widgetContext.$scope.$injector;\n// let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\n// let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n// let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n\n// openDeleteEntityDialog();\n\n// function openDeleteEntityDialog() {\n//     let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\n//                 entityName;\n//     let content = 'Are you sure you want to delete the ' +\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\n//     dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\n//         function(result) {\n//             if (result) {\n//                 deleteEntity();\n//             }\n//         }\n//     );\n// }\n// //\n// function deleteEntity() {\n//     deleteEntityObservable(entityId).subscribe(\n//         function success() {\n//             widgetContext.updateAliases();\n//         },\n//         function fail() {\n//             showErrorDialog();\n//         }\n//     );\n// }\n\n// function deleteEntityObservable(entityId) {\n//     if (entityId.entityType == \"ASSET\") {\n//         return assetService.deleteAsset(entityId.id);\n//     } else if (entityId.entityType == \"DEVICE\") {\n//         return deviceService.deleteDevice(entityId.id);\n//     }\n// }\n\n// function showErrorDialog() {\n//     let title = 'Error';\n//     let content = 'An error occurred while deleting the entity. Please try again.';\n//     dialogs.alert(title, content, 'CLOSE').subscribe(\n//         function(result) {}\n//     );\n// }\n//\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n//\nlet $injector = widgetContext.$scope.$injector;\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\nconsole.log(\"Relation=>\",entityId,entityName)\nopenEditEntityDialog();\n\nfunction openEditEntityDialog() {\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n}\n\nfunction EditEntityDialogController(instance) {\n    let vm = instance;\n\n    vm.entityName = entityName;\n    vm.entityType = entityId.entityType;\n    vm.entitySearchDirection = {\n        from: \"FROM\",\n        to: \"TO\"\n    };\n    vm.attributes = {};\n    vm.oldRelationsData = [];\n    vm.relationsToDelete = [];\n    vm.entity = {};\n\n    vm.editEntityFormGroup = vm.fb.group({\n        entityName: ['', [vm.validators.required]],\n        entityType: [null],\n        entityLabel: [null],\n        type: ['', [vm.validators.required]],\n        attributes: vm.fb.group({\n            latitude: [null],\n            longitude: [null],\n            address: [null],\n            owner: [null],\n            number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n            booleanValue: [false]\n        }),\n        oldRelations: vm.fb.array([]),\n        relations: vm.fb.array([])\n    });\n\n    getEntityInfo();\n\n    vm.cancel = function() {\n        vm.dialogRef.close(null);\n    };\n\n    vm.relations = function() {\n        return vm.editEntityFormGroup.get('relations');\n    };\n\n    vm.oldRelations = function() {\n        return vm.editEntityFormGroup.get('oldRelations');\n    };\n\n    vm.addRelation = function() {\n        vm.relations().push(vm.fb.group({\n            relatedEntity: [null, [vm.validators.required]],\n            relationType: [null, [vm.validators.required]],\n            direction: [null, [vm.validators.required]]\n        }));\n    };\n\n    function addOldRelation() {\n        vm.oldRelations().push(vm.fb.group({\n            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\n            relationType: [{value: null, disabled: true}, [vm.validators.required]],\n            direction: [{value: null, disabled: true}, [vm.validators.required]]\n        }));\n    }\n\n    vm.removeRelation = function(index) {\n        vm.relations().removeAt(index);\n        vm.relations().markAsDirty();\n    };\n\n    vm.removeOldRelation = function(index, relation) {\n        vm.oldRelations().removeAt(index);\n        vm.relationsToDelete.push(relation);\n        vm.oldRelations().markAsDirty();\n    };\n\n    vm.save = function() {\n        vm.editEntityFormGroup.markAsPristine();\n        widgetContext.rxjs.forkJoin([\n            saveAttributes(entityId),\n            saveRelations(entityId),\n            saveEntity()\n        ]).subscribe(\n            function () {\n                widgetContext.updateAliases();\n                vm.dialogRef.close(null);\n            }\n        );\n    };\n\n    function getEntityAttributes(attributes) {\n        for (var i = 0; i < attributes.length; i++) {\n            vm.attributes[attributes[i].key] = attributes[i].value;\n        }\n    }\n\n    function getEntityRelations(relations) {\n        let relationsFrom = relations[0];\n        let relationsTo = relations[1];\n        for (let i=0; i < relationsFrom.length; i++) {\n            let relation = {\n                direction: 'FROM',\n                relationType: relationsFrom[i].type,\n                relatedEntity: relationsFrom[i].to\n            };\n            vm.oldRelationsData.push(relation);\n            addOldRelation();\n        }\n        for (let i=0; i < relationsTo.length; i++) {\n            let relation = {\n                direction: 'TO',\n                relationType: relationsTo[i].type,\n                relatedEntity: relationsTo[i].from\n            };\n            vm.oldRelationsData.push(relation);\n            addOldRelation();\n        }\n    }\n\n    function getEntityInfo() {\n        widgetContext.rxjs.forkJoin([\n            entityRelationService.findInfoByFrom(entityId),\n            entityRelationService.findInfoByTo(entityId),\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\n            entityService.getEntity(entityId.entityType, entityId.id)\n        ]).subscribe(\n            function (data) {\n                getEntityRelations(data.slice(0,2));\n                getEntityAttributes(data[2]);\n                vm.entity = data[3];\n                vm.editEntityFormGroup.patchValue({\n                    entityName: vm.entity.name,\n                    entityType: vm.entityType,\n                    entityLabel: vm.entity.label,\n                    type: vm.entity.type,\n                    attributes: vm.attributes,\n                    oldRelations: vm.oldRelationsData\n                }, {emitEvent: false});\n            }\n        );\n    }\n\n    function saveEntity() {\n        const formValues = vm.editEntityFormGroup.value;\n        if (vm.entity.label !== formValues.entityLabel){\n            vm.entity.label = formValues.entityLabel;\n            if (formValues.entityType == 'ASSET') {\n                return assetService.saveAsset(vm.entity);\n            } else if (formValues.entityType == 'DEVICE') {\n                return deviceService.saveDevice(vm.entity);\n            }\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveAttributes(entityId) {\n        let attributes = vm.editEntityFormGroup.get('attributes').value;\n        let attributesArray = [];\n        for (let key in attributes) {\n            if (attributes[key] !== vm.attributes[key]) {\n                attributesArray.push({key: key, value: attributes[key]});\n            }\n        }\n        if (attributesArray.length > 0) {\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n\n    function saveRelations(entityId) {\n        let relations = vm.editEntityFormGroup.get('relations').value;\n        let tasks = [];\n        for(let i=0; i < relations.length; i++) {\n            let relation = {\n                type: relations[i].relationType,\n                typeGroup: 'COMMON'\n            };\n            if (relations[i].direction == 'FROM') {\n                relation.to = relations[i].relatedEntity;\n                relation.from = entityId;\n            } else {\n                relation.to = entityId;\n                relation.from = relations[i].relatedEntity;\n            }\n            tasks.push(entityRelationService.saveRelation(relation));\n        }\n        for (let i=0; i < vm.relationsToDelete.length; i++) {\n            let relation = {\n                type: vm.relationsToDelete[i].relationType\n            };\n            if (vm.relationsToDelete[i].direction == 'FROM') {\n                relation.to = vm.relationsToDelete[i].relatedEntity;\n                relation.from = entityId;\n            } else {\n                relation.to = entityId;\n                relation.from = vm.relationsToDelete[i].relatedEntity;\n            }\n            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\n        }\n        if (tasks.length > 0) {\n            return widgetContext.rxjs.forkJoin(tasks);\n        }\n        return widgetContext.rxjs.of([]);\n    }\n}\n\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openAddEntityDialog();\n//\n//function openAddEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\n//}\n//\n//function AddEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    }\n//\n//    vm.addEntityFormGroup = vm.fb.group({\n//      entityName: ['', [vm.validators.required]],\n//      entityType: ['DEVICE'],\n//      entityLabel: [null],\n//      type: ['', [vm.validators.required]],\n//      attributes: vm.fb.group({\n//          latitude: [null],\n//          longitude: [null],\n//          address: [null],\n//          owner: [null],\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//          booleanValue: [null]\n//      }),\n//      relations: vm.fb.array([])\n//    });\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.addEntityFormGroup.get('relations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//          relatedEntity: [null, [vm.validators.required]],\n//          relationType: [null, [vm.validators.required]],\n//          direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.addEntityFormGroup.markAsPristine();\n//        saveEntityObservable().subscribe(\n//            function (entity) {\n//                widgetContext.rxjs.forkJoin([\n//                    saveAttributes(entity.id),\n//                    saveRelations(entity.id)\n//                ]).subscribe(\n//                    function () {\n//                        widgetContext.updateAliases();\n//                        vm.dialogRef.close(null);\n//                    }\n//                );\n//            }\n//        );\n//    };\n//\n//    function saveEntityObservable() {\n//        const formValues = vm.addEntityFormGroup.value;\n//        let entity = {\n//            name: formValues.entityName,\n//            type: formValues.type,\n//            label: formValues.entityLabel\n//        };\n//        if (formValues.entityType == 'ASSET') {\n//            return assetService.saveAsset(entity);\n//        } else if (formValues.entityType == 'DEVICE') {\n//            return deviceService.saveDevice(entity);\n//        }\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if(attributes[key] !== null) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.addEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        }\n//        return widgetContext.rxjs.of([]);\n//    }\n//}\n",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "4840e3e2-8058-c2aa-a729-bc8085b17749"
              } ]
            }
          },
          "row" : 0,
          "col" : 0,
          "id" : "234ee92b-317f-4aa6-0666-ece734898b21"
        },
        "52babaef-733d-c2fc-4ee2-d30d7985980f" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "Latitude",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.659363614464622
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "Longitude",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.09837793686382024
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "Name",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.4260569647614103
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1714056029099,
                  "endTimeMs" : 1714142429099
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#FFFFFF00",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "const params = ctx.stateController.getStateParams();\r\nconsole.log(\"ParamsDefault=>\",params,data)\r\n//openViewDetail\r\nconst openDrawer = !!data.length\r\n\r\nconst viewMapAndGrid =   `<mat-drawer-container class=\"example-container\" hasBackdrop=false  autosize>\r\n  <mat-drawer #drawer class=\"example-sidenav\" [opened]=\"!!ctx?.stateController.getStateParams().openViewDetail\"  disableClose mode=\"over\" style=\"width: 35%; height: 100%; padding: 0; border-top-right-radius: 16px; border: 1px solid gray; min-width:600px;\"  >\r\n  <mat-toolbar fxLayout=\"row\"  style=\"height:2rem; background-color: #888;color:white;\"  >\r\n        <h6 style=\"color:white;\">{{ctx?.stateController.getStateParams()?.only_selected?.internalName?ctx?.stateController.getStateParams().only_selected?.internalName:ctx?.stateController?.getStateParams().only_selected?.entityName}} {{ctx?.stateController?.getStateParams().only_selected?.internalName?\"(\"+ctx?.stateController.getStateParams().only_selected?.entityName +\")\":''}}</h6>\r\n        <span fxFlex></span>\r\n        <button mat-icon-button id=\"close-drawer\"  type=\"button\" (click)=\"drawer.toggle()\"  >\r\n            <mat-icon class=\"material-icons\">close</mat-icon>\r\n        </button>\r\n    </mat-toolbar>\r\n     <mat-divider></mat-divider>\r\n    <tb-dashboard-state fxFlex [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"detail_switch_type\"></tb-dashboard-state>\r\n  </mat-drawer>\r\n\r\n  <div fxFlex fxLayout=\"row\" style=\"width: 100%; height: 100%; padding: 0;\">\r\n    <tb-dashboard-state fxFlex [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_container\"></tb-dashboard-state>\r\n    </div>\r\n</mat-drawer-container>`\r\n\r\n// return viewMapAndGrid;\r\n\r\n\r\nreturn `<div class=\"general-layout\" style=\"width: 100%; height: 100%; padding: 0;\" fxLayout=\"row\">\r\n    <div fxFlex fxLayout=\"column\" style=\"width: 100%; height: 100%; padding: 0; flex:1;\">\r\n        <div *ngIf=\"!ctx.stateController.getStateParams()?.defaultView || ctx.stateController.getStateParams()?.defaultView ==='viewMapAndGrid'\" style=\"width: 100%; height: 100%; padding: 0; flex:1;\" >${viewMapAndGrid}</div>\r\n        <tb-dashboard-state fxFlex *ngIf=\"ctx.stateController.getStateParams()?.defaultView ==='report'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"view_report\"></tb-dashboard-state>\r\n    </div>\r\n    <div class=\"general-view-options\" >\r\n        <button id='view_map_and_grid' mat-icon-button color=\"primary\" matTooltip=\"Monitoreo\" >\r\n            <mat-icon >\r\n                view_quilt\r\n            </mat-icon>\r\n        </button>\r\n        <button id='view_report' mat-icon-button color=\"primary\" matTooltip=\"Reportes\" >\r\n            <mat-icon >\r\n                summarize\r\n            </mat-icon>\r\n        </button>\r\n        <button id='view_status' mat-icon-button color=\"primary\" matTooltip=\"Estado de dispositivos\" >\r\n            <mat-icon >\r\n                devices_other\r\n            </mat-icon>\r\n        </button>\r\n     </div>\r\n</div>`",
              "applyDefaultMarkdownStyle" : true,
              "markdownCss" : ".general-view-options{\n    display:flex;\n    flex-direction: column;\n    /*gap:.25rem;*/\n    \n}\n\n.example-container{\n    width:100%;\n    height: 100%;\n    padding: 0;\n    \n}\n\n.example-sidenav-content{\n    width:100%;\n    height: 100%;\n    display:flex;\n    background-color: #ccc;\n}\n\n\n#close-drawer{\n    padding:0;\n    width:1.75rem;\n    height: 1.75rem;\n}"
            },
            "title" : "App container",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : false,
            "enableFullscreen" : false,
            "widgetStyle" : { },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "useDashboardTimewindow" : true,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : "",
            "actions" : {
              "elementClick" : [ {
                "name" : "close-drawer",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController.getStateId();\r\n\r\nconst hydrateParams = {...params, openViewDetail:false}\r\n\r\nconsole.log(\"CloseDrawer=>\", actualState, hydrateParams)\r\nwidgetContext.stateController.updateState(null, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\n// widgetContext.detectChanges()",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "5a201c32-452b-59b8-af5e-33abca821ad1"
              }, {
                "name" : "view_map_and_grid",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController.getStateId();\r\n\r\nconst hydrateParams = {...params, defaultView:'viewMapAndGrid'}\r\n\r\nconsole.log(\"DefaultView=>\", actualState, hydrateParams)\r\nwidgetContext.stateController.updateState(null, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\n// widgetContext.detectChanges()",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "6b51ed9e-227c-0661-2219-c30b14d7f435"
              }, {
                "name" : "view_report",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController.getStateId();\r\n\r\nconst hydrateParams = {...params, defaultView:'report'}\r\n\r\nconsole.log(\"DefaultView=>\", actualState, hydrateParams)\r\nwidgetContext.stateController.updateState(null, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\n// widgetContext.detectChanges()",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "deb8d334-4a64-d1d2-23db-a6416d96e75b"
              }, {
                "name" : "view_status",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "openDashboard",
                "targetDashboardStateId" : "default",
                "setEntityId" : true,
                "stateEntityParamName" : null,
                "openNewBrowserTab" : false,
                "targetDashboardId" : "83209e70-237a-11ef-832d-975fea959a44",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "006d8e4a-a022-bb3d-96f5-f381fc79039f"
              } ]
            }
          },
          "row" : 0,
          "col" : 0,
          "id" : "52babaef-733d-c2fc-4ee2-d30d7985980f"
        },
        "0adca16a-2722-8d11-8c71-b6e96961e129" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "741f1e9c-6259-607c-2b24-c272575d286b",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "type",
                "type" : "entityField",
                "label" : "Type",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.08205146184105949
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1716725483098,
                  "endTimeMs" : 1716811883098
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "console.log(\"Gridiew=>\",data)\n\nreturn `<div fxFlex fxLayout=\"column\" style=\"width: 100%; height: 100%; padding: 0;\">\n        <tb-dashboard-state fxFlex *ngIf=\"ctx?.stateController.getStateParams().data_map?.entityId.entityType!='DEVICE'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"devices_grid\"></tb-dashboard-state>\n        <tb-dashboard-state fxFlex *ngIf=\"ctx?.stateController.getStateParams().data_map?.entityId.entityType=='DEVICE'\" [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=\"device_grid\"></tb-dashboard-state>\n    </div>`;",
              "applyDefaultMarkdownStyle" : true
            },
            "title" : "New Markdown/HTML Card",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "useDashboardTimewindow" : true,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "0adca16a-2722-8d11-8c71-b6e96961e129"
        },
        "d8ae6266-8c01-91a7-4a59-8e6c2979bc32" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "openstreetmap",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 8.5,
          "sizeY" : 6,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "741f1e9c-6259-607c-2b24-c272575d286b",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "latitude",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.6214244120124848,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "longitude",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.9007753577513982,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "horometer",
                "color" : "#607d8b",
                "settings" : { },
                "_hash" : 0.14739883379473717,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "type",
                "type" : "entityField",
                "label" : "type",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.34649214014232266,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.3177842675719178
              }, {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "internalName",
                "color" : "#03a9f4",
                "settings" : { },
                "_hash" : 0.5987187978810822
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#ff9800",
                "settings" : { },
                "_hash" : 0.02478331648043075
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            }, {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "latitude",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.23954621184071345,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "longitude",
                "color" : "#ffc107",
                "settings" : { },
                "_hash" : 0.6829766580416616,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "horometer",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.7455856461152572,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.5053395549064494,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "type",
                "type" : "entityField",
                "label" : "type",
                "color" : "#ffeb3b",
                "settings" : { },
                "_hash" : 0.9194948472563877,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "internalName",
                "color" : "#673ab7",
                "settings" : { },
                "_hash" : 0.10811215857554446,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#cddc39",
                "settings" : { },
                "_hash" : 0.6469221973851627,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "isOnlySelected",
                "type" : "attribute",
                "label" : "isOnlySelected",
                "color" : "#009688",
                "settings" : { },
                "_hash" : 0.8907477788110824,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return true;"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1719344466438,
                  "endTimeMs" : 1719430866438
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "provider" : "openstreet-map",
              "gmApiKey" : "AIzaSyDoEx2kaGz3PxwbI9T7ccTSg5xjdw8Nw8Q",
              "gmDefaultMapType" : "roadmap",
              "mapProvider" : "OpenStreetMap.Mapnik",
              "useCustomProvider" : false,
              "customProviderTileUrl" : "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
              "mapProviderHere" : "HERE.normalDay",
              "credentials" : {
                "useV3" : true,
                "app_id" : "AhM6TzD9ThyK78CT3ptx",
                "app_code" : "p6NPiITB3Vv0GMUFnkLOOg",
                "apiKey" : "kVXykxAfZ6LS4EbCTO02soFVfjA7HoBzNVVH9u7nzoE"
              },
              "mapImageUrl" : "data:image/svg+xml;base64,PHN2ZyBpZD0ic3ZnMiIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTAwIiB3aWR0aD0iMTAwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgdmlld0JveD0iMCAwIDEwMCAxMDAiPgogPGcgaWQ9ImxheWVyMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtOTUyLjM2KSI+CiAgPHJlY3QgaWQ9InJlY3Q0Njg0IiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBoZWlnaHQ9Ijk5LjAxIiB3aWR0aD0iOTkuMDEiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB5PSI5NTIuODYiIHg9Ii40OTUwNSIgc3Ryb2tlLXdpZHRoPSIuOTkwMTAiIGZpbGw9IiNlZWUiLz4KICA8dGV4dCBpZD0idGV4dDQ2ODYiIHN0eWxlPSJ3b3JkLXNwYWNpbmc6MHB4O2xldHRlci1zcGFjaW5nOjBweDt0ZXh0LWFuY2hvcjptaWRkbGU7dGV4dC1hbGlnbjpjZW50ZXIiIGZvbnQtd2VpZ2h0PSJib2xkIiB4bWw6c3BhY2U9InByZXNlcnZlIiBmb250LXNpemU9IjEwcHgiIGxpbmUtaGVpZ2h0PSIxMjUlIiB5PSI5NzAuNzI4MDkiIHg9IjQ5LjM5NjQ3NyIgZm9udC1mYW1pbHk9IlJvYm90byIgZmlsbD0iIzY2NjY2NiI+PHRzcGFuIGlkPSJ0c3BhbjQ2OTAiIHg9IjUwLjY0NjQ3NyIgeT0iOTcwLjcyODA5Ij5JbWFnZSBiYWNrZ3JvdW5kIDwvdHNwYW4+PHRzcGFuIGlkPSJ0c3BhbjQ2OTIiIHg9IjQ5LjM5NjQ3NyIgeT0iOTgzLjIyODA5Ij5pcyBub3QgY29uZmlndXJlZDwvdHNwYW4+PC90ZXh0PgogIDxyZWN0IGlkPSJyZWN0NDY5NCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgaGVpZ2h0PSIxOS4zNiIgd2lkdGg9IjY5LjM2IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgeT0iOTkyLjY4IiB4PSIxNS4zMiIgc3Ryb2tlLXdpZHRoPSIuNjM5ODYiIGZpbGw9Im5vbmUiLz4KIDwvZz4KPC9zdmc+Cg==",
              "tmApiKey" : "84d6d83e0e51e481e50454ccbe8986b",
              "tmDefaultMapType" : "roadmap",
              "latKeyName" : "latitude",
              "lngKeyName" : "longitude",
              "xPosKeyName" : "xPos",
              "yPosKeyName" : "yPos",
              "defaultCenterPosition" : "-34,-64",
              "disableScrollZooming" : false,
              "disableDoubleClickZooming" : false,
              "disableZoomControl" : false,
              "fitMapBounds" : true,
              "useDefaultCenterPosition" : false,
              "mapPageSize" : 16384,
              "markerOffsetX" : 0.5,
              "markerOffsetY" : 1,
              "posFunction" : "return {x: origXPos, y: origYPos};",
              "draggableMarker" : false,
              "showLabel" : false,
              "useLabelFunction" : false,
              "label" : "${entityName}",
              "showTooltip" : true,
              "showTooltipAction" : "hover",
              "autocloseTooltip" : true,
              "useTooltipFunction" : true,
              "tooltipPattern" : "<b>${entityName}</b><br/><br/><b>Latitude:</b> ${latitude:7}<br/><b>Longitude:</b> ${longitude:7}",
              "tooltipFunction" : "return `\n    <b>${data.internalName ? data.internalName : ''}</b><br/>\n    <b>${data.entityName}</b><br/>\n    <b>Horometro:</b> ${data.horometer ? data.horometer.toFixed(1) :'-'}<br/>\n`",
              "tooltipOffsetX" : 0,
              "tooltipOffsetY" : -1,
              "color" : "#fe7569",
              "useColorFunction" : false,
              "useMarkerImageFunction" : true,
              "markerImageSize" : 34,
              "markerImageFunction" : "const url = \"https://qr.twindimension.com/api/marker\"\n\nlet urlIcon = `${url}?color=${data.active==\"true\"?'66cc12':'b8b6b6'}`\n\nif(isJson(data.img)){\n    urlIcon = `${urlIcon}&name=${JSON.parse(data.img).name?JSON.parse(data.img).name.replace(\".png\",''):'default'}`\n    return {\n        url:urlIcon,\n        size:40\n    }\n}\n\nreturn {\n    url: urlIcon,\n    size:40\n}\n\n// var type = dsData[dsIndex]['Type'];\n// if (type == 'thermometer') {\n// \tvar res = {\n// \t    url: images[0],\n// \t    size: 40\n// \t}\n// \tvar temperature = dsData[dsIndex]['temperature'];\n// \tif (typeof temperature !== undefined) {\n// \t    var percent = (temperature + 60)/120;\n// \t    var index = Math.min(3, Math.floor(4 * percent));\n// \t    res.url = images[index];\n// \t}\n// \treturn res;\n// }\n\n\nfunction isJson(text){\n  try {\n    JSON.parse(text);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}",
              "markerImages" : [ "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAB/CAYAAAD4mHJdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAACWAAAAlgB7MGOJQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAwgSURBVGiB7Zt5cBT3lce/v18fc89oRoPEIRBCHIUxp2ywCAgIxLExvoidZIFNxXE2VXHirIO3aqtSseM43qpNeZfYKecox3bhpJykYgdjDkU2mBAB5vCamMNYAgQyURBCoxnNPd39O/aP7hGSEUR24L/uqqf+zfR77/Pe69/Rv6kWwcgPLRIJfZUAa7xez2xd90QBwDSNZKlkHJHAK+l09mUA7BP4vPpRUVExMVoRef+L998njxx9X57vPi/PnTsnO850yPaT7XLXrrflqjtWymhF+HA0Gp0wEp/kHymEQqG4ptJDGzf+um5RUxMSiV7Z3Lyt88L5nozgHJWj4pGmpqZav99PWve04onHHuswmViQzWb7ruZX+Udgv8/z3A+f/NGye1evxssvb+wo5PMfTZs6bfqcuXNHL7hlweh58+ZVAOTUpk2b0p9dvjyqqmrs/b8ejpUMc+unzjgUCsXjsYruE+2n1JY/NedM0zCi0VjA7/d7/f4AAgE//H4/vF4fOjvP9h5695C/oaEhcN/q1SyTzVdnMpnklXzTq4EplUsXfmaRCgC7du3cOn78+KfGj59Add3z1Md1vV7vqPa2D1sA4MYbZ6qUiqVX9X21i4TQcfX19QCA6urquN/vn0kAPRQKpYbTnzRpUhgAampqAEFrPjVYSql7fD4AgK5r2tV0AcDj8WkAoOk6JJGeTw2+nocLdsEu2AW7YBfsgl2wC3bBLtgFu2AX7IJdsAt2wS7YBbtgF+yCXbALdsEu2AW7YBfsgl2wC76mh/ppjIQgXVloPxVSBRV0rBe455P6+kTKBYF3tonxY/IWarry7DvI298Tgp0PR9RzACaN1NeIS100+EdvKXW3cMZvF8wCK10Sq2it2NAzakmukP/wmoP/KuId3BRUMg5uCfCSNVSKVn1rNto7Un8jLrUVqJ4Fi2eEQiEYBzOsy3SYL37TNQdzi8Q5FxkqJIQBsNLlYMGF/zqAJWBxSEogDAY+DJibYqTuRg4WFgO3OKhCYTExbKk5G/mbkSPP2DQhLA5IO/NhSz1MMP882BDgnAFQwdiVSs2vPVhYDIJLUMkBgw1favM6lJoZDDAYhKbAYsOX+rqAhcXAuQSIAKzhSy2vS8YmB7NYH4WCfM7kw5VaWtdpOO3bfWZJZVXgPxMX898bVsm6RhkTIseX29yyIErm/J5z5vwr6pvmsLYjBgeDwSpVJS/OmT1n1de+9qANZgLc4q9Dyj2qQhUhSSUAUCL7GBcchCymTEYBYNWqVXj30MGHT586PZEJ+WAul7ts8bjspd9QKDRNU2nz4z94YtI3H3oI+XwB//3j/9m77eRUUJ9/0eh4APGoDz6vCi4ksgUTmYyBC4k8RLGwtzF+EGu+tHqRqqrYtm0rXnzhhQ7G5cpsNnvyiuBIJFKnqvSd55772eilS5fhwIH9ye+/dPaEf1T9otW3T8GtiyYgGNBBymYEgLSbvakidu8/h01vnkYhcab1gcVs5tx5c6PHjh7DU0/9qFsINPb3939UZg28X11dXR0Qwtr9g8efqGtc+Bn89re/O7FhR9BXNaFm+n98uxHTZ1SDKQqKAihweZlITUVtXQwNs8fg+Bmzdk+bnmPdf/7bwsbGeO2ECaED+9/5XCxWuTGbzVpDwJpGNtx+28o77rr7bmzZsu3k7z+cMlHzeiPrvnoTwtVhFAVQHAZY4HBEoiAAeDXUjI/gyJGeQEd6TFj2tHYuXNgYy2azVe0fngiWDLNloHNFo4FZkXDsoTVr1+KD4x8U/3Ci1qP5PV7N74FeFUbClKDEriy57A5JANL5a68hnqoINL8OAPqbXbNp7clTxTVr1/oOHjr0MFXxq2Qy9wEFACnoY//6la9QAHj+9Q/eUL2RWkVXoWgqkhZBypRImkDKBFIWkLIk+h1JWdL+zrmeNCWSDFB0DYquQvWG637TcnozAKxbt45yTr8PAGowGBwVDAbvmT9/Pvbu3dddijV9WdUUUE0BUQm6kwaCYe+ljK/w8ruUdsYCBLlMEUQhoJoCygWM+LIvHTx4sGfevIbqYMD3BSFkJVUUrG5oaFABoPXwhd1UVUBVahtpKtoOnEV/gSHHgBwDso5c6XO6yNF24CNQTbV9qBRUUenuwz1/BoCZM2dplOJeSggWL1myFEII9IeXziIKBVUUW1QKo2Ci41Anei9kkWcY6Ex5R8qfc0wi0ZPF6QNnYeQNB2j7IQpFOtg0WwiBxoWNIBKLVQI6Z8rUqTh69FiWaFNmEIWgLFShoM5TZbIzgVxvFp6ID5rfA6JQgBAIxsGLJkrpAsycAcH4gN1gX0QPTW9vP5Grr58cJJTOpbqmjgWAnp6ei4QSEEJAKAGh1BbHCS2DLAFmMAgmICwObjDnyYMMAtJL9oN89vRc7KWUQtOUsSqhSggA8sWivSEh9qBxTiCEAGRwQARUVaB67Hf5pZAQlA0Ayrq2LTCogVyhlLURNEw55yYABP2+4ED3vHSClBKQ9jiFdHqvEBCMQzAOKYSt6/RqSGnbDPJRbgT93hAAcM4NyhjrBYDKylhswEEZJgYJFxDchnGTwSqasIomuMnsIDiH5GKIzUAQTsCVlZUxB9xLIUVbKpVEff3kiLTMfimEA7HP5bZgHMJ07mnJAiuaYEXT3jcZDMLkTgBD7exgBKRp9NfVTQwnk0kIKduoJGRH8/ZmhMNh4skc3DnEkDlAi4GbtjDDguVAmZM1M6yB68JyKsCGBqD373s7GAySnTt3gBDyFhWCvPHee/8HAJhTU5g0BMg4uMXBTT4AZSUTrGjBKpiwCnablQbDbZuyfTmAuRPMegA4euQopCRbaCaTOd2XSLzX3d2Nu+64bR7PnP3LJSCDMBm4YW9FWcmyQYMytsW+Zpfdsm1MdimAdMc7K29bMedCdzeSyeS76XT6jLNI4PGf/+w5aLqOu25IjOOWKcSg0jJjcLZ2ecsZD5TdybqsOxC0ZYpbJ58frek6nn/+eVBJHgecjXkqk2nu7Ozcdfz4cdx556rJN5C3m8v3jBt2xpdnazjysawNy5lUbKkrbmtZsWL5pGNHj6Or62+7k5lMy5CFNRQKTfN6tAMvvvhSRe3EOqx/4oXXLvia7qO6CsVZrey5154KB5YpKSG5tHs+5/ZsZnEIk6Ei1fLH73373i/09fXi0fWPpgyTLchkMqeGgAEgHA5/vjJWsf2PmzYr1dXV+K8fP7vjLxduWkY8ilpetQZPg+UJxh63lzqlNDi7gTa3fuPraz6bzxXw79/5FutP51am0+kdZdaQ/2kzDKNDUci51179w8pbP3er8sAD6+pnVCWy+/fs21LAqBnlMT50qJXFLq2a2L/5gaVy7N133j69u7sb67/7iFHIFf4tlU6/Ppg1kLGU8hYAywBMeOWV33gfXb9+1Q+ffDL+4Ne/AcYY/tS8PbV5++4Dhy+MopY2ZrLiidQDgDBSp5TS+Y7psS65ZOHsW26++eYosxje2PwGNm586eKzz/x027+sXWsBOAfgbULIQQAgUspaAA8BGAfnsamrq4u0tZ0Q333kkdGmZS3f8JNnlBXLV0AOilRKCS7sWYlxjlKxgHw+j5Y3W/C/Tz/NQ6Hgjp9seKZ31py5ajwe4wAtz9zdAH5OpJTPAqgEgL5USkpu4eLFHloqFXniYh9t3bunauuWrStisSi5//4vYnHTEkyZOhWqokBICcuy0N7ehr2trXjt1VeRzqTl3ffc81bjgsZELF4pQ6EAqa4eI6UEicfj5dhTKoCikynx6Bop5C14dJ2XcjmouipvvGFGoSJaWfr738/7tmzdjl/88pfIZjKwnH2SpmkIhSMYW1ODhvmNGFcztjhudFXR69Wgck58Hg+XEorH5ylDJYA8kVKOckpdB0ADIBOJhOzv70OhUFILuTzPZLNcSE6SfSlvJp0O5A1DN0qGDxLS4/OUAh6PGQqHC5XxeJEQgkgoRH1+L/wBP6LRuIjH4+Uf8gSAUwB+MbhzzQSwCMA0p/QUQADgNJ/PJ/v7+wnnnFiWkJZhKCYzKADoqiZUXeW67iGcSxKPx2QoFAo7AybnuE8COAZgHyHkxGXjeFAQEQCzANQCqAIQBeAH4AXgcex052w45TMcyQHIAOgBcBbAUUJI5uOM/wcaHmf3g9UM7QAAAABJRU5ErkJggg==", "data:image/png;base64,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", "data:image/png;base64,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", "data:image/png;base64,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" ],
              "showPolygon" : false,
              "polygonKeyName" : "perimeter",
              "editablePolygon" : false,
              "showPolygonLabel" : false,
              "usePolygonLabelFunction" : false,
              "polygonLabel" : "${entityName}",
              "showPolygonTooltip" : false,
              "showPolygonTooltipAction" : "click",
              "autoClosePolygonTooltip" : true,
              "usePolygonTooltipFunction" : false,
              "polygonTooltipPattern" : "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
              "polygonColor" : "#3388ff",
              "polygonOpacity" : 0.2,
              "usePolygonColorFunction" : false,
              "polygonStrokeColor" : "#3388ff",
              "polygonStrokeOpacity" : 1,
              "polygonStrokeWeight" : 3,
              "usePolygonStrokeColorFunction" : false,
              "showCircle" : false,
              "circleKeyName" : "perimeter",
              "editableCircle" : false,
              "showCircleLabel" : false,
              "useCircleLabelFunction" : false,
              "circleLabel" : "${entityName}",
              "showCircleTooltip" : false,
              "showCircleTooltipAction" : "click",
              "autoCloseCircleTooltip" : true,
              "useCircleTooltipFunction" : false,
              "circleTooltipPattern" : "<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}",
              "circleFillColor" : "#3388ff",
              "circleFillColorOpacity" : 0.2,
              "useCircleFillColorFunction" : false,
              "circleStrokeColor" : "#3388ff",
              "circleStrokeOpacity" : 1,
              "circleStrokeWeight" : 3,
              "useCircleStrokeColorFunction" : false,
              "snappable" : false,
              "initDragMode" : false,
              "hideAllControlButton" : false,
              "hideDrawControlButton" : false,
              "hideEditControlButton" : false,
              "hideRemoveControlButton" : false,
              "useClusterMarkers" : true,
              "zoomOnClick" : true,
              "maxZoom" : 6,
              "maxClusterRadius" : 50,
              "animate" : true,
              "spiderfyOnMaxZoom" : true,
              "showCoverageOnHover" : true,
              "chunkedLoading" : true,
              "removeOutsideVisibleBounds" : true,
              "useIconCreateFunction" : true,
              "clusterMarkerFunction" : "let customColor;\r\n/*for (let markerData of data) {\r\n    if(markerData.temperature > 40) {\r\n        customColor = '#9054ff'\r\n        break\r\n    }\r\n}*/\r\nreturn customColor ? customColor : '#7072ff'"
            },
            "title" : "New TD OpenStreetMap",
            "dropShadow" : false,
            "enableFullscreen" : false,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : true,
            "showLegend" : false,
            "widgetStyle" : { },
            "actions" : {
              "markerClick" : [ {
                "name" : "select marcker",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "\r\n// console.log(\"Click Marcker\", additionalParams)\r\n\r\n\r\nconst params = widgetContext.stateController\r\n.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController\r\n    .getStateId();\r\n\r\nconst dataInternalName = widgetContext.data.find(({\r\n        datasource,\r\n        dataKey\r\n    }) => datasource.entityId === entityId.id && dataKey\r\n    .name === 'internalName')\r\n\r\nconst internalName = dataInternalName.data[0][1] ?\r\n    dataInternalName.data[0][1] : '';\r\n\r\nconst hydrateParams = {\r\n    ...params,\r\n    viewMap: \"map\",\r\n    only_selected: {\r\n        entityId,\r\n        entityName,\r\n        entityLabel,\r\n        internalName\r\n    },\r\n    openViewDetail: true\r\n}\r\n\r\n// widgetContext.stateController.updateState(actualState, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\nwidgetContext.stateController.updateState(null,\r\n    hydrateParams, )\r\n\r\n// --- ADD SELECTED MARKER ----------------------------------------------\r\nconst selectedMarkerFilter = widgetContext.data.filter(d => d.datasource.entityId === entityId.id && (d.dataKey.name === \"Latitude\" || d.dataKey.name === \"Longitude\"))\r\n\r\nconst selectedData = selectedMarkerFilter.reduce((a, d) => {\r\n    const lat = d.dataKey.name === \"Latitude\" ? d.data[0][1] : a.lat\r\n    const lng = d.dataKey.name === \"Longitude\" ? d.data[0][1] : a.lng\r\n    return { lat, lng }\r\n}, { lat: 0, lng: 0 })\r\n\r\nif(widgetContext.selectedMarker){\r\n    widgetContext.updateSelectedMarker(selectedData)\r\n}\r\nelse{\r\n    widgetContext.createSelectedMarker(selectedData)\r\n}\r\n\r\n",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "ae12ecfd-855b-84c4-cef6-d43ba250267e"
              } ]
            },
            "showTitleIcon" : false,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "d8ae6266-8c01-91a7-4a59-8e6c2979bc32"
        },
        "45eae83c-0276-1612-2b51-5b753cdead41" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "attributes_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 7.5,
          "sizeY" : 3,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "Nombre Interno",
                "color" : "#ffeb3b",
                "settings" : { },
                "_hash" : 0.3107319510211415,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "Numero de serie",
                "color" : "#03a9f4",
                "settings" : { },
                "_hash" : 0.371660735357924,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "Origen de los datos",
                "color" : "#ff9800",
                "settings" : { },
                "_hash" : 0.6607412200694922,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return typeof value === 'string' ? value.replace(\"Client\",''):value;"
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.23406298887516042,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "\nconst objectValue = isJson(value) ? JSON.parse(value) : value \n\nconst {name, src, title} = objectValue\n\nreturn objectValue ? `<img mat-raised-button src=${src} alt=${name?name:'name'} width=\"28\" title=${title?title:'Imagen'} >`:value\n\n\n\n\n\nfunction isJson(text){\n  try {\n    JSON.parse(text);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}"
              }, {
                "name" : "model",
                "type" : "attribute",
                "label" : "Modelo",
                "color" : "#ffc107",
                "settings" : { },
                "_hash" : 0.1477104448179114,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "materialIcon",
                "type" : "attribute",
                "label" : "materialIcon",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.10487978926739672
              }, {
                "name" : "status",
                "type" : "attribute",
                "label" : "Status",
                "color" : "#03a9f4",
                "settings" : { },
                "_hash" : 0.45513226432617815,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Marca",
                "type" : "attribute",
                "label" : "brand",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.5420281967019778,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "buildingSite",
                "type" : "attribute",
                "label" : "Obra",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.06657409082621135,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "client",
                "type" : "attribute",
                "label" : "Alquilado a",
                "color" : "#e91e63",
                "settings" : { },
                "_hash" : 0.8485732390344554,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1692902077761,
                  "endTimeMs" : 1692988477761
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "8px",
            "settings" : {
              "title_table" : "Datos Generales"
            },
            "title" : "New Attributes card",
            "useDashboardTimewindow" : true,
            "showTitleIcon" : false,
            "dropShadow" : true,
            "enableFullscreen" : false,
            "enableDataExport" : false,
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : "",
            "showLegend" : false
          },
          "row" : 0,
          "col" : 0,
          "id" : "45eae83c-0276-1612-2b51-5b753cdead41"
        },
        "c018ab1f-8d4d-6619-0430-b3b8ecab9832" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "attributes_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 7.5,
          "sizeY" : 3,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "Horometro",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.5495168734754283,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Latitude",
                "type" : "timeseries",
                "label" : "Latitude",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.22617484279382682,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : 5,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "\nreturn round10(value,-10);\n\n\nfunction decimalAdjust(type, value, exp) {\n  type = String(type);\n  if (![\"round\", \"floor\", \"ceil\"].includes(type)) {\n    return value\n  }\n  exp = Number(exp);\n  value = Number(value);\n  if (exp % 1 !== 0 || Number.isNaN(value)) {\n    return NaN;\n  } else if (exp === 0) {\n    return Math[type](value);\n  }\n  const [magnitude, exponent = 0] = value.toString().split(\"e\");\n  const adjustedValue = Math[type](`${magnitude}e${exponent - exp}`);\n  // Shift back\n  const [newMagnitude, newExponent = 0] = adjustedValue.toString().split(\"e\");\n  return Number(`${newMagnitude}e${+newExponent + exp}`);\n}\n\nfunction round10  (value, exp){ return decimalAdjust(\"round\", value, exp)}"
              }, {
                "name" : "Longitude",
                "type" : "timeseries",
                "label" : "Longitude",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.7121766820106914,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : 5,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "\n// console.log(\"Decimal\",newValue )\nreturn round10(value,-10);\n\n\nfunction decimalAdjust(type, value, exp) {\n  type = String(type);\n  if (![\"round\", \"floor\", \"ceil\"].includes(type)) {\n    return value\n  }\n  exp = Number(exp);\n  value = Number(value);\n  if (exp % 1 !== 0 || Number.isNaN(value)) {\n    return NaN;\n  } else if (exp === 0) {\n    return Math[type](value);\n  }\n  const [magnitude, exponent = 0] = value.toString().split(\"e\");\n  const adjustedValue = Math[type](`${magnitude}e${exponent - exp}`);\n  // Shift back\n  const [newMagnitude, newExponent = 0] = adjustedValue.toString().split(\"e\");\n  return Number(`${newMagnitude}e${+newExponent + exp}`);\n}\n\nfunction round10  (value, exp){ return decimalAdjust(\"round\", value, exp)}"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1692901994802,
                  "endTimeMs" : 1692988394802
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "title_table" : "Telemetria"
            },
            "title" : "New Attributes card",
            "useDashboardTimewindow" : true,
            "showTitleIcon" : false,
            "dropShadow" : true,
            "enableFullscreen" : false,
            "enableDataExport" : false,
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : "",
            "showLegend" : false
          },
          "row" : 0,
          "col" : 0,
          "id" : "c018ab1f-8d4d-6619-0430-b3b8ecab9832"
        },
        "c4138fda-5287-fa53-8685-a2487b481653" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "entities_table",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 11.5,
          "sizeY" : 6.5,
          "config" : {
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 86400000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1687437869074,
                  "endTimeMs" : 1687524269074
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "NONE",
                "limit" : 200
              }
            },
            "showTitle" : false,
            "backgroundColor" : "rgb(255, 255, 255)",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "enableSearch" : true,
              "enableSelectColumnDisplay" : true,
              "enableStickyHeader" : true,
              "enableStickyAction" : true,
              "reserveSpaceForHiddenAction" : "true",
              "displayEntityName" : true,
              "entityNameColumnTitle" : "Dispositivo",
              "displayEntityLabel" : false,
              "displayEntityType" : false,
              "displayPagination" : true,
              "defaultPageSize" : 10,
              "defaultSortOrder" : "entityName",
              "useRowStyleFunction" : false
            },
            "title" : "Activos",
            "dropShadow" : false,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400,
              "padding" : "5px 10px 5px 10px"
            },
            "useDashboardTimewindow" : false,
            "showLegend" : false,
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "741f1e9c-6259-607c-2b24-c272575d286b",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "Nombre Interno",
                "color" : "#8bc34a",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.4249513019019435,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "brand",
                "type" : "attribute",
                "label" : "Marca",
                "color" : "#e91e63",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.7179575293837932,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "model",
                "type" : "attribute",
                "label" : "Modelo",
                "color" : "#03a9f4",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.9484018579178719,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "Origen de datos",
                "color" : "#673ab7",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.6176628230519621,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return typeof value === 'string' ? value.replace(\"Client\",''):value;"
              }, {
                "name" : "client",
                "type" : "attribute",
                "label" : "Alquilado a",
                "color" : "#ffeb3b",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.17423510835986544,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "buildingSite",
                "type" : "attribute",
                "label" : "Obra",
                "color" : "#3f51b5",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.6144192246540723,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "Imagen",
                "color" : "#ff9800",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.12766194296777789,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "\nconst objectValue = isJson(value) ? JSON.parse(value) : value \n\nconst {name, src, title} = objectValue\n\nreturn objectValue ? `<img mat-raised-button src=${src} alt=${name?name:'name'} width=\"28\" title=${title?title:'Imagen'} >`:value\n\n\n\n\n\nfunction isJson(text){\n  try {\n    JSON.parse(text);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "displayTimewindow" : true,
            "actions" : {
              "rowClick" : [ {
                "name" : "select machine",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController\r\n.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController\r\n    .getStateId();\r\n\r\nconst dataInternalName = widgetContext.data.find(({\r\n        datasource,\r\n        dataKey\r\n    }) => datasource.entityId === entityId.id && dataKey\r\n    .name === 'internalName')\r\n\r\nconst internalName = dataInternalName.data[0][1] ?\r\n    dataInternalName.data[0][1] : '';\r\n\r\nconst hydrateParams = {\r\n    ...params,\r\n    viewMap: \"detail\",\r\n    only_selected: {\r\n        entityId,\r\n        entityName,\r\n        entityLabel,\r\n        internalName\r\n    },\r\n    openViewDetail: true\r\n}\r\n\r\n// widgetContext.stateController.updateState(actualState, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\nwidgetContext.stateController.updateState(null,\r\n    hydrateParams, )",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "5909edb9-f872-911c-69cc-56e440876977"
              } ],
              "actionCellButton" : [ {
                "name" : "Edit machine",
                "icon" : "edit",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "<!--=======================================================================-->\r\n<!--=====  There are two example templates: for edit and add entity   =====-->\r\n<!--=======================================================================-->\r\n<!--========================  Edit entity example  ========================-->\r\n<!--=======================================================================-->\r\n<!-- -->\r\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\r\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\r\n    <mat-toolbar fxLayout=\"row\" color=\"basic\">\r\n        <h2>Editar {{entityType.toLowerCase()}} {{internalName ?? entityName}}</h2>\r\n        <span fxFlex></span>\r\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n            <mat-icon class=\"material-icons\">close</mat-icon>\r\n        </button>\r\n    </mat-toolbar>\r\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\r\n    </mat-progress-bar>\r\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\r\n    <div mat-dialog-content class=\"dialog-content\" fxLayout=\"column\">\r\n        <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n        <!--        <mat-label>Numero interno</mat-label>-->\r\n        <!--        <input matInput formControlName=\"internal_number\"  >-->\r\n        <!--    </mat-form-field>-->\r\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n        <!--        <mat-label>Obra</mat-label>-->\r\n        <!--        <input matInput formControlName=\"building_site\">-->\r\n        <!--    </mat-form-field>-->\r\n        <!--</div>-->\r\n        <div formGroupName=\"attributes\" fxLayout=\"column\">\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n            <mat-form-field fxFlex class=\"mat-block\">\r\n                <mat-label>Nombre interno</mat-label>\r\n                <input matInput formControlName=\"internalName\" >\r\n            </mat-form-field>\r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Modelo</mat-label>\r\n                    <input matInput formControlName=\"model\">\r\n                </mat-form-field>\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Marca</mat-label>\r\n                    <input matInput formControlName=\"brand\">\r\n                </mat-form-field>\r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Obra</mat-label>\r\n                    <input matInput formControlName=\"buildingSite\" >\r\n                </mat-form-field>\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Cliente</mat-label>\r\n                    <input matInput formControlName=\"client\">\r\n                </mat-form-field>\r\n            </div>\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Status</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Selecciona un status\" name=\"status\" (selectionChange)=\"onChangeSelectStatus(status)\" [(ngModel)]=\"status\" >-->\r\n            <!--            <mat-option *ngFor=\"let status of statusOptions\" [value]=\"status\" >{{ status }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Ubicación YPF</mat-label>-->\r\n            <!--        <input matInput formControlName=\"ypf_location\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--</div>-->\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Tipo de Combustible</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Tipo de Combustible\" name=\"fuel_type\" (selectionChange)=\"onChangeSelectFuelType(fuel_type)\" [(ngModel)]=\"fuel_type\" >-->\r\n            <!--            <mat-option *ngFor=\"let fuel_type of typeFuelOptions\" [value]=\"fuel_type\" >{{ fuel_type }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Telecomando</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Telecomando\" name=\"telecommand\" (selectionChange)=\"onChangeSelectTelecommand(telecommand)\" [(ngModel)]=\"telecommand\" >-->\r\n            <!--            <mat-option *ngFor=\"let telecommand of telecommandOptions\" [value]=\"telecommand.value\" >{{ telecommand.label }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--</div>-->\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Potencia Activa (Kw)</mat-label>-->\r\n            <!--        <input matInput type=\"number\" formControlName=\"active_power\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Potencia Reactiva (Kva)</mat-label>-->\r\n            <!--        <input matInput type=\"number\" formControlName=\"reactive_power\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--</div>-->\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Rango de facturación</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Rango de facturación\" name=\"billing_range\" (selectionChange)=\"onChangeSelectBillingRange(billing_range)\" [(ngModel)]=\"billing_range\" >-->\r\n            <!--            <mat-option *ngFor=\"let billing_range of billingRangeOptions\" [value]=\"billing_range.value\" >{{ billing_range.label }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n               \r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"start center\">\r\n                <button (click)=\"onOpenListImg()\" color=\"accent\" mat-icon-button matTooltip=\"Selecciona una imagen\" type=\"button\">\r\n                    <mat-icon class=\"material-icons-outlined\">\r\n                        {{!imgToSet ? \"add_photo_alternate\" : \"add_photo_alternate\"}}\r\n                    </mat-icon>\r\n                </button>\r\n                <h5 *ngIf=\"!(!!imgToSet || showListImg)\" >Haz click en el button \"+\" para setear una imagen al asset\r\n                </h5>\r\n                <div *ngIf=\"!!imgToSet\" class=\"img-to-set\" [matTooltip]=\"imgToSet.title\" mat-raised-button color=\"accent\" matBadge=\"✓\"  >\r\n                    <img  width=\"42\"  [src]=\"imgToSet.src\" [alt]=\"imgToSet.name\">\r\n                </div>\r\n            </div>\r\n            <div *ngIf=\"imgs.length > 0 && showListImg\" class=\"list-img\" >\r\n                <div *ngFor=\"let img of imgs\" (click)=\"onSelectImg(img)\" [matTooltip]=\"img.title\" mat-raised-button class=\"img-to-set\" color=\"accent\" matBadge=\"✓\" [matBadgeHidden]=\"!(img.name===imgToSet?.name)\" style=\"cursor:pointer;\"  >\r\n                    <img *ngIf=\"!!img.name\" width=\"42\"  [src]=\"img.src\" [alt]=\"img.name\">\r\n                </div>\r\n            </div>\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Integer Value</mat-label>-->\r\n            <!--        <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\r\n            <!--        <mat-error *ngIf=\"editEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\r\n            <!--            Invalid integer value.-->\r\n            <!--        </mat-error>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\r\n            <!--        <label class=\"checkbox-label\">Boolean Value</label>-->\r\n            <!--        <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\r\n            <!--            {{ (editEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\r\n            <!--        </mat-checkbox>-->\r\n            <!--    </div>-->\r\n            <!--</div>-->\r\n        </div>\r\n        <!--<div class=\"relations-list old-relations\">-->\r\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\r\n        <!--    <div class=\"body\" [fxShow]=\"oldRelations().length\">-->\r\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"oldRelations\" -->\r\n        <!--             *ngFor=\"let relation of oldRelations().controls; let i = index;\">-->\r\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n        <!--                <div fxFlex fxLayout=\"column\">-->\r\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n        <!--                            <mat-label>Direction</mat-label>-->\r\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n        <!--                                </mat-option>-->\r\n        <!--                            </mat-select>-->\r\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n        <!--                                Relation direction is required.-->\r\n        <!--                            </mat-error>-->\r\n        <!--                        </mat-form-field>-->\r\n        <!--                        <tb-relation-type-autocomplete-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                formControlName=\"relationType\"-->\r\n        <!--                                required=\"true\">-->\r\n        <!--                        </tb-relation-type-autocomplete>-->\r\n        <!--                    </div>-->\r\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n        <!--                        <tb-entity-select-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                required=\"true\"-->\r\n        <!--                                formControlName=\"relatedEntity\">-->\r\n        <!--                        </tb-entity-select>-->\r\n        <!--                    </div>-->\r\n        <!--                </div>-->\r\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n        <!--                    <button mat-icon-button color=\"primary\"-->\r\n        <!--                            aria-label=\"Remove\"-->\r\n        <!--                            type=\"button\"-->\r\n        <!--                            (click)=\"removeOldRelation(i, relation.value)\"-->\r\n        <!--                            matTooltip=\"Remove relation\"-->\r\n        <!--                            matTooltipPosition=\"above\">-->\r\n        <!--                        <mat-icon>close</mat-icon>-->\r\n        <!--                    </button>-->\r\n        <!--                </div>-->\r\n        <!--            </div>-->\r\n        <!--        </div>-->\r\n        <!--    </div>-->\r\n        <!--</div>-->\r\n        <!--<div class=\"relations-list\">-->\r\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">New Relations</div>-->\r\n        <!--    <div class=\"body\" [fxShow]=\"relations().length\">-->\r\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\r\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n        <!--                <div fxFlex fxLayout=\"column\">-->\r\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n        <!--                            <mat-label>Direction</mat-label>-->\r\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n        <!--                                </mat-option>-->\r\n        <!--                            </mat-select>-->\r\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n        <!--                                Relation direction is required.-->\r\n        <!--                            </mat-error>-->\r\n        <!--                        </mat-form-field>-->\r\n        <!--                        <tb-relation-type-autocomplete-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                formControlName=\"relationType\"-->\r\n        <!--                                [required]=\"true\">-->\r\n        <!--                        </tb-relation-type-autocomplete>-->\r\n        <!--                    </div>-->\r\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n        <!--                        <tb-entity-select-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                [required]=\"true\"-->\r\n        <!--                                formControlName=\"relatedEntity\">-->\r\n        <!--                        </tb-entity-select>-->\r\n        <!--                    </div>-->\r\n        <!--                </div>-->\r\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n        <!--                    <button mat-icon-button color=\"primary\"-->\r\n        <!--                            aria-label=\"Remove\"-->\r\n        <!--                            type=\"button\"-->\r\n        <!--                            (click)=\"removeRelation(i)\"-->\r\n        <!--                            matTooltip=\"Remove relation\"-->\r\n        <!--                            matTooltipPosition=\"above\">-->\r\n        <!--                        <mat-icon>close</mat-icon>-->\r\n        <!--                    </button>-->\r\n        <!--                </div>-->\r\n        <!--            </div>-->\r\n        <!--        </div>-->\r\n        <!--    </div>-->\r\n        <!--    <div>-->\r\n        <!--        <button mat-raised-button color=\"primary\"-->\r\n        <!--                type=\"button\"-->\r\n        <!--                (click)=\"addRelation()\"-->\r\n        <!--                matTooltip=\"Add Relation\"-->\r\n        <!--                matTooltipPosition=\"above\">-->\r\n        <!--            Add-->\r\n        <!--        </button>-->\r\n        <!--    </div>-->\r\n        <!--</div>-->\r\n    </div>\r\n    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">\r\n        <button mat-button color=\"primary\"\r\n                type=\"button\"\r\n                [disabled]=\"(isLoading$ | async)\"\r\n                (click)=\"cancel()\" cdkFocusInitial>\r\n            Cancel\r\n        </button>\r\n        <button mat-button mat-raised-button color=\"primary\"\r\n                type=\"submit\"\r\n                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid\">\r\n            Save\r\n        </button>\r\n    </div>\r\n</form>\r\n<!---->\r\n<!--========================================================================-->\r\n<!--=========================  Add entity example  =========================-->\r\n<!--========================================================================-->\r\n<!---->\r\n<!--<form #addEntityForm=\"ngForm\" [formGroup]=\"addEntityFormGroup\"-->\r\n<!--      (ngSubmit)=\"save()\" class=\"add-entity-form\">-->\r\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\r\n<!--        <h2>Add entity</h2>-->\r\n<!--        <span fxFlex></span>-->\r\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\r\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\r\n<!--        </button>-->\r\n<!--    </mat-toolbar>-->\r\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\r\n<!--    </mat-progress-bar>-->\r\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\r\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\r\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                <mat-label>Entity Name</mat-label>-->\r\n<!--                <input matInput formControlName=\"entityName\" required>-->\r\n<!--                <mat-error *ngIf=\"addEntityFormGroup.get('entityName').hasError('required')\">-->\r\n<!--                    Entity name is required.-->\r\n<!--                </mat-error>-->\r\n<!--            </mat-form-field>-->\r\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                <mat-label>Entity Label</mat-label>-->\r\n<!--                <input matInput formControlName=\"entityLabel\" >-->\r\n<!--            </mat-form-field>-->\r\n<!--        </div>-->\r\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--            <tb-entity-type-select-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"entityType\"-->\r\n<!--                    [showLabel]=\"true\"-->\r\n<!--                    [allowedEntityTypes]=\"allowedEntityTypes\"-->\r\n<!--            ></tb-entity-type-select>-->\r\n<!--            <tb-entity-subtype-autocomplete-->\r\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value == 'ASSET'\"-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"type\"-->\r\n<!--                    [required]=\"true\"-->\r\n<!--                    [entityType]=\"'ASSET'\"-->\r\n<!--            ></tb-entity-subtype-autocomplete>-->\r\n<!--            <tb-entity-subtype-autocomplete-->\r\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value != 'ASSET'\"-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"type\"-->\r\n<!--                    [required]=\"true\"-->\r\n<!--                    [entityType]=\"'DEVICE'\"-->\r\n<!--            ></tb-entity-subtype-autocomplete>-->\r\n<!--        </div>-->\r\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Latitude</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\r\n<!--                </mat-form-field>-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Longitude</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\r\n<!--                </mat-form-field>-->\r\n<!--            </div>-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Address</mat-label>-->\r\n<!--                    <input matInput formControlName=\"address\">-->\r\n<!--                </mat-form-field>-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Owner</mat-label>-->\r\n<!--                    <input matInput formControlName=\"owner\">-->\r\n<!--                </mat-form-field>-->\r\n<!--            </div>-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Integer Value</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\r\n<!--                    <mat-error *ngIf=\"addEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\r\n<!--                        Invalid integer value.-->\r\n<!--                    </mat-error>-->\r\n<!--                </mat-form-field>-->\r\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\r\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\r\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\r\n<!--                        {{ (addEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\r\n<!--                    </mat-checkbox>-->\r\n<!--                </div>-->\r\n<!--            </div>-->\r\n<!--        </div>-->\r\n<!--        <div class=\"relations-list\">-->\r\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\r\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\r\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\r\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n<!--                        <div fxFlex fxLayout=\"column\">-->\r\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n<!--                                    <mat-label>Direction</mat-label>-->\r\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n<!--                                        </mat-option>-->\r\n<!--                                    </mat-select>-->\r\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n<!--                                        Relation direction is required.-->\r\n<!--                                    </mat-error>-->\r\n<!--                                </mat-form-field>-->\r\n<!--                                <tb-relation-type-autocomplete-->\r\n<!--                                        fxFlex class=\"mat-block\"-->\r\n<!--                                        formControlName=\"relationType\"-->\r\n<!--                                        [required]=\"true\">-->\r\n<!--                                </tb-relation-type-autocomplete>-->\r\n<!--                            </div>-->\r\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n<!--                                <tb-entity-select-->\r\n<!--                                        fxFlex class=\"mat-block\"-->\r\n<!--                                        [required]=\"true\"-->\r\n<!--                                        formControlName=\"relatedEntity\">-->\r\n<!--                                </tb-entity-select>-->\r\n<!--                            </div>-->\r\n<!--                        </div>-->\r\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n<!--                            <button mat-icon-button color=\"primary\"-->\r\n<!--                                    aria-label=\"Remove\"-->\r\n<!--                                    type=\"button\"-->\r\n<!--                                    (click)=\"removeRelation(i)\"-->\r\n<!--                                    matTooltip=\"Remove relation\"-->\r\n<!--                                    matTooltipPosition=\"above\">-->\r\n<!--                                <mat-icon>close</mat-icon>-->\r\n<!--                            </button>-->\r\n<!--                        </div>-->\r\n<!--                    </div>-->\r\n<!--                </div>-->\r\n<!--            </div>-->\r\n<!--            <div>-->\r\n<!--                <button mat-raised-button color=\"primary\"-->\r\n<!--                        type=\"button\"-->\r\n<!--                        (click)=\"addRelation()\"-->\r\n<!--                        matTooltip=\"Add Relation\"-->\r\n<!--                        matTooltipPosition=\"above\">-->\r\n<!--                    Add-->\r\n<!--                </button>-->\r\n<!--            </div>-->\r\n<!--        </div>-->\r\n<!--    </div>-->\r\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\r\n<!--        <button mat-button color=\"primary\"-->\r\n<!--                type=\"button\"-->\r\n<!--                [disabled]=\"(isLoading$ | async)\"-->\r\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\r\n<!--            Cancel-->\r\n<!--        </button>-->\r\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\r\n<!--                type=\"submit\"-->\r\n<!--                [disabled]=\"(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty\">-->\r\n<!--            Create-->\r\n<!--        </button>-->\r\n<!--    </div>-->\r\n<!--</form>-->",
                "customCss" : ".dialog-content{\r\n   min-width: 45rem; \r\n}\r\n\r\n.list-img{\r\n    display:grid; \r\n    grid-template-columns:repeat(auto-fit, minmax(60px, 1fr)); \r\n    justify-items:center; \r\n    align-items: flex-start; \r\n    grid-auto-rows:1fr; \r\n    gap:1rem;\r\n}\r\n\r\n.img-to-set{\r\n    background:#eee; \r\n    border-radius:3px; \r\n    width:60px; \r\n    height:60px; \r\n    margin:2px;    \r\n    display:flex; \r\n    align-items:center; \r\n    justify-content:center;\r\n}\r\n\r\n\r\n/*=======================================================================*/\r\n/*==========  There are two examples: for edit and add entity  ==========*/\r\n/*=======================================================================*/\r\n/*========================  Edit entity example  ========================*/\r\n/*=======================================================================*/\r\n/*\r\n.edit-entity-form .boolean-value-input {\r\n    padding-left: 5px;\r\n}\r\n\r\n.edit-entity-form .boolean-value-input .checkbox-label {\r\n    color: rgba(0,0,0,0.54);\r\n    font-size: 12px;\r\n}\r\n\r\n.relations-list .header {\r\n    padding-right: 5px;\r\n    padding-bottom: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .header .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n    font-size: 12px;\r\n    font-weight: 700;\r\n    color: rgba(0, 0, 0, .54);\r\n    white-space: nowrap;\r\n}\r\n\r\n.relations-list .mat-form-field-infix {\r\n    width: auto !important;\r\n}\r\n\r\n.relations-list .body {\r\n    padding-right: 5px;\r\n    padding-bottom: 15px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .row {\r\n    padding-top: 5px;\r\n}\r\n\r\n.relations-list .body .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .md-button {\r\n    margin: 0;\r\n}\r\n*/\r\n/*========================================================================*/\r\n/*=========================  Add entity example  =========================*/\r\n/*========================================================================*/\r\n/*\r\n.add-entity-form .boolean-value-input {\r\n    padding-left: 5px;\r\n}\r\n\r\n.add-entity-form .boolean-value-input .checkbox-label {\r\n    color: rgba(0,0,0,0.54);\r\n    font-size: 12px;\r\n}\r\n\r\n.relations-list .header {\r\n    padding-right: 5px;\r\n    padding-bottom: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .header .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n    font-size: 12px;\r\n    font-weight: 700;\r\n    color: rgba(0, 0, 0, .54);\r\n    white-space: nowrap;\r\n}\r\n\r\n.relations-list .mat-form-field-infix {\r\n    width: auto !important;\r\n}\r\n\r\n.relations-list .body {\r\n    padding-right: 5px;\r\n    padding-bottom: 15px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .row {\r\n    padding-top: 5px;\r\n}\r\n\r\n.relations-list .body .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .md-button {\r\n    margin: 0;\r\n}\r\n*/",
                "customFunction" : "/*=======================================================================*/\r\n/*=====  There are three examples: for delete, edit and add entity  =====*/\r\n/*=======================================================================*/\r\n/*=======================  Delete entity example  =======================*/\r\n/*=======================================================================*/\r\n//\r\n//let $injector = widgetContext.$scope.$injector;\r\n//let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\r\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n//\r\n//openDeleteEntityDialog();\r\n//\r\n//function openDeleteEntityDialog() {\r\n//    let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\r\n//                 entityName;\r\n//    let content = 'Are you sure you want to delete the ' +\r\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\r\n//    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\r\n//        function(result) {\r\n//            if (result) {\r\n//                deleteEntity();\r\n//            }\r\n//        }\r\n//    );\r\n//}\r\n//\r\n//function deleteEntity() {\r\n//    deleteEntityObservable(entityId).subscribe(\r\n//        function success() {\r\n//            widgetContext.updateAliases();\r\n//        },\r\n//        function fail() {\r\n//            showErrorDialog();\r\n//        }\r\n//    );\r\n//}\r\n//\r\n//function deleteEntityObservable(entityId) {\r\n//    if (entityId.entityType == \"ASSET\") {\r\n//        return assetService.deleteAsset(entityId.id);\r\n//    } else if (entityId.entityType == \"DEVICE\") {\r\n//        return deviceService.deleteDevice(entityId.id);\r\n//    }\r\n//}\r\n//\r\n//function showErrorDialog() {\r\n//    let title = 'Error';\r\n//    let content = 'An error occurred while deleting the entity. Please try again.';\r\n//    dialogs.alert(title, content, 'CLOSE').subscribe(\r\n//        function(result) {}\r\n//    );\r\n//}\r\n//\r\n/*=======================================================================*/\r\n/*========================  Edit entity example  ========================*/\r\n/*=======================================================================*/\r\n//\r\nlet $injector = widgetContext.$scope.$injector;\r\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\r\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\r\n\r\nconst aliases = widgetContext.aliasController.getEntityAliases()\r\nconst params = widgetContext.stateController.getStateParams()\r\nconst dataEntity = params.only_selected\r\nconsole.log(\"Aliases=>\",entityId)\r\n\r\nopenEditEntityDialog();\r\n\r\nfunction openEditEntityDialog() {\r\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\r\n}\r\n\r\nfunction EditEntityDialogController(instance) {\r\n    let vm = instance;\r\n\r\n    vm.entityName = entityName ? entityName.entityName : \"\";\r\n    vm.entityType = entityId ? entityId.entityType : \"\";\r\n    vm.entitySearchDirection = {\r\n        from: \"FROM\",\r\n        to: \"TO\"\r\n    };\r\n    vm.attributes = {};\r\n    vm.oldRelationsData = [];\r\n    vm.relationsToDelete = [];\r\n    vm.entity = {};\r\n    \r\n    vm.showListImg = false;\r\n    vm.imgToSet = null;\r\n    \r\n    //--get info from repositories --//\r\n    vm.imgs = imgRepository();\r\n    // vm.statusOptions = statusRepository();\r\n    // vm.modelOptions = modelRepository();\r\n    // vm.telecommandOptions = telecommandRepository()\r\n    // vm.typeFuelOptions = typeFuelRepository()\r\n    // vm.billingRangeOptions = billingRangeRepository()\r\n    //--------//\r\n\r\n    vm.editEntityFormGroup = vm.fb.group({\r\n        entityName: ['', [vm.validators.required]],\r\n        entityType: [null],\r\n        entityLabel: [null],\r\n        type: ['', [vm.validators.required]],\r\n        attributes: vm.fb.group({\r\n            model: [null],\r\n            img : [null],\r\n            internalName: [null],\r\n            buildingSite: [null],\r\n            client: [null],\r\n            brand: [null]\r\n        }),\r\n    });\r\n\r\n    getEntityInfo();\r\n    \r\n    vm.onOpenListImg = ()=>{\r\n        vm.showListImg = true\r\n    }\r\n    \r\n    vm.onSelectImg = (image)=>{\r\n        // console.log(\"onSelect=>\",e)\r\n        vm.imgToSet = image\r\n        vm.showListImg = false\r\n    } \r\n    \r\n    //-- handlers selects --//\r\n    vm.onChangeSelectStatus = (status)=>{\r\n        vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: {...vm.attributes,status },\r\n                }, {emitEvent: false});\r\n    }\r\n    \r\n    vm.onChangeSelectModel = (model)=>{\r\n        vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: {...vm.attributes,model },\r\n                }, {emitEvent: false});\r\n    }\r\n    \r\n   \r\n    \r\n    \r\n    \r\n    \r\n    \r\n\r\n//-----------------------------------------------------------------------//\r\n\r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n\r\n    vm.relations = function() {\r\n        return vm.editEntityFormGroup.get('relations');\r\n    };\r\n\r\n    vm.oldRelations = function() {\r\n        return vm.editEntityFormGroup.get('oldRelations');\r\n    };\r\n\r\n    vm.addRelation = function() {\r\n        vm.relations().push(vm.fb.group({\r\n            relatedEntity: [null, [vm.validators.required]],\r\n            relationType: [null, [vm.validators.required]],\r\n            direction: [null, [vm.validators.required]]\r\n        }));\r\n    };\r\n\r\n    function addOldRelation() {\r\n        vm.oldRelations().push(vm.fb.group({\r\n            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\r\n            relationType: [{value: null, disabled: true}, [vm.validators.required]],\r\n            direction: [{value: null, disabled: true}, [vm.validators.required]]\r\n        }));\r\n    }\r\n\r\n    vm.removeRelation = function(index) {\r\n        vm.relations().removeAt(index);\r\n        vm.relations().markAsDirty();\r\n    };\r\n\r\n    vm.removeOldRelation = function(index, relation) {\r\n        vm.oldRelations().removeAt(index);\r\n        vm.relationsToDelete.push(relation);\r\n        vm.oldRelations().markAsDirty();\r\n    };\r\n\r\n    vm.save = function() {\r\n        vm.editEntityFormGroup.markAsPristine();\r\n        widgetContext.rxjs.forkJoin([\r\n            saveAttributes(entityId),\r\n            saveEntity()\r\n        ]).subscribe(\r\n            function () {\r\n                widgetContext.updateAliases();\r\n                vm.dialogRef.close(null);\r\n            }\r\n        );\r\n    };\r\n\r\n    function getEntityAttributes(attributes) {\r\n        for (var i = 0; i < attributes.length; i++) {\r\n            vm.attributes[attributes[i].key] = attributes[i].value;\r\n        }\r\n    }\r\n\r\n    function getEntityRelations(relations) {\r\n        let relationsFrom = relations[0];\r\n        let relationsTo = relations[1];\r\n        for (let i=0; i < relationsFrom.length; i++) {\r\n            let relation = {\r\n                direction: 'FROM',\r\n                relationType: relationsFrom[i].type,\r\n                relatedEntity: relationsFrom[i].to\r\n            };\r\n            vm.oldRelationsData.push(relation);\r\n            addOldRelation();\r\n        }\r\n        for (let i=0; i < relationsTo.length; i++) {\r\n            let relation = {\r\n                direction: 'TO',\r\n                relationType: relationsTo[i].type,\r\n                relatedEntity: relationsTo[i].from\r\n            };\r\n            vm.oldRelationsData.push(relation);\r\n            addOldRelation();\r\n        }\r\n    }\r\n\r\n    function getEntityInfo() {\r\n        widgetContext.rxjs.forkJoin([\r\n            entityRelationService.findInfoByFrom(entityId),\r\n            entityRelationService.findInfoByTo(entityId),\r\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\r\n            entityService.getEntity(entityId.entityType, entityId.id)\r\n        ]).subscribe(\r\n            function (data) {\r\n                // getEntityRelations(data.slice(0,2));\r\n                getEntityAttributes(data[2]);\r\n                vm.internalName = vm.attributes.internalName\r\n                vm.entity = data[3];\r\n                vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: vm.attributes,\r\n                }, {emitEvent: false});\r\n                // console.log(\"GetEntityIfo=>\",vm.attributes)\r\n                if(isJson(vm.attributes.img)){\r\n                    vm.imgToSet = JSON.parse(vm.attributes.img)\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    function saveEntity() {\r\n        const formValues = vm.editEntityFormGroup.value;\r\n        if (vm.entity.name !== formValues.entityName){\r\n            vm.entity.name = formValues.entityName;\r\n            if (formValues.entityType == 'ASSET') {\r\n                return assetService.saveAsset(vm.entity);\r\n            } else if (formValues.entityType == 'DEVICE') {\r\n                return deviceService.saveDevice(vm.entity);\r\n            }\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n\r\n    function saveAttributes(entityId) {\r\n        let attributes = vm.editEntityFormGroup.get('attributes').value;\r\n        \r\n        if(vm.imgToSet!= vm.attributes.img){\r\n            attributes = {...attributes, img:JSON.stringify(vm.imgToSet)}\r\n        }\r\n        \r\n        let attributesArray = [];\r\n        for (let key in attributes) {\r\n            if (attributes[key] !== vm.attributes[key]) {\r\n                attributesArray.push({key: key, value: attributes[key]});\r\n            }\r\n        }\r\n        if (attributesArray.length > 0) {\r\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n\r\n    function saveRelations(entityId) {\r\n        let relations = vm.editEntityFormGroup.get('relations').value;\r\n        let tasks = [];\r\n        for(let i=0; i < relations.length; i++) {\r\n            let relation = {\r\n                type: relations[i].relationType,\r\n                typeGroup: 'COMMON'\r\n            };\r\n            if (relations[i].direction == 'FROM') {\r\n                relation.to = relations[i].relatedEntity;\r\n                relation.from = entityId;\r\n            } else {\r\n                relation.to = entityId;\r\n                relation.from = relations[i].relatedEntity;\r\n            }\r\n            tasks.push(entityRelationService.saveRelation(relation));\r\n        }\r\n        for (let i=0; i < vm.relationsToDelete.length; i++) {\r\n            let relation = {\r\n                type: vm.relationsToDelete[i].relationType\r\n            };\r\n            if (vm.relationsToDelete[i].direction == 'FROM') {\r\n                relation.to = vm.relationsToDelete[i].relatedEntity;\r\n                relation.from = entityId;\r\n            } else {\r\n                relation.to = entityId;\r\n                relation.from = vm.relationsToDelete[i].relatedEntity;\r\n            }\r\n            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\r\n        }\r\n        if (tasks.length > 0) {\r\n            return widgetContext.rxjs.forkJoin(tasks);\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n    \r\n    function isJson(text){\r\n      try {\r\n        JSON.parse(text);\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction imgRepository(){\r\n    const externalUrl = 'https://qr.twindimension.com/'\r\n    const endpoint = `${externalUrl}/icons/profiles`\r\n    return [\r\n        {\r\n        name: false,\r\n        title: 'Default',\r\n        src: ``,\r\n        },\r\n          {\r\n            name: 'AIRE-small-air.png',\r\n            title: 'Aire chico',\r\n            src: `${endpoint}/AIRE-small-air.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-big-air.png',\r\n            title: 'Aire grande',\r\n            src: `${endpoint}/AIRE-big-air.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-electrico-M75.png',\r\n            title: 'Aire Hasta 75kw',\r\n            src: `${endpoint}/AIRE-electrico-H75.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-electrico-M75.png',\r\n            title: 'Aire más de 75kw',\r\n            src: `${endpoint}/AIRE-electrico-M75.png`,\r\n          },\r\n          {\r\n            name: 'AWP-elevador-pers.png',\r\n            title: 'Elevador personal',\r\n            src: `${endpoint}/AWP-elevador-pers.png`,\r\n          },\r\n          {\r\n            name: 'AWP-pluma-artic.png',\r\n            title: 'Pluma articulada',\r\n            src: `${endpoint}/AWP-pluma-artic.png`,\r\n          },\r\n          {\r\n            name: 'AWP-pluma-telesc.png',\r\n            title: 'Pluma telescópica',\r\n            src: `${endpoint}/AWP-pluma-telesc.png`,\r\n          },\r\n          {\r\n            name: 'AWP-tijeras.png',\r\n            title: 'Tijeras',\r\n            src: `${endpoint}/AWP-tijeras.png`,\r\n          },\r\n          {\r\n            name: 'ERADC-container.png',\r\n            title: 'Generador Container',\r\n            src: `${endpoint}/ERADC-container.png`,\r\n          },{\r\n            name: 'ERADC-diesel.png',\r\n            title: 'Generador diesel',\r\n            src: `${endpoint}/ERADC-diesel.png`,\r\n          },\r\n          {\r\n            name: 'ERADC-trailer.png',\r\n            title: 'Generador trailer',\r\n            src: `${endpoint}/ERADC-trailer.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camion-artic.png',\r\n            title: 'Camión articulado',\r\n            src: `${endpoint}/TIERRA-camion-artic.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camioneta.png',\r\n            title: 'Camión rígido',\r\n            src: `${endpoint}/TIERRA-camion-rigido.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camion-rigido.png',\r\n            title: 'Camioneta',\r\n            src: `${endpoint}/TIERRA-camioneta.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-cargador-frontal.png',\r\n            title: 'Cargador frontal',\r\n            src: `${endpoint}/TIERRA-cargador-frontal.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-carg-frt-retroex.png',\r\n            title: 'Cargador retroexcavadora',\r\n            src: `${endpoint}/TIERRA-carg-frt-retroex.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-compactadora.png',\r\n            title: 'Compactadora',\r\n            src: `${endpoint}/TIERRA-compactadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-excavadora.pn',\r\n            title: 'Excavadora',\r\n            src: `${endpoint}/TIERRA-excavadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-minicargadora.png',\r\n            title: 'Minicargadora',\r\n            src: `${endpoint}/TIERRA-minicargadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-miniexcavadora.png',\r\n            title: 'Miniexcavadora',\r\n            src: `${endpoint}/TIERRA-miniexcavadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-motoniveladora.png',\r\n            title: 'Motoniveladora',\r\n            src: `${endpoint}/TIERRA-motoniveladora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-topadora.png',\r\n            title: 'Topadora',\r\n            src: `${endpoint}/TIERRA-topadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-tractor.png',\r\n            title: 'Tractor',\r\n            src: `${endpoint}/TIERRA-tractor.png`,\r\n          },\r\n          {\r\n            name: 'TLH-autoelevadora-D.png',\r\n            title: 'Autoelevador diesel',\r\n            src: `${endpoint}/TLH-autoelevadora-D.png`,\r\n          },\r\n          {\r\n            name: 'TLH-autoelevadora-E.png',\r\n            title: 'Autoelevador eléctrico',\r\n            src: `${endpoint}/TLH-autoelevadora-E.png`,\r\n          },\r\n          {\r\n            name: 'TLH-compacto-oruga.png',\r\n            title: 'Compacto con oruga',\r\n            src: `${endpoint}/TLH-compacto-oruga.png`,\r\n          },\r\n          {\r\n            name: 'TLH-manipuladora-H6.png',\r\n            title: 'Manipuladora hasta 6tn',\r\n            src: `${endpoint}/TLH-manipuladora-H6.png`,\r\n          },\r\n          {\r\n            name: 'TLH-manipuladora-M6.png',\r\n            title: 'Manipuladora más de 6tn',\r\n            src: `${endpoint}/TLH-manipuladora-M6.png`,\r\n          },\r\n      {\r\n        name: 'TORRE-torre.png',\r\n        title: 'Torre',\r\n        src: `${endpoint}/TORRE-torre.png`,\r\n      },\r\n];\r\n}\r\n\r\n\r\n\r\n\r\n/*========================================================================*/\r\n/*=========================  Add entity example  =========================*/\r\n/*========================================================================*/\r\n//\r\n//let $injector = widgetContext.$scope.$injector;\r\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\r\n//\r\n//openAddEntityDialog();\r\n//\r\n//function openAddEntityDialog() {\r\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\r\n//}\r\n//\r\n//function AddEntityDialogController(instance) {\r\n//    let vm = instance;\r\n//\r\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\r\n//    vm.entitySearchDirection = {\r\n//        from: \"FROM\",\r\n//        to: \"TO\"\r\n//    }\r\n//\r\n//    vm.addEntityFormGroup = vm.fb.group({\r\n//      entityName: ['', [vm.validators.required]],\r\n//      entityType: ['DEVICE'],\r\n//      entityLabel: [null],\r\n//      type: ['', [vm.validators.required]],\r\n//      attributes: vm.fb.group({\r\n//          latitude: [null],\r\n//          longitude: [null],\r\n//          address: [null],\r\n//          owner: [null],\r\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\r\n//          booleanValue: [null]\r\n//      }),\r\n//      relations: vm.fb.array([])\r\n//    });\r\n//\r\n//    vm.cancel = function() {\r\n//        vm.dialogRef.close(null);\r\n//    };\r\n//\r\n//    vm.relations = function() {\r\n//        return vm.addEntityFormGroup.get('relations');\r\n//    };\r\n//\r\n//    vm.addRelation = function() {\r\n//        vm.relations().push(vm.fb.group({\r\n//          relatedEntity: [null, [vm.validators.required]],\r\n//          relationType: [null, [vm.validators.required]],\r\n//          direction: [null, [vm.validators.required]]\r\n//        }));\r\n//    };\r\n//\r\n//    vm.removeRelation = function(index) {\r\n//        vm.relations().removeAt(index);\r\n//        vm.relations().markAsDirty();\r\n//    };\r\n//\r\n//    vm.save = function() {\r\n//        vm.addEntityFormGroup.markAsPristine();\r\n//        saveEntityObservable().subscribe(\r\n//            function (entity) {\r\n//                widgetContext.rxjs.forkJoin([\r\n//                    saveAttributes(entity.id),\r\n//                    saveRelations(entity.id)\r\n//                ]).subscribe(\r\n//                    function () {\r\n//                        widgetContext.updateAliases();\r\n//                        vm.dialogRef.close(null);\r\n//                    }\r\n//                );\r\n//            }\r\n//        );\r\n//    };\r\n//\r\n//    function saveEntityObservable() {\r\n//        const formValues = vm.addEntityFormGroup.value;\r\n//        let entity = {\r\n//            name: formValues.entityName,\r\n//            type: formValues.type,\r\n//            label: formValues.entityLabel\r\n//        };\r\n//        if (formValues.entityType == 'ASSET') {\r\n//            return assetService.saveAsset(entity);\r\n//        } else if (formValues.entityType == 'DEVICE') {\r\n//            return deviceService.saveDevice(entity);\r\n//        }\r\n//    }\r\n//\r\n//    function saveAttributes(entityId) {\r\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\r\n//        let attributesArray = [];\r\n//        for (let key in attributes) {\r\n//            if(attributes[key] !== null) {\r\n//                attributesArray.push({key: key, value: attributes[key]});\r\n//            }\r\n//        }\r\n//        if (attributesArray.length > 0) {\r\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n//        }\r\n//        return widgetContext.rxjs.of([]);\r\n//    }\r\n//\r\n//    function saveRelations(entityId) {\r\n//        let relations = vm.addEntityFormGroup.get('relations').value;\r\n//        let tasks = [];\r\n//        for(let i=0; i < relations.length; i++) {\r\n//            let relation = {\r\n//                type: relations[i].relationType,\r\n//                typeGroup: 'COMMON'\r\n//            };\r\n//            if (relations[i].direction == 'FROM') {\r\n//                relation.to = relations[i].relatedEntity;\r\n//                relation.from = entityId;\r\n//            } else {\r\n//                relation.to = entityId;\r\n//                relation.from = relations[i].relatedEntity;\r\n//            }\r\n//            tasks.push(entityRelationService.saveRelation(relation));\r\n//        }\r\n//        if (tasks.length > 0) {\r\n//            return widgetContext.rxjs.forkJoin(tasks);\r\n//        }\r\n//        return widgetContext.rxjs.of([]);\r\n//    }\r\n//}",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "2640f906-32e1-f286-04ac-7aafdf63abed"
              }, {
                "name" : "telecomander",
                "icon" : "settings_remote",
                "useShowWidgetActionFunction" : true,
                "showWidgetActionFunction" : "// console.log(\"Tele=>\", data)\n\nreturn data.telecommand\n",
                "type" : "customPretty",
                "customHtml" : "<div class='container-detail mat-typography'>\r\n        <div class='header-detail'>\r\n            <button class=\"icon-button-small\" color=\"primary\" mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n                <mat-icon class=\"material-icons\">close</mat-icon>\r\n            </button>\r\n        </div>\r\n    \r\n    <div class=\" detail-content\">\r\n    <tb-dashboard-state fxFlex  [ctx]=\"widgetContext\" [syncParentStateParams]=\"true\" stateId=\"telecomander_view\"></tb-dashboard-state>\r\n    </div>\r\n    <mat-progress-bar color=\"accent\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\r\n    </mat-progress-bar>\r\n    <!--<mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"center center\" fxLayoutGap=\"1.5rem\">-->\r\n    <!--<button mat-button mat-dialog-close-->\r\n    <!--        type=\"button\"-->\r\n    <!--        (click)=\"cancel()\"-->\r\n    <!--        matTooltip=\"Close Dialog\"-->\r\n    <!--        matTooltipPosition=\"above\">-->\r\n    <!--    Cerrar-->\r\n    <!--</button>-->\r\n    <!--</mat-dialog-actions>-->\r\n</div>",
                "customCss" : ".cdk-overlay-pane{\r\n   max-width: 85vw !important; \r\n}\r\n\r\n.container-detail{\r\n    width:85vw; \r\n    min-width:850px;\r\n    max-width: 1250px;\r\n    height:85vh;\r\n    min-height: 600px;\r\n    max-height: 720px;\r\n    border-radius:1rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap:.5rem;\r\n    position: relative;\r\n    \r\n}\r\n\r\n.header-detail{\r\n    top: 18px;\r\n    right: 3rem;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    position:absolute;\r\n    z-index: 999;\r\n}\r\n\r\n.detail-content {\r\n    flex:1;\r\n    padding: 0;\r\n}\r\n\r\n.icon-button-small {\r\n      width: 32px !important;\r\n      height: 32px !important;\r\n      padding: 0 !important;\r\n      display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n }\r\n  \r\n .icon-button-small> .material-icons {\r\n      font-size: 20px !important;\r\n      width: 20px;\r\n      height: 20px;\r\n}\r\n\r\n.mat-mdc-dialog-surface {\r\n   border-radius: 20px !important;\r\n}",
                "customFunction" : "let $injector = widgetContext.$scope.$injector;\r\nconst customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\nlet entityGroupService = $injector.get(widgetContext.servicesMap.get('entityGroupService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n\r\nconst aliases = widgetContext.aliasController.getEntityAliases()\r\nlet params = widgetContext.stateController.getStateParams();\r\n\r\nconst dataEntity = params.data_map\r\n\r\nopenEditEntityDialog();\r\nfunction openEditEntityDialog() {\r\n    widgetContext.stateController.updateState(null, params)\r\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController,{panelClass: 'custom-container'}).subscribe();\r\n    \r\n    \r\n}\r\n\r\nfunction EditEntityDialogController(instance) {\r\n\r\n    let vm = instance;\r\n    vm.entityName = dataEntity ? dataEntity.entityName : \"\";\r\n    vm.entityType = dataEntity ? dataEntity.entityId.entityType : \"\";\r\n    vm.widgetContext = widgetContext\r\n    \r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n}\r\n",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "e13f9872-aec9-715f-6781-8b866fd91072"
              } ]
            },
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "enableDataExport" : true,
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "c4138fda-5287-fa53-8685-a2487b481653"
        },
        "92822386-9475-e891-b243-04dee6cf830d" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "entities_table",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 11.5,
          "sizeY" : 6.5,
          "config" : {
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 86400000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1687437869074,
                  "endTimeMs" : 1687524269074
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "NONE",
                "limit" : 200
              }
            },
            "showTitle" : false,
            "backgroundColor" : "rgb(255, 255, 255)",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "enableSearch" : true,
              "enableSelectColumnDisplay" : true,
              "enableStickyHeader" : true,
              "enableStickyAction" : true,
              "reserveSpaceForHiddenAction" : "true",
              "displayEntityName" : true,
              "entityNameColumnTitle" : "Dispositivo",
              "displayEntityLabel" : false,
              "displayEntityType" : false,
              "displayPagination" : true,
              "defaultPageSize" : 10,
              "defaultSortOrder" : "entityName",
              "useRowStyleFunction" : false
            },
            "title" : "Activos",
            "dropShadow" : false,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400,
              "padding" : "5px 10px 5px 10px"
            },
            "useDashboardTimewindow" : false,
            "showLegend" : false,
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "Nombre Interno",
                "color" : "#8bc34a",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.4249513019019435,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "brand",
                "type" : "attribute",
                "label" : "Marca",
                "color" : "#e91e63",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.7179575293837932,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "model",
                "type" : "attribute",
                "label" : "Modelo",
                "color" : "#03a9f4",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.9484018579178719,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "Origen de datos",
                "color" : "#673ab7",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.6176628230519621,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return typeof value === 'string' ? value.replace(\"Client\",''):value;"
              }, {
                "name" : "client",
                "type" : "attribute",
                "label" : "Alquilado a",
                "color" : "#ffeb3b",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.17423510835986544,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "buildingSite",
                "type" : "attribute",
                "label" : "Obra",
                "color" : "#3f51b5",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.6144192246540723,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "Imagen",
                "color" : "#ff9800",
                "settings" : {
                  "showAverage" : false,
                  "chartType" : "CUTOMER"
                },
                "_hash" : 0.12766194296777789,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "\nconst objectValue = isJson(value) ? JSON.parse(value) : value \n\nconst {name, src, title} = objectValue\n\nreturn objectValue ? `<img mat-raised-button src=${src} alt=${name?name:'name'} width=\"28\" title=${title?title:'Imagen'} >`:value\n\n\n\n\n\nfunction isJson(text){\n  try {\n    JSON.parse(text);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "displayTimewindow" : true,
            "actions" : {
              "rowClick" : [ {
                "name" : "select machine",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const params = widgetContext.stateController\r\n.getStateParams();\r\n// console.log(\"clicklist=>\",widgetContext.stateController.getStateId())\r\nconst actualState = widgetContext.stateController\r\n    .getStateId();\r\n\r\nconst dataInternalName = widgetContext.data.find(({\r\n        datasource,\r\n        dataKey\r\n    }) => datasource.entityId === entityId.id && dataKey\r\n    .name === 'internalName')\r\n\r\nconst internalName = dataInternalName.data[0][1] ?\r\n    dataInternalName.data[0][1] : '';\r\n\r\nconst hydrateParams = {\r\n    ...params,\r\n    viewMap: \"detail\",\r\n    only_selected: {\r\n        entityId,\r\n        entityName,\r\n        entityLabel,\r\n        internalName\r\n    },\r\n    openViewDetail: true\r\n}\r\n\r\n// widgetContext.stateController.updateState(actualState, hydrateParams)\r\n// widgetContext.updateWidgetParams(actualState, hydrateParams);\r\nwidgetContext.stateController.updateState(null,\r\n    hydrateParams, )",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "5909edb9-f872-911c-69cc-56e440876977"
              } ],
              "actionCellButton" : [ {
                "name" : "Edit machine",
                "icon" : "edit",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "customPretty",
                "customHtml" : "<!--=======================================================================-->\r\n<!--=====  There are two example templates: for edit and add entity   =====-->\r\n<!--=======================================================================-->\r\n<!--========================  Edit entity example  ========================-->\r\n<!--=======================================================================-->\r\n<!-- -->\r\n<form #editEntityForm=\"ngForm\" [formGroup]=\"editEntityFormGroup\"\r\n      (ngSubmit)=\"save()\"  class=\"edit-entity-form\">\r\n    <mat-toolbar fxLayout=\"row\" color=\"basic\">\r\n        <h2>Editar {{entityType.toLowerCase()}} {{internalName ?? entityName}}</h2>\r\n        <span fxFlex></span>\r\n        <button mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n            <mat-icon class=\"material-icons\">close</mat-icon>\r\n        </button>\r\n    </mat-toolbar>\r\n    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\r\n    </mat-progress-bar>\r\n    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>\r\n    <div mat-dialog-content class=\"dialog-content\" fxLayout=\"column\">\r\n        <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n        <!--        <mat-label>Numero interno</mat-label>-->\r\n        <!--        <input matInput formControlName=\"internal_number\"  >-->\r\n        <!--    </mat-form-field>-->\r\n        <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n        <!--        <mat-label>Obra</mat-label>-->\r\n        <!--        <input matInput formControlName=\"building_site\">-->\r\n        <!--    </mat-form-field>-->\r\n        <!--</div>-->\r\n        <div formGroupName=\"attributes\" fxLayout=\"column\">\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n            <mat-form-field fxFlex class=\"mat-block\">\r\n                <mat-label>Nombre interno</mat-label>\r\n                <input matInput formControlName=\"internalName\" >\r\n            </mat-form-field>\r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Modelo</mat-label>\r\n                    <input matInput formControlName=\"model\">\r\n                </mat-form-field>\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Marca</mat-label>\r\n                    <input matInput formControlName=\"brand\">\r\n                </mat-form-field>\r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Obra</mat-label>\r\n                    <input matInput formControlName=\"buildingSite\" >\r\n                </mat-form-field>\r\n                <mat-form-field fxFlex class=\"mat-block\">\r\n                    <mat-label>Cliente</mat-label>\r\n                    <input matInput formControlName=\"client\">\r\n                </mat-form-field>\r\n            </div>\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Status</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Selecciona un status\" name=\"status\" (selectionChange)=\"onChangeSelectStatus(status)\" [(ngModel)]=\"status\" >-->\r\n            <!--            <mat-option *ngFor=\"let status of statusOptions\" [value]=\"status\" >{{ status }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Ubicación YPF</mat-label>-->\r\n            <!--        <input matInput formControlName=\"ypf_location\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--</div>-->\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--</div>-->\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Potencia Activa (Kw)</mat-label>-->\r\n            <!--        <input matInput type=\"number\" formControlName=\"active_power\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Potencia Reactiva (Kva)</mat-label>-->\r\n            <!--        <input matInput type=\"number\" formControlName=\"reactive_power\">-->\r\n            <!--    </mat-form-field>-->\r\n            <!--</div>-->\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Rango de facturación</mat-label>-->\r\n            <!--        <mat-select placeholder=\"Rango de facturación\" name=\"billing_range\" (selectionChange)=\"onChangeSelectBillingRange(billing_range)\" [(ngModel)]=\"billing_range\" >-->\r\n            <!--            <mat-option *ngFor=\"let billing_range of billingRangeOptions\" [value]=\"billing_range.value\" >{{ billing_range.label }}</mat-option>-->\r\n            <!--         </mat-select>-->\r\n            <!--    </mat-form-field>-->\r\n            </div>\r\n            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\" fxLayoutAlign=\"start center\">\r\n                <button (click)=\"onOpenListImg()\" color=\"accent\" mat-icon-button matTooltip=\"Selecciona una imagen\" type=\"button\">\r\n                    <mat-icon class=\"material-icons-outlined\">\r\n                        {{!imgToSet ? \"add_photo_alternate\" : \"add_photo_alternate\"}}\r\n                    </mat-icon>\r\n                </button>\r\n                <h5 *ngIf=\"!(!!imgToSet || showListImg)\" >Haz click en el button \"+\" para setear una imagen al asset\r\n                </h5>\r\n                <div *ngIf=\"!!imgToSet\" class=\"img-to-set\" [matTooltip]=\"imgToSet.title\" mat-raised-button color=\"accent\" matBadge=\"✓\"  >\r\n                    <img  width=\"42\"  [src]=\"imgToSet.src\" [alt]=\"imgToSet.name\">\r\n                </div>\r\n            </div>\r\n            <div *ngIf=\"imgs.length > 0 && showListImg\" class=\"list-img\" >\r\n                <div *ngFor=\"let img of imgs\" (click)=\"onSelectImg(img)\" [matTooltip]=\"img.title\" mat-raised-button class=\"img-to-set\" color=\"accent\" matBadge=\"✓\" [matBadgeHidden]=\"!(img.name===imgToSet?.name)\" style=\"cursor:pointer;\"  >\r\n                    <img *ngIf=\"!!img.name\" width=\"42\"  [src]=\"img.src\" [alt]=\"img.name\">\r\n                </div>\r\n            </div>\r\n            <!--<div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n            <!--    <mat-form-field fxFlex class=\"mat-block\">-->\r\n            <!--        <mat-label>Integer Value</mat-label>-->\r\n            <!--        <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\r\n            <!--        <mat-error *ngIf=\"editEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\r\n            <!--            Invalid integer value.-->\r\n            <!--        </mat-error>-->\r\n            <!--    </mat-form-field>-->\r\n            <!--    <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\r\n            <!--        <label class=\"checkbox-label\">Boolean Value</label>-->\r\n            <!--        <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\r\n            <!--            {{ (editEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\r\n            <!--        </mat-checkbox>-->\r\n            <!--    </div>-->\r\n            <!--</div>-->\r\n        </div>\r\n        <!--<div class=\"relations-list old-relations\">-->\r\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\r\n        <!--    <div class=\"body\" [fxShow]=\"oldRelations().length\">-->\r\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"oldRelations\" -->\r\n        <!--             *ngFor=\"let relation of oldRelations().controls; let i = index;\">-->\r\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n        <!--                <div fxFlex fxLayout=\"column\">-->\r\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n        <!--                            <mat-label>Direction</mat-label>-->\r\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n        <!--                                </mat-option>-->\r\n        <!--                            </mat-select>-->\r\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n        <!--                                Relation direction is required.-->\r\n        <!--                            </mat-error>-->\r\n        <!--                        </mat-form-field>-->\r\n        <!--                        <tb-relation-type-autocomplete-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                formControlName=\"relationType\"-->\r\n        <!--                                required=\"true\">-->\r\n        <!--                        </tb-relation-type-autocomplete>-->\r\n        <!--                    </div>-->\r\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n        <!--                        <tb-entity-select-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                required=\"true\"-->\r\n        <!--                                formControlName=\"relatedEntity\">-->\r\n        <!--                        </tb-entity-select>-->\r\n        <!--                    </div>-->\r\n        <!--                </div>-->\r\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n        <!--                    <button mat-icon-button color=\"primary\"-->\r\n        <!--                            aria-label=\"Remove\"-->\r\n        <!--                            type=\"button\"-->\r\n        <!--                            (click)=\"removeOldRelation(i, relation.value)\"-->\r\n        <!--                            matTooltip=\"Remove relation\"-->\r\n        <!--                            matTooltipPosition=\"above\">-->\r\n        <!--                        <mat-icon>close</mat-icon>-->\r\n        <!--                    </button>-->\r\n        <!--                </div>-->\r\n        <!--            </div>-->\r\n        <!--        </div>-->\r\n        <!--    </div>-->\r\n        <!--</div>-->\r\n        <!--<div class=\"relations-list\">-->\r\n        <!--    <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">New Relations</div>-->\r\n        <!--    <div class=\"body\" [fxShow]=\"relations().length\">-->\r\n        <!--        <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\r\n        <!--            <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n        <!--                <div fxFlex fxLayout=\"column\">-->\r\n        <!--                    <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n        <!--                        <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n        <!--                            <mat-label>Direction</mat-label>-->\r\n        <!--                            <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n        <!--                                <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n        <!--                                    {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n        <!--                                </mat-option>-->\r\n        <!--                            </mat-select>-->\r\n        <!--                            <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n        <!--                                Relation direction is required.-->\r\n        <!--                            </mat-error>-->\r\n        <!--                        </mat-form-field>-->\r\n        <!--                        <tb-relation-type-autocomplete-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                formControlName=\"relationType\"-->\r\n        <!--                                [required]=\"true\">-->\r\n        <!--                        </tb-relation-type-autocomplete>-->\r\n        <!--                    </div>-->\r\n        <!--                    <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n        <!--                        <tb-entity-select-->\r\n        <!--                                fxFlex class=\"mat-block\"-->\r\n        <!--                                [required]=\"true\"-->\r\n        <!--                                formControlName=\"relatedEntity\">-->\r\n        <!--                        </tb-entity-select>-->\r\n        <!--                    </div>-->\r\n        <!--                </div>-->\r\n        <!--                <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n        <!--                    <button mat-icon-button color=\"primary\"-->\r\n        <!--                            aria-label=\"Remove\"-->\r\n        <!--                            type=\"button\"-->\r\n        <!--                            (click)=\"removeRelation(i)\"-->\r\n        <!--                            matTooltip=\"Remove relation\"-->\r\n        <!--                            matTooltipPosition=\"above\">-->\r\n        <!--                        <mat-icon>close</mat-icon>-->\r\n        <!--                    </button>-->\r\n        <!--                </div>-->\r\n        <!--            </div>-->\r\n        <!--        </div>-->\r\n        <!--    </div>-->\r\n        <!--    <div>-->\r\n        <!--        <button mat-raised-button color=\"primary\"-->\r\n        <!--                type=\"button\"-->\r\n        <!--                (click)=\"addRelation()\"-->\r\n        <!--                matTooltip=\"Add Relation\"-->\r\n        <!--                matTooltipPosition=\"above\">-->\r\n        <!--            Add-->\r\n        <!--        </button>-->\r\n        <!--    </div>-->\r\n        <!--</div>-->\r\n    </div>\r\n    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">\r\n        <button mat-button color=\"primary\"\r\n                type=\"button\"\r\n                [disabled]=\"(isLoading$ | async)\"\r\n                (click)=\"cancel()\" cdkFocusInitial>\r\n            Cancel\r\n        </button>\r\n        <button mat-button mat-raised-button color=\"primary\"\r\n                type=\"submit\"\r\n                [disabled]=\"(isLoading$ | async) || editEntityForm.invalid\">\r\n            Save\r\n        </button>\r\n    </div>\r\n</form>\r\n<!---->\r\n<!--========================================================================-->\r\n<!--=========================  Add entity example  =========================-->\r\n<!--========================================================================-->\r\n<!---->\r\n<!--<form #addEntityForm=\"ngForm\" [formGroup]=\"addEntityFormGroup\"-->\r\n<!--      (ngSubmit)=\"save()\" class=\"add-entity-form\">-->\r\n<!--    <mat-toolbar fxLayout=\"row\" color=\"primary\">-->\r\n<!--        <h2>Add entity</h2>-->\r\n<!--        <span fxFlex></span>-->\r\n<!--        <button mat-icon-button (click)=\"cancel()\" type=\"button\">-->\r\n<!--            <mat-icon class=\"material-icons\">close</mat-icon>-->\r\n<!--        </button>-->\r\n<!--    </mat-toolbar>-->\r\n<!--    <mat-progress-bar color=\"warn\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">-->\r\n<!--    </mat-progress-bar>-->\r\n<!--    <div style=\"height: 4px;\" *ngIf=\"!(isLoading$ | async)\"></div>-->\r\n<!--    <div mat-dialog-content fxLayout=\"column\">-->\r\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                <mat-label>Entity Name</mat-label>-->\r\n<!--                <input matInput formControlName=\"entityName\" required>-->\r\n<!--                <mat-error *ngIf=\"addEntityFormGroup.get('entityName').hasError('required')\">-->\r\n<!--                    Entity name is required.-->\r\n<!--                </mat-error>-->\r\n<!--            </mat-form-field>-->\r\n<!--            <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                <mat-label>Entity Label</mat-label>-->\r\n<!--                <input matInput formControlName=\"entityLabel\" >-->\r\n<!--            </mat-form-field>-->\r\n<!--        </div>-->\r\n<!--        <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--            <tb-entity-type-select-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"entityType\"-->\r\n<!--                    [showLabel]=\"true\"-->\r\n<!--                    [allowedEntityTypes]=\"allowedEntityTypes\"-->\r\n<!--            ></tb-entity-type-select>-->\r\n<!--            <tb-entity-subtype-autocomplete-->\r\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value == 'ASSET'\"-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"type\"-->\r\n<!--                    [required]=\"true\"-->\r\n<!--                    [entityType]=\"'ASSET'\"-->\r\n<!--            ></tb-entity-subtype-autocomplete>-->\r\n<!--            <tb-entity-subtype-autocomplete-->\r\n<!--                    fxFlex *ngIf=\"addEntityFormGroup.get('entityType').value != 'ASSET'\"-->\r\n<!--                    class=\"mat-block\"-->\r\n<!--                    formControlName=\"type\"-->\r\n<!--                    [required]=\"true\"-->\r\n<!--                    [entityType]=\"'DEVICE'\"-->\r\n<!--            ></tb-entity-subtype-autocomplete>-->\r\n<!--        </div>-->\r\n<!--        <div formGroupName=\"attributes\" fxLayout=\"column\">-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Latitude</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"latitude\">-->\r\n<!--                </mat-form-field>-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Longitude</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"any\" matInput formControlName=\"longitude\">-->\r\n<!--                </mat-form-field>-->\r\n<!--            </div>-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Address</mat-label>-->\r\n<!--                    <input matInput formControlName=\"address\">-->\r\n<!--                </mat-form-field>-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Owner</mat-label>-->\r\n<!--                    <input matInput formControlName=\"owner\">-->\r\n<!--                </mat-form-field>-->\r\n<!--            </div>-->\r\n<!--            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                <mat-form-field fxFlex class=\"mat-block\">-->\r\n<!--                    <mat-label>Integer Value</mat-label>-->\r\n<!--                    <input type=\"number\" step=\"1\" matInput formControlName=\"number\">-->\r\n<!--                    <mat-error *ngIf=\"addEntityFormGroup.get('attributes.number').hasError('pattern')\">-->\r\n<!--                        Invalid integer value.-->\r\n<!--                    </mat-error>-->\r\n<!--                </mat-form-field>-->\r\n<!--                <div class=\"boolean-value-input\" fxLayout=\"column\" fxLayoutAlign=\"center start\" fxFlex>-->\r\n<!--                    <label class=\"checkbox-label\">Boolean Value</label>-->\r\n<!--                    <mat-checkbox formControlName=\"booleanValue\" style=\"margin-bottom: 40px;\">-->\r\n<!--                        {{ (addEntityFormGroup.get('attributes.booleanValue').value ? \"value.true\" : \"value.false\") | translate }}-->\r\n<!--                    </mat-checkbox>-->\r\n<!--                </div>-->\r\n<!--            </div>-->\r\n<!--        </div>-->\r\n<!--        <div class=\"relations-list\">-->\r\n<!--            <div class=\"mat-body-1\" style=\"padding-bottom: 10px; color: rgba(0,0,0,0.57);\">Relations</div>-->\r\n<!--            <div class=\"body\" [fxShow]=\"relations().length\">-->\r\n<!--                <div class=\"row\" fxLayout=\"row\" fxLayoutAlign=\"start center\" formArrayName=\"relations\" *ngFor=\"let relation of relations().controls; let i = index;\">-->\r\n<!--                    <div [formGroupName]=\"i\" class=\"mat-elevation-z2\" fxFlex fxLayout=\"row\" style=\"padding: 5px 0 5px 5px;\">-->\r\n<!--                        <div fxFlex fxLayout=\"column\">-->\r\n<!--                            <div fxLayout=\"row\" fxLayoutGap=\"8px\" fxLayout.xs=\"column\"  fxLayoutGap.xs=\"0\">-->\r\n<!--                                <mat-form-field class=\"mat-block\" style=\"min-width: 100px;\">-->\r\n<!--                                    <mat-label>Direction</mat-label>-->\r\n<!--                                    <mat-select formControlName=\"direction\" name=\"direction\">-->\r\n<!--                                        <mat-option *ngFor=\"let direction of entitySearchDirection | keyvalue\" [value]=\"direction.value\">-->\r\n<!--                                            {{ (\"relation.search-direction.\" + direction.value) | translate}}-->\r\n<!--                                        </mat-option>-->\r\n<!--                                    </mat-select>-->\r\n<!--                                    <mat-error *ngIf=\"relation.get('direction').hasError('required')\">-->\r\n<!--                                        Relation direction is required.-->\r\n<!--                                    </mat-error>-->\r\n<!--                                </mat-form-field>-->\r\n<!--                                <tb-relation-type-autocomplete-->\r\n<!--                                        fxFlex class=\"mat-block\"-->\r\n<!--                                        formControlName=\"relationType\"-->\r\n<!--                                        [required]=\"true\">-->\r\n<!--                                </tb-relation-type-autocomplete>-->\r\n<!--                            </div>-->\r\n<!--                            <div fxLayout=\"row\" fxLayout.xs=\"column\">-->\r\n<!--                                <tb-entity-select-->\r\n<!--                                        fxFlex class=\"mat-block\"-->\r\n<!--                                        [required]=\"true\"-->\r\n<!--                                        formControlName=\"relatedEntity\">-->\r\n<!--                                </tb-entity-select>-->\r\n<!--                            </div>-->\r\n<!--                        </div>-->\r\n<!--                        <div fxLayout=\"column\" fxLayoutAlign=\"center center\">-->\r\n<!--                            <button mat-icon-button color=\"primary\"-->\r\n<!--                                    aria-label=\"Remove\"-->\r\n<!--                                    type=\"button\"-->\r\n<!--                                    (click)=\"removeRelation(i)\"-->\r\n<!--                                    matTooltip=\"Remove relation\"-->\r\n<!--                                    matTooltipPosition=\"above\">-->\r\n<!--                                <mat-icon>close</mat-icon>-->\r\n<!--                            </button>-->\r\n<!--                        </div>-->\r\n<!--                    </div>-->\r\n<!--                </div>-->\r\n<!--            </div>-->\r\n<!--            <div>-->\r\n<!--                <button mat-raised-button color=\"primary\"-->\r\n<!--                        type=\"button\"-->\r\n<!--                        (click)=\"addRelation()\"-->\r\n<!--                        matTooltip=\"Add Relation\"-->\r\n<!--                        matTooltipPosition=\"above\">-->\r\n<!--                    Add-->\r\n<!--                </button>-->\r\n<!--            </div>-->\r\n<!--        </div>-->\r\n<!--    </div>-->\r\n<!--    <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"end center\">-->\r\n<!--        <button mat-button color=\"primary\"-->\r\n<!--                type=\"button\"-->\r\n<!--                [disabled]=\"(isLoading$ | async)\"-->\r\n<!--                (click)=\"cancel()\" cdkFocusInitial>-->\r\n<!--            Cancel-->\r\n<!--        </button>-->\r\n<!--        <button mat-button mat-raised-button color=\"primary\"-->\r\n<!--                type=\"submit\"-->\r\n<!--                [disabled]=\"(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty\">-->\r\n<!--            Create-->\r\n<!--        </button>-->\r\n<!--    </div>-->\r\n<!--</form>-->",
                "customCss" : ".dialog-content{\r\n   min-width: 45rem; \r\n}\r\n\r\n.list-img{\r\n    display:grid; \r\n    grid-template-columns:repeat(auto-fit, minmax(60px, 1fr)); \r\n    justify-items:center; \r\n    align-items: flex-start; \r\n    grid-auto-rows:1fr; \r\n    gap:1rem;\r\n}\r\n\r\n.img-to-set{\r\n    background:#eee; \r\n    border-radius:3px; \r\n    width:60px; \r\n    height:60px; \r\n    margin:2px;    \r\n    display:flex; \r\n    align-items:center; \r\n    justify-content:center;\r\n}\r\n\r\n\r\n/*=======================================================================*/\r\n/*==========  There are two examples: for edit and add entity  ==========*/\r\n/*=======================================================================*/\r\n/*========================  Edit entity example  ========================*/\r\n/*=======================================================================*/\r\n/*\r\n.edit-entity-form .boolean-value-input {\r\n    padding-left: 5px;\r\n}\r\n\r\n.edit-entity-form .boolean-value-input .checkbox-label {\r\n    color: rgba(0,0,0,0.54);\r\n    font-size: 12px;\r\n}\r\n\r\n.relations-list .header {\r\n    padding-right: 5px;\r\n    padding-bottom: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .header .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n    font-size: 12px;\r\n    font-weight: 700;\r\n    color: rgba(0, 0, 0, .54);\r\n    white-space: nowrap;\r\n}\r\n\r\n.relations-list .mat-form-field-infix {\r\n    width: auto !important;\r\n}\r\n\r\n.relations-list .body {\r\n    padding-right: 5px;\r\n    padding-bottom: 15px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .row {\r\n    padding-top: 5px;\r\n}\r\n\r\n.relations-list .body .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .md-button {\r\n    margin: 0;\r\n}\r\n*/\r\n/*========================================================================*/\r\n/*=========================  Add entity example  =========================*/\r\n/*========================================================================*/\r\n/*\r\n.add-entity-form .boolean-value-input {\r\n    padding-left: 5px;\r\n}\r\n\r\n.add-entity-form .boolean-value-input .checkbox-label {\r\n    color: rgba(0,0,0,0.54);\r\n    font-size: 12px;\r\n}\r\n\r\n.relations-list .header {\r\n    padding-right: 5px;\r\n    padding-bottom: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .header .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n    font-size: 12px;\r\n    font-weight: 700;\r\n    color: rgba(0, 0, 0, .54);\r\n    white-space: nowrap;\r\n}\r\n\r\n.relations-list .mat-form-field-infix {\r\n    width: auto !important;\r\n}\r\n\r\n.relations-list .body {\r\n    padding-right: 5px;\r\n    padding-bottom: 15px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .row {\r\n    padding-top: 5px;\r\n}\r\n\r\n.relations-list .body .cell {\r\n    padding-right: 5px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.relations-list .body .md-button {\r\n    margin: 0;\r\n}\r\n*/",
                "customFunction" : "/*=======================================================================*/\r\n/*=====  There are three examples: for delete, edit and add entity  =====*/\r\n/*=======================================================================*/\r\n/*=======================  Delete entity example  =======================*/\r\n/*=======================================================================*/\r\n//\r\n//let $injector = widgetContext.$scope.$injector;\r\n//let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\r\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n//\r\n//openDeleteEntityDialog();\r\n//\r\n//function openDeleteEntityDialog() {\r\n//    let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\r\n//                 entityName;\r\n//    let content = 'Are you sure you want to delete the ' +\r\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\r\n//    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\r\n//        function(result) {\r\n//            if (result) {\r\n//                deleteEntity();\r\n//            }\r\n//        }\r\n//    );\r\n//}\r\n//\r\n//function deleteEntity() {\r\n//    deleteEntityObservable(entityId).subscribe(\r\n//        function success() {\r\n//            widgetContext.updateAliases();\r\n//        },\r\n//        function fail() {\r\n//            showErrorDialog();\r\n//        }\r\n//    );\r\n//}\r\n//\r\n//function deleteEntityObservable(entityId) {\r\n//    if (entityId.entityType == \"ASSET\") {\r\n//        return assetService.deleteAsset(entityId.id);\r\n//    } else if (entityId.entityType == \"DEVICE\") {\r\n//        return deviceService.deleteDevice(entityId.id);\r\n//    }\r\n//}\r\n//\r\n//function showErrorDialog() {\r\n//    let title = 'Error';\r\n//    let content = 'An error occurred while deleting the entity. Please try again.';\r\n//    dialogs.alert(title, content, 'CLOSE').subscribe(\r\n//        function(result) {}\r\n//    );\r\n//}\r\n//\r\n/*=======================================================================*/\r\n/*========================  Edit entity example  ========================*/\r\n/*=======================================================================*/\r\n//\r\nlet $injector = widgetContext.$scope.$injector;\r\nlet customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\r\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\nlet deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\nlet entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\r\n\r\nconst aliases = widgetContext.aliasController.getEntityAliases()\r\nconst params = widgetContext.stateController.getStateParams()\r\nconst dataEntity = params.only_selected\r\nconsole.log(\"Aliases=>\",entityId)\r\n\r\nopenEditEntityDialog();\r\n\r\nfunction openEditEntityDialog() {\r\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\r\n}\r\n\r\nfunction EditEntityDialogController(instance) {\r\n    let vm = instance;\r\n\r\n    vm.entityName = entityName ? entityName.entityName : \"\";\r\n    vm.entityType = entityId ? entityId.entityType : \"\";\r\n    vm.entitySearchDirection = {\r\n        from: \"FROM\",\r\n        to: \"TO\"\r\n    };\r\n    vm.attributes = {};\r\n    vm.oldRelationsData = [];\r\n    vm.relationsToDelete = [];\r\n    vm.entity = {};\r\n    \r\n    vm.showListImg = false;\r\n    vm.imgToSet = null;\r\n    \r\n    //--get info from repositories --//\r\n    vm.imgs = imgRepository();\r\n    // vm.statusOptions = statusRepository();\r\n    // vm.modelOptions = modelRepository();\r\n    // vm.telecommandOptions = telecommandRepository()\r\n    // vm.typeFuelOptions = typeFuelRepository()\r\n    // vm.billingRangeOptions = billingRangeRepository()\r\n    //--------//\r\n\r\n    vm.editEntityFormGroup = vm.fb.group({\r\n        entityName: ['', [vm.validators.required]],\r\n        entityType: [null],\r\n        entityLabel: [null],\r\n        type: ['', [vm.validators.required]],\r\n        attributes: vm.fb.group({\r\n            model: [null],\r\n            img : [null],\r\n            internalName: [null],\r\n            buildingSite: [null],\r\n            client: [null],\r\n            brand: [null]\r\n        }),\r\n    });\r\n\r\n    getEntityInfo();\r\n    \r\n    vm.onOpenListImg = ()=>{\r\n        vm.showListImg = true\r\n    }\r\n    \r\n    vm.onSelectImg = (image)=>{\r\n        // console.log(\"onSelect=>\",e)\r\n        vm.imgToSet = image\r\n        vm.showListImg = false\r\n    } \r\n    \r\n    //-- handlers selects --//\r\n    vm.onChangeSelectStatus = (status)=>{\r\n        vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: {...vm.attributes,status },\r\n                }, {emitEvent: false});\r\n    }\r\n    \r\n    vm.onChangeSelectModel = (model)=>{\r\n        vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: {...vm.attributes,model },\r\n                }, {emitEvent: false});\r\n    }\r\n    \r\n   \r\n    \r\n    \r\n    \r\n    \r\n\r\n//-----------------------------------------------------------------------//\r\n\r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n\r\n    vm.relations = function() {\r\n        return vm.editEntityFormGroup.get('relations');\r\n    };\r\n\r\n    vm.oldRelations = function() {\r\n        return vm.editEntityFormGroup.get('oldRelations');\r\n    };\r\n\r\n    vm.addRelation = function() {\r\n        vm.relations().push(vm.fb.group({\r\n            relatedEntity: [null, [vm.validators.required]],\r\n            relationType: [null, [vm.validators.required]],\r\n            direction: [null, [vm.validators.required]]\r\n        }));\r\n    };\r\n\r\n    function addOldRelation() {\r\n        vm.oldRelations().push(vm.fb.group({\r\n            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\r\n            relationType: [{value: null, disabled: true}, [vm.validators.required]],\r\n            direction: [{value: null, disabled: true}, [vm.validators.required]]\r\n        }));\r\n    }\r\n\r\n    vm.removeRelation = function(index) {\r\n        vm.relations().removeAt(index);\r\n        vm.relations().markAsDirty();\r\n    };\r\n\r\n    vm.removeOldRelation = function(index, relation) {\r\n        vm.oldRelations().removeAt(index);\r\n        vm.relationsToDelete.push(relation);\r\n        vm.oldRelations().markAsDirty();\r\n    };\r\n\r\n    vm.save = function() {\r\n        vm.editEntityFormGroup.markAsPristine();\r\n        widgetContext.rxjs.forkJoin([\r\n            saveAttributes(entityId),\r\n            saveEntity()\r\n        ]).subscribe(\r\n            function () {\r\n                widgetContext.updateAliases();\r\n                vm.dialogRef.close(null);\r\n            }\r\n        );\r\n    };\r\n\r\n    function getEntityAttributes(attributes) {\r\n        for (var i = 0; i < attributes.length; i++) {\r\n            vm.attributes[attributes[i].key] = attributes[i].value;\r\n        }\r\n    }\r\n\r\n    function getEntityRelations(relations) {\r\n        let relationsFrom = relations[0];\r\n        let relationsTo = relations[1];\r\n        for (let i=0; i < relationsFrom.length; i++) {\r\n            let relation = {\r\n                direction: 'FROM',\r\n                relationType: relationsFrom[i].type,\r\n                relatedEntity: relationsFrom[i].to\r\n            };\r\n            vm.oldRelationsData.push(relation);\r\n            addOldRelation();\r\n        }\r\n        for (let i=0; i < relationsTo.length; i++) {\r\n            let relation = {\r\n                direction: 'TO',\r\n                relationType: relationsTo[i].type,\r\n                relatedEntity: relationsTo[i].from\r\n            };\r\n            vm.oldRelationsData.push(relation);\r\n            addOldRelation();\r\n        }\r\n    }\r\n\r\n    function getEntityInfo() {\r\n        widgetContext.rxjs.forkJoin([\r\n            entityRelationService.findInfoByFrom(entityId),\r\n            entityRelationService.findInfoByTo(entityId),\r\n            attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE'),\r\n            entityService.getEntity(entityId.entityType, entityId.id)\r\n        ]).subscribe(\r\n            function (data) {\r\n                // getEntityRelations(data.slice(0,2));\r\n                getEntityAttributes(data[2]);\r\n                vm.internalName = vm.attributes.internalName\r\n                vm.entity = data[3];\r\n                vm.editEntityFormGroup.patchValue({\r\n                    entityName: vm.entity.name,\r\n                    entityType: vm.entityType,\r\n                    entityLabel: vm.entity.label,\r\n                    type: vm.entity.type,\r\n                    attributes: vm.attributes,\r\n                }, {emitEvent: false});\r\n                // console.log(\"GetEntityIfo=>\",vm.attributes)\r\n                if(isJson(vm.attributes.img)){\r\n                    vm.imgToSet = JSON.parse(vm.attributes.img)\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    function saveEntity() {\r\n        const formValues = vm.editEntityFormGroup.value;\r\n        if (vm.entity.name !== formValues.entityName){\r\n            vm.entity.name = formValues.entityName;\r\n            if (formValues.entityType == 'ASSET') {\r\n                return assetService.saveAsset(vm.entity);\r\n            } else if (formValues.entityType == 'DEVICE') {\r\n                return deviceService.saveDevice(vm.entity);\r\n            }\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n\r\n    function saveAttributes(entityId) {\r\n        let attributes = vm.editEntityFormGroup.get('attributes').value;\r\n        \r\n        if(vm.imgToSet!= vm.attributes.img){\r\n            attributes = {...attributes, img:JSON.stringify(vm.imgToSet)}\r\n        }\r\n        \r\n        let attributesArray = [];\r\n        for (let key in attributes) {\r\n            if (attributes[key] !== vm.attributes[key]) {\r\n                attributesArray.push({key: key, value: attributes[key]});\r\n            }\r\n        }\r\n        if (attributesArray.length > 0) {\r\n            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n\r\n    function saveRelations(entityId) {\r\n        let relations = vm.editEntityFormGroup.get('relations').value;\r\n        let tasks = [];\r\n        for(let i=0; i < relations.length; i++) {\r\n            let relation = {\r\n                type: relations[i].relationType,\r\n                typeGroup: 'COMMON'\r\n            };\r\n            if (relations[i].direction == 'FROM') {\r\n                relation.to = relations[i].relatedEntity;\r\n                relation.from = entityId;\r\n            } else {\r\n                relation.to = entityId;\r\n                relation.from = relations[i].relatedEntity;\r\n            }\r\n            tasks.push(entityRelationService.saveRelation(relation));\r\n        }\r\n        for (let i=0; i < vm.relationsToDelete.length; i++) {\r\n            let relation = {\r\n                type: vm.relationsToDelete[i].relationType\r\n            };\r\n            if (vm.relationsToDelete[i].direction == 'FROM') {\r\n                relation.to = vm.relationsToDelete[i].relatedEntity;\r\n                relation.from = entityId;\r\n            } else {\r\n                relation.to = entityId;\r\n                relation.from = vm.relationsToDelete[i].relatedEntity;\r\n            }\r\n            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\r\n        }\r\n        if (tasks.length > 0) {\r\n            return widgetContext.rxjs.forkJoin(tasks);\r\n        }\r\n        return widgetContext.rxjs.of([]);\r\n    }\r\n    \r\n    function isJson(text){\r\n      try {\r\n        JSON.parse(text);\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction imgRepository(){\r\n    const externalUrl = 'https://vdms.tesacom.net'\r\n    return [\r\n        {\r\n        name: false,\r\n        title: 'Default',\r\n        src: ``,\r\n        },\r\n          {\r\n            name: 'AIRE-small-air.png',\r\n            title: 'Aire chico',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AIRE-small-air.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-big-air.png',\r\n            title: 'Aire grande',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AIRE-big-air.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-electrico-M75.png',\r\n            title: 'Aire Hasta 75kw',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AIRE-electrico-H75.png`,\r\n          },\r\n          {\r\n            name: 'AIRE-electrico-M75.png',\r\n            title: 'Aire más de 75kw',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AIRE-electrico-M75.png`,\r\n          },\r\n          {\r\n            name: 'AWP-elevador-pers.png',\r\n            title: 'Elevador personal',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AWP-elevador-pers.png`,\r\n          },\r\n          {\r\n            name: 'AWP-pluma-artic.png',\r\n            title: 'Pluma articulada',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AWP-pluma-artic.png`,\r\n          },\r\n          {\r\n            name: 'AWP-pluma-telesc.png',\r\n            title: 'Pluma telescópica',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AWP-pluma-telesc.png`,\r\n          },\r\n          {\r\n            name: 'AWP-tijeras.png',\r\n            title: 'Tijeras',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/AWP-tijeras.png`,\r\n          },\r\n          {\r\n            name: 'ERADC-container.png',\r\n            title: 'Generador Container',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/ERADC-container.png`,\r\n          },{\r\n            name: 'ERADC-diesel.png',\r\n            title: 'Generador diesel',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/ERADC-diesel.png`,\r\n          },\r\n          {\r\n            name: 'ERADC-trailer.png',\r\n            title: 'Generador trailer',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/ERADC-trailer.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camion-artic.png',\r\n            title: 'Camión articulado',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-camion-artic.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camioneta.png',\r\n            title: 'Camión rígido',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-camion-rigido.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-camion-rigido.png',\r\n            title: 'Camioneta',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-camioneta.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-cargador-frontal.png',\r\n            title: 'Cargador frontal',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-cargador-frontal.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-carg-frt-retroex.png',\r\n            title: 'Cargador retroexcavadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-carg-frt-retroex.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-compactadora.png',\r\n            title: 'Compactadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-compactadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-excavadora.pn',\r\n            title: 'Excavadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-excavadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-minicargadora.png',\r\n            title: 'Minicargadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-minicargadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-miniexcavadora.png',\r\n            title: 'Miniexcavadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-miniexcavadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-motoniveladora.png',\r\n            title: 'Motoniveladora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-motoniveladora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-topadora.png',\r\n            title: 'Topadora',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-topadora.png`,\r\n          },\r\n          {\r\n            name: 'TIERRA-tractor.png',\r\n            title: 'Tractor',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TIERRA-tractor.png`,\r\n          },\r\n          {\r\n            name: 'TLH-autoelevadora-D.png',\r\n            title: 'Autoelevador diesel',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TLH-autoelevadora-D.png`,\r\n          },\r\n          {\r\n            name: 'TLH-autoelevadora-E.png',\r\n            title: 'Autoelevador eléctrico',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TLH-autoelevadora-E.png`,\r\n          },\r\n          {\r\n            name: 'TLH-compacto-oruga.png',\r\n            title: 'Compacto con oruga',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TLH-compacto-oruga.png`,\r\n          },\r\n          {\r\n            name: 'TLH-manipuladora-H6.png',\r\n            title: 'Manipuladora hasta 6tn',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TLH-manipuladora-H6.png`,\r\n          },\r\n          {\r\n            name: 'TLH-manipuladora-M6.png',\r\n            title: 'Manipuladora más de 6tn',\r\n            src: `${externalUrl}/images/markers/pixi/proto/profiles/TLH-manipuladora-M6.png`,\r\n          },\r\n      {\r\n        name: 'TORRE-torre.png',\r\n        title: 'Torre',\r\n        src: `${externalUrl}/images/markers/pixi/proto/profiles/TORRE-torre.png`,\r\n      },\r\n];\r\n}\r\n\r\n\r\n\r\n\r\n/*========================================================================*/\r\n/*=========================  Add entity example  =========================*/\r\n/*========================================================================*/\r\n//\r\n//let $injector = widgetContext.$scope.$injector;\r\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\r\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\r\n//\r\n//openAddEntityDialog();\r\n//\r\n//function openAddEntityDialog() {\r\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\r\n//}\r\n//\r\n//function AddEntityDialogController(instance) {\r\n//    let vm = instance;\r\n//\r\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\r\n//    vm.entitySearchDirection = {\r\n//        from: \"FROM\",\r\n//        to: \"TO\"\r\n//    }\r\n//\r\n//    vm.addEntityFormGroup = vm.fb.group({\r\n//      entityName: ['', [vm.validators.required]],\r\n//      entityType: ['DEVICE'],\r\n//      entityLabel: [null],\r\n//      type: ['', [vm.validators.required]],\r\n//      attributes: vm.fb.group({\r\n//          latitude: [null],\r\n//          longitude: [null],\r\n//          address: [null],\r\n//          owner: [null],\r\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\r\n//          booleanValue: [null]\r\n//      }),\r\n//      relations: vm.fb.array([])\r\n//    });\r\n//\r\n//    vm.cancel = function() {\r\n//        vm.dialogRef.close(null);\r\n//    };\r\n//\r\n//    vm.relations = function() {\r\n//        return vm.addEntityFormGroup.get('relations');\r\n//    };\r\n//\r\n//    vm.addRelation = function() {\r\n//        vm.relations().push(vm.fb.group({\r\n//          relatedEntity: [null, [vm.validators.required]],\r\n//          relationType: [null, [vm.validators.required]],\r\n//          direction: [null, [vm.validators.required]]\r\n//        }));\r\n//    };\r\n//\r\n//    vm.removeRelation = function(index) {\r\n//        vm.relations().removeAt(index);\r\n//        vm.relations().markAsDirty();\r\n//    };\r\n//\r\n//    vm.save = function() {\r\n//        vm.addEntityFormGroup.markAsPristine();\r\n//        saveEntityObservable().subscribe(\r\n//            function (entity) {\r\n//                widgetContext.rxjs.forkJoin([\r\n//                    saveAttributes(entity.id),\r\n//                    saveRelations(entity.id)\r\n//                ]).subscribe(\r\n//                    function () {\r\n//                        widgetContext.updateAliases();\r\n//                        vm.dialogRef.close(null);\r\n//                    }\r\n//                );\r\n//            }\r\n//        );\r\n//    };\r\n//\r\n//    function saveEntityObservable() {\r\n//        const formValues = vm.addEntityFormGroup.value;\r\n//        let entity = {\r\n//            name: formValues.entityName,\r\n//            type: formValues.type,\r\n//            label: formValues.entityLabel\r\n//        };\r\n//        if (formValues.entityType == 'ASSET') {\r\n//            return assetService.saveAsset(entity);\r\n//        } else if (formValues.entityType == 'DEVICE') {\r\n//            return deviceService.saveDevice(entity);\r\n//        }\r\n//    }\r\n//\r\n//    function saveAttributes(entityId) {\r\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\r\n//        let attributesArray = [];\r\n//        for (let key in attributes) {\r\n//            if(attributes[key] !== null) {\r\n//                attributesArray.push({key: key, value: attributes[key]});\r\n//            }\r\n//        }\r\n//        if (attributesArray.length > 0) {\r\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\r\n//        }\r\n//        return widgetContext.rxjs.of([]);\r\n//    }\r\n//\r\n//    function saveRelations(entityId) {\r\n//        let relations = vm.addEntityFormGroup.get('relations').value;\r\n//        let tasks = [];\r\n//        for(let i=0; i < relations.length; i++) {\r\n//            let relation = {\r\n//                type: relations[i].relationType,\r\n//                typeGroup: 'COMMON'\r\n//            };\r\n//            if (relations[i].direction == 'FROM') {\r\n//                relation.to = relations[i].relatedEntity;\r\n//                relation.from = entityId;\r\n//            } else {\r\n//                relation.to = entityId;\r\n//                relation.from = relations[i].relatedEntity;\r\n//            }\r\n//            tasks.push(entityRelationService.saveRelation(relation));\r\n//        }\r\n//        if (tasks.length > 0) {\r\n//            return widgetContext.rxjs.forkJoin(tasks);\r\n//        }\r\n//        return widgetContext.rxjs.of([]);\r\n//    }\r\n//}",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "2640f906-32e1-f286-04ac-7aafdf63abed"
              }, {
                "name" : "telecomander",
                "icon" : "settings_remote",
                "useShowWidgetActionFunction" : true,
                "showWidgetActionFunction" : "// console.log(\"Tele=>\", data)\n\nreturn data.telecommand\n",
                "type" : "customPretty",
                "customHtml" : "<div class='container-detail mat-typography'>\r\n        <div class='header-detail'>\r\n            <button class=\"icon-button-small\" color=\"primary\" mat-icon-button (click)=\"cancel()\" type=\"button\">\r\n                <mat-icon class=\"material-icons\">close</mat-icon>\r\n            </button>\r\n        </div>\r\n    \r\n    <div class=\" detail-content\">\r\n    <tb-dashboard-state fxFlex  [ctx]=\"widgetContext\" [syncParentStateParams]=\"true\" stateId=\"telecomander_view\"></tb-dashboard-state>\r\n    </div>\r\n    <mat-progress-bar color=\"accent\" mode=\"indeterminate\" *ngIf=\"isLoading$ | async\">\r\n    </mat-progress-bar>\r\n    <!--<mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"center center\" fxLayoutGap=\"1.5rem\">-->\r\n    <!--<button mat-button mat-dialog-close-->\r\n    <!--        type=\"button\"-->\r\n    <!--        (click)=\"cancel()\"-->\r\n    <!--        matTooltip=\"Close Dialog\"-->\r\n    <!--        matTooltipPosition=\"above\">-->\r\n    <!--    Cerrar-->\r\n    <!--</button>-->\r\n    <!--</mat-dialog-actions>-->\r\n</div>",
                "customCss" : ".cdk-overlay-pane{\r\n   max-width: 85vw !important; \r\n}\r\n\r\n.container-detail{\r\n    width:85vw; \r\n    min-width:850px;\r\n    max-width: 1250px;\r\n    height:85vh;\r\n    min-height: 600px;\r\n    max-height: 720px;\r\n    border-radius:1rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap:.5rem;\r\n    position: relative;\r\n    \r\n}\r\n\r\n.header-detail{\r\n    top: 18px;\r\n    right: 3rem;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    position:absolute;\r\n    z-index: 999;\r\n}\r\n\r\n.detail-content {\r\n    flex:1;\r\n    padding: 0;\r\n}\r\n\r\n.icon-button-small {\r\n      width: 32px !important;\r\n      height: 32px !important;\r\n      padding: 0 !important;\r\n      display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n }\r\n  \r\n .icon-button-small> .material-icons {\r\n      font-size: 20px !important;\r\n      width: 20px;\r\n      height: 20px;\r\n}\r\n\r\n.mat-mdc-dialog-surface {\r\n   border-radius: 20px !important;\r\n}",
                "customFunction" : "let $injector = widgetContext.$scope.$injector;\r\nconst customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\r\nlet assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\r\nlet entityGroupService = $injector.get(widgetContext.servicesMap.get('entityGroupService'));\r\nlet attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\r\n\r\nconst aliases = widgetContext.aliasController.getEntityAliases()\r\nlet params = widgetContext.stateController.getStateParams();\r\n\r\nconst dataEntity = params.data_map\r\n\r\nopenEditEntityDialog();\r\nfunction openEditEntityDialog() {\r\n    widgetContext.stateController.updateState(null, params)\r\n    customDialog.customDialog(htmlTemplate, EditEntityDialogController,{panelClass: 'custom-container'}).subscribe();\r\n    \r\n    \r\n}\r\n\r\nfunction EditEntityDialogController(instance) {\r\n\r\n    let vm = instance;\r\n    vm.entityName = dataEntity ? dataEntity.entityName : \"\";\r\n    vm.entityType = dataEntity ? dataEntity.entityId.entityType : \"\";\r\n    vm.widgetContext = widgetContext\r\n    \r\n    vm.cancel = function() {\r\n        vm.dialogRef.close(null);\r\n    };\r\n}\r\n",
                "customResources" : [ ],
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "e13f9872-aec9-715f-6781-8b866fd91072"
              } ]
            },
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "enableDataExport" : true,
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "92822386-9475-e891-b243-04dee6cf830d"
        },
        "e2925909-9ebe-a8cf-5fda-6901c4f33950" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "weekly_heatmap22",
          "type" : "timeseries",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 11.5,
          "sizeY" : 7.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "horometer",
                "type" : "timeseries",
                "label" : "Horometer",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.6371012922324277,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "oilPresure",
                "type" : "timeseries",
                "label" : "OilPresure",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.23396935080839576,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "cumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "Horometro",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.9558815081457177,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "Binary1QualifiedInput",
                "type" : "timeseries",
                "label" : "Encendido",
                "color" : "#3f51b5",
                "settings" : { },
                "_hash" : 0.8455006806933245,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              },
              "latestDataKeys" : [ ]
            } ],
            "timewindow" : {
              "hideInterval" : false,
              "hideLastInterval" : false,
              "hideQuickInterval" : false,
              "hideAggregation" : false,
              "hideAggInterval" : false,
              "hideTimezone" : false,
              "selectedTab" : 1,
              "history" : {
                "historyType" : 0,
                "timewindowMs" : 2592000000,
                "interval" : 3600000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1652037003619,
                  "endTimeMs" : 1652123403619
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "NONE",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "8px",
            "settings" : {
              "showDataInStackedLine" : true,
              "positionTitle" : "left",
              "title" : "Monitoreo"
            },
            "title" : "New Stacked Line",
            "dropShadow" : true,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : false,
            "displayTimewindow" : false,
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "widgetStyle" : {
              "borderRadius" : "1.25rem"
            },
            "widgetCss" : "",
            "noDataDisplayMessage" : "",
            "showLegend" : false,
            "enableDataExport" : true,
            "pageSize" : 1024
          },
          "row" : 0,
          "col" : 0,
          "id" : "e2925909-9ebe-a8cf-5fda-6901c4f33950"
        },
        "64a168b2-a25e-2f36-2752-c3fdc063af62" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "report_stepper",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 13,
          "sizeY" : 8.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "7401cabf-4c5b-209f-2005-c1c486e3861a",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "Binary1QualifiedInput",
                "type" : "timeseries",
                "label" : "Utilización",
                "color" : "#e91e63",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx,)\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({datasource,dataKey})=>dataKey.label == 'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return value;\r\n    \r\n    const dataValue = dataUtilization.find(({datasource,dataKey})=>dataKey.label == 'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n\r\n    const lengtData = dataValue.data.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.data.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState ==='ON' ? curr[0] - acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1]==='ON') {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                .prevState ==='ON' ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n                .prevState ==='ON' ? curr[0] - acc\r\n            .prevTime : 0)\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    })\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"ErrorAll=>\", e)\r\n    return value\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n    \r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.4899059853564838,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 'UTILIZATION';"
              }, {
                "name" : "Dom",
                "type" : "attribute",
                "label" : "Dom",
                "color" : "#4caf50",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return  convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState  ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1]) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    \r\n    const dateTitle = dataValue[0]?new Date(dataUtilization[0][0]):''\r\n    const columnTitle = `Dom (${dateTitle})`\r\n    console.log(\"columnTitle=>\", columnTitle)\r\n    \r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error0=>\", e)\r\n    return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.45096065743242697,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 0;"
              }, {
                "name" : "Lun",
                "type" : "attribute",
                "label" : "Lun",
                "color" : "#f44336",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState  ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1] ) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState  ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState  ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    const dateTitle = dataValue[0]?new Date(dataValue[0][0]):''\r\n    const columnTitle = `Dom (${dateTitle})`\r\n    console.log(\"columnTitle=>\", columnTitle)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error1=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.8205840952316434,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 1;"
              }, {
                "name" : "Mar",
                "type" : "attribute",
                "label" : "Mar",
                "color" : "#ffc107",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState  ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1] ) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState  ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState  ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error2=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.8622012724418704,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 2;"
              }, {
                "name" : "Mier",
                "type" : "attribute",
                "label" : "Mier",
                "color" : "#607d8b",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState  ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1] ) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState  ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState  ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error3=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.6219710318001674,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 3;"
              }, {
                "name" : "Jue",
                "type" : "attribute",
                "label" : "Jue",
                "color" : "#9c27b0",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1] ) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState  ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error4=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.1244370879750456,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 4;"
              }, {
                "name" : "Vie",
                "type" : "attribute",
                "label" : "Vie",
                "color" : "#3f51b5",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState  ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1]) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState  ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState  ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error5=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.8626190127525062,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 5;"
              }, {
                "name" : "Sab",
                "type" : "attribute",
                "label" : "Sab",
                "color" : "#8bc34a",
                "settings" : {
                  "columnWidth" : "0px",
                  "useCellStyleFunction" : false,
                  "useCellContentFunction" : true,
                  "cellContentFunction" : "let accData\r\ntry {\r\n    // console.log(\"entity=>\", ctx, )\r\n\r\n    const dataUtilization = ctx.$scope.entitiesTableWidget\r\n        .subscription.dataPages[0].data.find((arrData) => {\r\n            return arrData.some(({\r\n                    datasource,\r\n                    dataKey\r\n                }) => dataKey.label ==\r\n                'Utilización' &&\r\n                datasource.entityId == entity.id.id)\r\n        })\r\n    // console.log(\"dataUtilization=>\", dataUtilization)\r\n    if (!dataUtilization) return convertMsToHM(0);\r\n\r\n    let allDataValue = dataUtilization.find(({\r\n            datasource,\r\n            dataKey\r\n        }) => dataKey.label == 'Utilización' &&\r\n        datasource.entityId == entity.id.id)\r\n\r\n    let dataValue = allDataValue.data.filter((data) => {\r\n        return new Date(data[0]).getDay() == value\r\n    })\r\n\r\n    const prevDay = allDataValue.data.filter((data) => {\r\n        const compare = (\r\n            value - 1 == -1 ? 6 : value + 1)\r\n        return new Date(data[0]).getDay() == compare\r\n    })\r\n\r\n    let firtsElement = {\r\n        accHours: 0,\r\n        prevState: false,\r\n        prevTime: 0\r\n    }\r\n    let isBeforeDay = false\r\n    // console.log(\"DatePrevDay>\", prevDay)\r\n    const lastDataValue = dataValue[dataValue.length - 1]\r\n    if(!lastDataValue) return convertMsToHM(0)\r\n    const lastDay = new Date(lastDataValue[0])\r\n    let endOfDay = localStartOfDate(lastDay.getFullYear(),\r\n        lastDay.getMonth(), lastDay.getDate() + 1) - 1\r\n\r\n    if (prevDay.length) {\r\n        isBeforeDay = prevDay[prevDay.length - 1][0] <\r\n            dataValue[0][0]\r\n        const dateBefore = new Date(dataValue[dataValue.length - 1][0])\r\n\r\n        const startOfDate = localStartOfDate(dateBefore\r\n            .getFullYear(), dateBefore.getMonth(),\r\n            dateBefore.getDate())\r\n\r\n        firtsElement = isBeforeDay ? {\r\n            accHours: 0,\r\n            prevState: prevDay[prevDay.length - 1][1],\r\n            prevTime: startOfDate\r\n        } : firtsElement\r\n    }\r\n\r\n    dataValue = [...dataValue, [endOfDay, lastDataValue[1]]]\r\n\r\n    const lengtData = dataValue.length;\r\n    // console.log(\"DateFirts&End=>\", new Date(dataUtilization\r\n    //     .data[0][0]), new Date(dataUtilization.data[\r\n    //     lengtData - 1][0]))\r\n    accData = dataValue.reduce((acc, curr,\r\n        ind) => {\r\n        //firts call\r\n        if (ind == 0 && !isBeforeDay) {\r\n            // console.log(\"FirtsCall=>\", acc, curr,\r\n            //     ind)\r\n            return {\r\n                accHours: 0,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        //last call\r\n        if (ind == lengtData - 1) {\r\n            const accHours = acc.accHours + (acc\r\n                .prevState ? curr[0] -\r\n                acc\r\n                .prevTime : 0)\r\n            return {\r\n                accHours: accHours,\r\n                prevState: curr[1],\r\n                prevTime: curr[0]\r\n            }\r\n        }\r\n\r\n        if (curr[1] ) {\r\n            return {\r\n                accHours: acc.accHours,\r\n                prevState: curr[1],\r\n                prevTime: acc\r\n                    .prevState ? acc\r\n                    .prevTime : curr[0]\r\n            }\r\n        }\r\n\r\n\r\n        const accHours = acc.accHours + (acc\r\n            .prevState ? curr[0] - acc\r\n            .prevTime : 0)\r\n\r\n        return {\r\n            accHours: accHours,\r\n            prevState: curr[1],\r\n            prevTime: curr[0]\r\n        }\r\n\r\n\r\n    }, firtsElement)\r\n    // console.log(\"Value=>\", accData)\r\n    return accData ? convertMsToHM(accData.accHours) : value\r\n    /* code */\r\n} catch (e) {\r\n    console.log(\"Error6=>\", e)\r\n     return convertMsToHM(0)\r\n}\r\n\r\nconst MS_PER_SECOND = 1000,\r\n    MS_PER_MINUTE = 60 * MS_PER_SECOND,\r\n    MS_PER_HOUR = 60 * MS_PER_MINUTE,\r\n    MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\r\n\r\nfunction localStartOfDate(y, m, d) {\r\n    // the date constructor remaps years 0-99 to 1900-1999\r\n    if (y < 100 && y >= 0) {\r\n        // preserve leap years using a full 400 year cycle, then reset\r\n        return new Date(y + 400, m, d) - MS_PER_400_YEARS;\r\n    } else {\r\n        return new Date(y, m, d).valueOf();\r\n    }\r\n}\r\n\r\nfunction padTo2Digits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}\r\n\r\nfunction convertMsToHM(milliseconds) {\r\n    let seconds = Math.floor(milliseconds / 1000);\r\n    let minutes = Math.floor(seconds / 60);\r\n    let hours = Math.floor(minutes / 60);\r\n\r\n    seconds = seconds % 60;\r\n    // 👇️ if seconds are greater than 30, round minutes up (optional)\r\n    // minutes = seconds >= 30 ? minutes + 1 : minutes;\r\n\r\n    minutes = minutes % 60;\r\n\r\n    // 👇️ If you don't want to roll hours over, e.g. 24 to 00\r\n    // 👇️ comment (or remove) the line below\r\n    // commenting next line gets you `24:00:00` instead of `00:00:00`\r\n    // or `36:15:31` instead of `12:15:31`, etc.\r\n\r\n    //   hours = hours % 24;\r\n\r\n    return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(seconds)}`;\r\n}",
                  "defaultColumnVisibility" : "visible",
                  "columnSelectionToDisplay" : "enabled",
                  "columnExportOption" : "onlyVisible"
                },
                "_hash" : 0.5433024238851221,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return 6;"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "hideInterval" : false,
              "hideLastInterval" : false,
              "hideQuickInterval" : false,
              "hideAggregation" : false,
              "hideAggInterval" : false,
              "hideTimezone" : false,
              "selectedTab" : 1,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 1,
                "interval" : 600000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1714705200000,
                  "endTimeMs" : 1715309999999
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 10673
              },
              "timezone" : null
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "8px",
            "settings" : {
              "enableSearch" : false,
              "enableSelectColumnDisplay" : false,
              "enableStickyHeader" : true,
              "enableStickyAction" : true,
              "reserveSpaceForHiddenAction" : "true",
              "displayEntityName" : true,
              "entityNameColumnTitle" : "Dispositivo",
              "displayEntityLabel" : false,
              "displayEntityType" : false,
              "displayPagination" : false,
              "defaultSortOrder" : "entityName",
              "useRowStyleFunction" : false
            },
            "title" : "New Report stepper latest Value",
            "showTitleIcon" : false,
            "dropShadow" : true,
            "enableFullscreen" : true,
            "enableDataExport" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : "",
            "showLegend" : false,
            "titleTooltip" : "",
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : false,
            "displayTimewindow" : true
          },
          "row" : 0,
          "col" : 0,
          "id" : "64a168b2-a25e-2f36-2752-c3fdc063af62"
        },
        "86c075fa-8738-0e7f-333c-86b8ccc20a6b" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "weekly_heatmap23",
          "type" : "timeseries",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 11.5,
          "sizeY" : 7.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "CumulativeOperatingHours",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.5780837160803236
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              },
              "latestDataKeys" : [ ]
            } ],
            "timewindow" : {
              "hideInterval" : false,
              "hideAggregation" : false,
              "hideAggInterval" : false,
              "hideTimezone" : false,
              "selectedTab" : 1,
              "history" : {
                "historyType" : 0,
                "timewindowMs" : 604800000,
                "interval" : 3600000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1652037003619,
                  "endTimeMs" : 1652123403619
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "showDataInHeatmap" : true,
              "minScale" : 0,
              "maxScale" : 100,
              "numberOfDigits" : 0,
              "style" : "Green",
              "positionTitle" : "left"
            },
            "title" : "",
            "dropShadow" : false,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : false,
            "displayTimewindow" : false,
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "widgetCss" : "",
            "noDataDisplayMessage" : "",
            "showLegend" : false,
            "enableDataExport" : true,
            "pageSize" : 1024,
            "margin" : "0"
          },
          "row" : 0,
          "col" : 0,
          "id" : "86c075fa-8738-0e7f-333c-86b8ccc20a6b"
        },
        "354701dd-c0a9-3833-cf80-ef078ff3d085" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "weekly_heatmap2",
          "type" : "timeseries",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 11.5,
          "sizeY" : 7.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "2ee511d4-4bb1-9250-3c88-44f2accf70c6",
              "dataKeys" : [ {
                "name" : "ExtPowInputQualifiedValue",
                "type" : "timeseries",
                "label" : "ExtPowInputQualifiedValue",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.8717718722418522,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : true,
                "postFuncBody" : "return value==='ON';"
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              },
              "latestDataKeys" : [ ]
            } ],
            "timewindow" : {
              "hideInterval" : false,
              "hideAggregation" : false,
              "hideAggInterval" : false,
              "hideTimezone" : false,
              "selectedTab" : 1,
              "history" : {
                "historyType" : 0,
                "timewindowMs" : 604800000,
                "interval" : 3600000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1652037003619,
                  "endTimeMs" : 1652123403619
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "4px",
            "settings" : {
              "showDataInHeatmap" : true,
              "minScale" : 0,
              "maxScale" : 100,
              "numberOfDigits" : 0,
              "style" : "Green",
              "positionTitle" : "left"
            },
            "title" : "New TwinDimension Usage Chart",
            "dropShadow" : false,
            "enableFullscreen" : true,
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "useDashboardTimewindow" : false,
            "displayTimewindow" : false,
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "widgetCss" : "",
            "noDataDisplayMessage" : "",
            "showLegend" : false,
            "enableDataExport" : true,
            "pageSize" : 1024,
            "margin" : "0"
          },
          "row" : 0,
          "col" : 0,
          "id" : "354701dd-c0a9-3833-cf80-ef078ff3d085"
        },
        "9bf24b01-47c7-77e0-1265-899c997cad21" : {
          "isSystemType" : true,
          "bundleAlias" : "cards",
          "typeAlias" : "markdown_card",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 5,
          "sizeY" : 3.5,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
              "filterId" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
              "dataKeys" : [ {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "DataOrigin",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.18329989179022776
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1719849650990,
                  "endTimeMs" : 1719936050990
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "0px",
            "settings" : {
              "useMarkdownTextFunction" : true,
              "markdownTextFunction" : "const objOnOff = {\n    GT1030:true,\n    GT1200:true\n}\n\nconst isOnOffChart = objOnOff[data[0].DataOrigin]; \n\nconst dashboardState = `<tb-dashboard-state class=\"tables-att\" fxFlex [ctx]=\"ctx\" [syncParentStateParams]=\"true\" stateId=${isOnOffChart?\"chart_utilization_on_off\":\"chart_utilization_cumulative\"}></tb-dashboard-state>`\n\nreturn `<div fxFlex fxLayout=\"column\" style=\"width: 100%; height: 100%; padding: 0;\">\n        ${dashboardState}\n    </div>`;",
              "applyDefaultMarkdownStyle" : true
            },
            "title" : "New Markdown/HTML Card",
            "showTitleIcon" : false,
            "iconColor" : "rgba(0, 0, 0, 0.87)",
            "iconSize" : "24px",
            "titleTooltip" : "",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "showLegend" : false,
            "useDashboardTimewindow" : true,
            "enableDataExport" : false,
            "widgetCss" : "",
            "pageSize" : 1024,
            "noDataDisplayMessage" : ""
          },
          "row" : 0,
          "col" : 0,
          "id" : "9bf24b01-47c7-77e0-1265-899c997cad21"
        },
        "9d5134ec-6217-b575-9d8c-7699edbe13bc" : {
          "isSystemType" : true,
          "bundleAlias" : "rds_widget_collection",
          "typeAlias" : "vanilla_tree",
          "type" : "latest",
          "title" : "New widget",
          "image" : null,
          "description" : null,
          "sizeX" : 8.5,
          "sizeY" : 10,
          "config" : {
            "datasources" : [ {
              "type" : "entity",
              "name" : null,
              "entityAliasId" : "76a00318-874f-227a-cd4b-d81a7f8f1a6c",
              "filterId" : null,
              "dataKeys" : [ {
                "name" : "CumulativeOperatingHours",
                "type" : "timeseries",
                "label" : "horometer",
                "color" : "#2196f3",
                "settings" : { },
                "_hash" : 0.6022813818747106,
                "aggregationType" : "NONE",
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "name",
                "type" : "entityField",
                "label" : "Name",
                "color" : "#4caf50",
                "settings" : { },
                "_hash" : 0.3373644932021722
              }, {
                "name" : "type",
                "type" : "entityField",
                "label" : "Tipo",
                "color" : "#f44336",
                "settings" : { },
                "_hash" : 0.4092648796348277,
                "aggregationType" : null,
                "units" : null,
                "decimals" : null,
                "funcBody" : null,
                "usePostProcessing" : null,
                "postFuncBody" : null
              }, {
                "name" : "DataOrigin",
                "type" : "attribute",
                "label" : "DataOrigin",
                "color" : "#ffc107",
                "settings" : { },
                "_hash" : 0.16292436804194477
              }, {
                "name" : "active",
                "type" : "attribute",
                "label" : "active",
                "color" : "#607d8b",
                "settings" : { },
                "_hash" : 0.46420646295314927
              }, {
                "name" : "internalName",
                "type" : "attribute",
                "label" : "internalName",
                "color" : "#9c27b0",
                "settings" : { },
                "_hash" : 0.1167731507295442
              }, {
                "name" : "img",
                "type" : "attribute",
                "label" : "img",
                "color" : "#8bc34a",
                "settings" : { },
                "_hash" : 0.44672589887254155
              } ],
              "alarmFilterConfig" : {
                "statusList" : [ "ACTIVE" ]
              }
            } ],
            "timewindow" : {
              "displayValue" : "",
              "selectedTab" : 0,
              "realtime" : {
                "realtimeType" : 1,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "quickInterval" : "CURRENT_DAY"
              },
              "history" : {
                "historyType" : 0,
                "interval" : 1000,
                "timewindowMs" : 60000,
                "fixedTimewindow" : {
                  "startTimeMs" : 1720031267548,
                  "endTimeMs" : 1720117667548
                },
                "quickInterval" : "CURRENT_DAY"
              },
              "aggregation" : {
                "type" : "AVG",
                "limit" : 25000
              }
            },
            "showTitle" : false,
            "backgroundColor" : "#fff",
            "color" : "rgba(0, 0, 0, 0.87)",
            "padding" : "8px",
            "settings" : {
              "templateSelector" : {
                "selector" : "zzzz"
              },
              "templates" : [ {
                "name" : "FLEET",
                "function" : "// const childrenCount = node.children ? node.children.filter(n=>n.isFolder!=true).length : 0\r\nconst childrenCount = countChildren(node)\r\n\r\nreturn html`\r\n    <div class=\"folder-card-wrapper\">\r\n        <span>${node.text}</span>\r\n        ${childrenCount ? html`<span class=\"counter\">${childrenCount}</span>`: ''}\r\n    </div>\r\n    <div class=\"tx-search-clues\">${node.id} ${node.text}</div>\r\n`;\r\n\r\nfunction countChildren(node) {\r\n    try {\r\n        /* code */\r\n        if(!node.children) return 0\r\n  \r\n        let count = node.children.filter(n=>!n.isFolder).length;\r\n    \r\n      // Recorrer cada hijo y sumar el conteo de sus hijos recursivamente\r\n        for (const child of node.children) {\r\n            count += countChildren(child);\r\n         }\r\n        \r\n        return count;\r\n    } catch (e) {\r\n        return 0\r\n    }\r\n  \r\n}"
              }, {
                "function" : "const hs = node.data.horometer ? parseFloat(node.data.horometer).toFixed(1) + ' hs' : '--';\r\nconst defaultImg = 'https://vdms.tesacom.net/images/markers/pixi/komatsu/full/default.png'\r\nlet img \r\ntry {\r\n    img = JSON.parse(node.data.img);\r\n    //console.log(img)\r\n    img = img ? img.src : defaultImg;\r\n}\r\ncatch(err){\r\n    img = defaultImg\r\n}\r\nconst textName = node.data.internalName?node.data.internalName:node.text\r\nreturn html`\r\n    <div class=\"card-wrapper\">\r\n        <div class=\"card-image\">\r\n            <img src=\"${img}\" />\r\n        </div>\r\n        <div class=\"card-content\">\r\n            <p><b>${textName}</b></p>\r\n            <p>${node.data.Tipo}</p>\r\n            <p>Uso: ${hs}</p>\r\n        </div>\r\n        <div class=\"card-info\" title=\"Details...\">\r\n            <i class=\"fa fa-info-circle fa-2x\"></i>\r\n        </div>\r\n    </div>\r\n    <div class=\"tx-search-clues\">\r\n        ${node.id} ${node.text} ${node.data.Tipo} ${node.data.DataOrigin}\r\n    </div>\r\n`;",
                "name" : "MACHINE"
              } ]
            },
            "title" : "Tree",
            "useDashboardTimewindow" : true,
            "actions" : {
              "folderNodeSelected" : [ ],
              "leafNodeSelected" : [ ],
              "nodeSelected" : [ {
                "name" : "set data for map",
                "icon" : "more_horiz",
                "useShowWidgetActionFunction" : null,
                "showWidgetActionFunction" : "return true;",
                "type" : "custom",
                "customFunction" : "const { target } = $event.detail\r\n//console.log(\"Accion > \", entityId, entityName, entityLabel)\r\nconst params = widgetContext.stateController.getStateParams()\r\n\r\nconst openViewDetail = target.classList.contains(\"fa-info-circle\") ? true : false // info button\r\nlet internalName = ''\r\ntry {\r\n    /* code */\r\n    internalName = widgetContext.$scope.rawTreeData[entityId.id].data.internalName;\r\n} catch (e) {\r\n    console.log(\"hierarchyActionError=>\",e)\r\n}\r\n \r\nconst data_map = {entityId, entityName, entityLabel}\r\n\r\nconst hydrateParams = {\r\n    ...params,\r\n    viewMap: \"map\",\r\n    only_selected: {\r\n        entityId,\r\n        entityName,\r\n        entityLabel,\r\n        internalName\r\n    },\r\n    openViewDetail,\r\n    data_map\r\n}\r\n\r\nwidgetContext.stateController.updateState(null, hydrateParams,)\r\n",
                "openInSeparateDialog" : false,
                "openInPopover" : false,
                "id" : "f050aa8a-470b-4981-87bc-e0fd872ddb35"
              } ]
            },
            "showTitleIcon" : false,
            "titleTooltip" : "",
            "dropShadow" : true,
            "enableFullscreen" : false,
            "enableDataExport" : false,
            "widgetStyle" : {
              "borderRadius" : ".75rem"
            },
            "widgetCss" : "",
            "titleStyle" : {
              "fontSize" : "16px",
              "fontWeight" : 400
            },
            "pageSize" : null,
            "noDataDisplayMessage" : "",
            "showLegend" : false
          },
          "row" : 0,
          "col" : 0,
          "id" : "9d5134ec-6217-b575-9d8c-7699edbe13bc"
        }
      },
      "states" : {
        "default" : {
          "name" : "Main Dashboard",
          "root" : true,
          "layouts" : {
            "main" : {
              "widgets" : {
                "52babaef-733d-c2fc-4ee2-d30d7985980f" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 0,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%",
                "autoFillHeight" : true,
                "backgroundImageUrl" : null,
                "mobileAutoFillHeight" : false,
                "mobileRowHeight" : 70
              }
            }
          }
        },
        "view_report" : {
          "name" : "view report",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "64a168b2-a25e-2f36-2752-c3fdc063af62" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "detail_switch_type" : {
          "name" : "Detail switch type",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "af660201-4530-a4c2-29d9-f81ea94f331e" : {
                  "sizeX" : 24,
                  "sizeY" : 24,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 0,
                "outerMargin" : false,
                "backgroundSizeMode" : "100%",
                "autoFillHeight" : false,
                "backgroundImageUrl" : null,
                "mobileAutoFillHeight" : false,
                "mobileRowHeight" : 70
              }
            }
          }
        },
        "view_container" : {
          "name" : "View container",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "a2487dca-2519-923b-63b0-086d190be70f" : {
                  "sizeX" : 17,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 7
                },
                "9d5134ec-6217-b575-9d8c-7699edbe13bc" : {
                  "sizeX" : 7,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%",
                "autoFillHeight" : false,
                "backgroundImageUrl" : null,
                "mobileAutoFillHeight" : false,
                "mobileRowHeight" : 70
              }
            }
          }
        },
        "view_map" : {
          "name" : "View map",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "d8ae6266-8c01-91a7-4a59-8e6c2979bc32" : {
                  "sizeX" : 24,
                  "sizeY" : 15,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 0,
                "outerMargin" : false,
                "backgroundSizeMode" : "100%",
                "autoFillHeight" : false,
                "backgroundImageUrl" : null,
                "mobileAutoFillHeight" : false,
                "mobileRowHeight" : 70
              }
            }
          }
        },
        "view_grid" : {
          "name" : "View grid",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "0adca16a-2722-8d11-8c71-b6e96961e129" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "devices_grid" : {
          "name" : "Devices grid",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "c4138fda-5287-fa53-8685-a2487b481653" : {
                  "sizeX" : 25,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "device_grid" : {
          "name" : "Device grid",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "92822386-9475-e891-b243-04dee6cf830d" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "detail_default_general" : {
          "name" : "Detail default general",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "954e4e7b-5605-94cf-fcb3-2fe51a5b6e36" : {
                  "sizeX" : 26,
                  "sizeY" : 22,
                  "row" : 11,
                  "col" : 0
                },
                "daca4f4d-fa6e-c376-a988-05cb822fcc1f" : {
                  "sizeX" : 26,
                  "sizeY" : 4,
                  "row" : 7,
                  "col" : 0
                },
                "234ee92b-317f-4aa6-0666-ece734898b21" : {
                  "sizeX" : 26,
                  "sizeY" : 7,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "detail_default_monitoring" : {
          "name" : "Detail default monitoring",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "e2925909-9ebe-a8cf-5fda-6901c4f33950" : {
                  "sizeX" : 24,
                  "sizeY" : 6,
                  "row" : 5,
                  "col" : 0
                },
                "9bf24b01-47c7-77e0-1265-899c997cad21" : {
                  "sizeX" : 24,
                  "sizeY" : 5,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%",
                "autoFillHeight" : false,
                "backgroundImageUrl" : null,
                "mobileAutoFillHeight" : false,
                "mobileRowHeight" : 70
              }
            }
          }
        },
        "detail_default_alarms" : {
          "name" : "Detail default alarms",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "01bc3ab6-adf2-3321-7570-67b83df8f5f0" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "telemetry_table_default" : {
          "name" : "Telemetry table default",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "45eae83c-0276-1612-2b51-5b753cdead41" : {
                  "sizeX" : 25,
                  "sizeY" : 10,
                  "row" : 11,
                  "col" : 0
                },
                "c018ab1f-8d4d-6619-0430-b3b8ecab9832" : {
                  "sizeX" : 25,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "chart_utilization_on_off" : {
          "name" : "chart utilization on off",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "354701dd-c0a9-3833-cf80-ef078ff3d085" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        },
        "chart_utilization_cumulative" : {
          "name" : "chart utilization cumulative",
          "root" : false,
          "layouts" : {
            "main" : {
              "widgets" : {
                "86c075fa-8738-0e7f-333c-86b8ccc20a6b" : {
                  "sizeX" : 24,
                  "sizeY" : 11,
                  "row" : 0,
                  "col" : 0
                }
              },
              "gridSettings" : {
                "backgroundColor" : "#eeeeee",
                "columns" : 24,
                "margin" : 10,
                "outerMargin" : true,
                "backgroundSizeMode" : "100%"
              }
            }
          }
        }
      },
      "entityAliases" : {
        "76a00318-874f-227a-cd4b-d81a7f8f1a6c" : {
          "id" : "76a00318-874f-227a-cd4b-d81a7f8f1a6c",
          "alias" : "Hierarchy",
          "filter" : {
            "type" : "relationsQuery",
            "resolveMultiple" : true,
            "rootStateEntity" : false,
            "stateEntityParamName" : null,
            "defaultStateEntity" : null,
            "rootEntity" : {
              "entityType" : "TENANT",
              "id" : "7f7de250-2fb0-11ee-bf45-a1705d89a055"
            },
            "direction" : "FROM",
            "maxLevel" : 1,
            "fetchLastLevelOnly" : false,
            "filters" : [ ]
          }
        },
        "741f1e9c-6259-607c-2b24-c272575d286b" : {
          "id" : "741f1e9c-6259-607c-2b24-c272575d286b",
          "alias" : "Data for map",
          "filter" : {
            "type" : "relationsQuery",
            "resolveMultiple" : true,
            "rootStateEntity" : true,
            "stateEntityParamName" : "data_map",
            "defaultStateEntity" : {
              "entityType" : "ASSET",
              "id" : "66c93d30-177d-11ef-8a81-796b974d7f03"
            },
            "rootEntity" : null,
            "direction" : "FROM",
            "maxLevel" : 4,
            "fetchLastLevelOnly" : false,
            "filters" : [ ]
          }
        },
        "6cc30c8f-01d7-835c-9a45-25d0198ec8d1" : {
          "id" : "6cc30c8f-01d7-835c-9a45-25d0198ec8d1",
          "alias" : "Only selected",
          "filter" : {
            "type" : "stateEntity",
            "resolveMultiple" : true,
            "stateEntityParamName" : "only_selected",
            "defaultStateEntity" : null
          }
        },
        "f45aaaea-6d34-fd34-3586-fbc04f3b37fb" : {
          "id" : "f45aaaea-6d34-fd34-3586-fbc04f3b37fb",
          "alias" : "Root detail machine",
          "filter" : {
            "type" : "relationsQuery",
            "resolveMultiple" : true,
            "rootStateEntity" : true,
            "stateEntityParamName" : "data_map",
            "defaultStateEntity" : null,
            "rootEntity" : null,
            "direction" : "TO",
            "maxLevel" : 6,
            "fetchLastLevelOnly" : false,
            "filters" : [ {
              "relationType" : "Contains",
              "entityTypes" : [ "ASSET", "CUSTOMER", "TENANT" ]
            } ]
          }
        },
        "e7c6b536-cdae-4d5d-8396-93092ee237e9" : {
          "id" : "e7c6b536-cdae-4d5d-8396-93092ee237e9",
          "alias" : "Device relation - data map",
          "filter" : {
            "type" : "relationsQuery",
            "resolveMultiple" : true,
            "rootStateEntity" : true,
            "stateEntityParamName" : "data_map",
            "defaultStateEntity" : {
              "entityType" : "ASSET",
              "id" : "8600d8f0-525e-11ee-bf45-a1705d89a055"
            },
            "rootEntity" : null,
            "direction" : "FROM",
            "maxLevel" : 4,
            "fetchLastLevelOnly" : false,
            "filters" : [ {
              "relationType" : "Contains",
              "entityTypes" : [ "DEVICE" ]
            } ]
          }
        },
        "c94e8b2a-109d-09c3-ac23-74fd1d407796" : {
          "id" : "c94e8b2a-109d-09c3-ac23-74fd1d407796",
          "alias" : "Hierarchy - NQN",
          "filter" : {
            "type" : "entityGroup",
            "resolveMultiple" : true,
            "groupStateEntity" : false,
            "stateEntityParamName" : null,
            "defaultStateGroupType" : null,
            "defaultStateEntityGroup" : null,
            "groupType" : "DEVICE",
            "entityGroup" : "38e19990-bb79-11ee-bc30-01172cc92ac6"
          }
        },
        "65043352-2f91-c5ad-db1f-ba0b3d988791" : {
          "id" : "65043352-2f91-c5ad-db1f-ba0b3d988791",
          "alias" : "Hierarchy - ALL",
          "filter" : {
            "type" : "entityGroup",
            "resolveMultiple" : true,
            "groupStateEntity" : false,
            "stateEntityParamName" : null,
            "defaultStateGroupType" : null,
            "defaultStateEntityGroup" : null,
            "groupType" : "DEVICE",
            "entityGroup" : "5b9f5690-4c14-11ee-bf45-a1705d89a055"
          }
        },
        "7401cabf-4c5b-209f-2005-c1c486e3861a" : {
          "id" : "7401cabf-4c5b-209f-2005-c1c486e3861a",
          "alias" : "report data",
          "filter" : {
            "type" : "relationsQuery",
            "resolveMultiple" : true,
            "rootStateEntity" : false,
            "stateEntityParamName" : null,
            "defaultStateEntity" : null,
            "rootEntity" : {
              "entityType" : "ASSET",
              "id" : "66c93d30-177d-11ef-8a81-796b974d7f03"
            },
            "direction" : "FROM",
            "maxLevel" : 4,
            "fetchLastLevelOnly" : false,
            "filters" : [ ]
          }
        },
        "e05bfbaf-03ad-51a6-36c9-039f5a58be72" : {
          "id" : "e05bfbaf-03ad-51a6-36c9-039f5a58be72",
          "alias" : "Hierarchy test",
          "filter" : {
            "type" : "singleEntity",
            "resolveMultiple" : false,
            "singleEntity" : {
              "entityType" : "TENANT",
              "id" : "7f7de250-2fb0-11ee-bf45-a1705d89a055"
            }
          }
        }
      },
      "filters" : {
        "2ee511d4-4bb1-9250-3c88-44f2accf70c6" : {
          "id" : "2ee511d4-4bb1-9250-3c88-44f2accf70c6",
          "filter" : "only machines",
          "keyFilters" : [ {
            "key" : {
              "type" : "ENTITY_FIELD",
              "key" : "type"
            },
            "valueType" : "STRING",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "OR",
                "predicates" : [ {
                  "keyFilterPredicate" : {
                    "operation" : "EQUAL",
                    "value" : {
                      "defaultValue" : "medium_generator",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "EQUAL",
                    "value" : {
                      "defaultValue" : "standard_electrocompressor",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "EQUAL",
                    "value" : {
                      "defaultValue" : "compressor_standard",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "EQUAL",
                    "value" : {
                      "defaultValue" : "standard_generator",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                } ],
                "type" : "COMPLEX"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        },
        "e919afbe-e4d1-892f-a7ad-e1e983d33991" : {
          "id" : "e919afbe-e4d1-892f-a7ad-e1e983d33991",
          "filter" : "only device",
          "keyFilters" : [ {
            "key" : {
              "type" : "ENTITY_FIELD",
              "key" : "entityType"
            },
            "valueType" : "STRING",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "EQUAL",
                "value" : {
                  "defaultValue" : "DEVICE",
                  "dynamicValue" : null
                },
                "ignoreCase" : false,
                "type" : "STRING"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        },
        "12623c88-c614-4efb-9188-0150e34f693d" : {
          "id" : "12623c88-c614-4efb-9188-0150e34f693d",
          "filter" : "only device and sites",
          "keyFilters" : [ {
            "key" : {
              "type" : "ENTITY_FIELD",
              "key" : "type"
            },
            "valueType" : "STRING",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "AND",
                "predicates" : [ {
                  "keyFilterPredicate" : {
                    "operation" : "NOT_EQUAL",
                    "value" : {
                      "defaultValue" : "medium_generator",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "NOT_EQUAL",
                    "value" : {
                      "defaultValue" : "standard_electrocompressor",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "NOT_EQUAL",
                    "value" : {
                      "defaultValue" : "compressor_standard",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                }, {
                  "keyFilterPredicate" : {
                    "operation" : "NOT_EQUAL",
                    "value" : {
                      "defaultValue" : "standard_generator",
                      "dynamicValue" : null
                    },
                    "ignoreCase" : false,
                    "type" : "STRING"
                  },
                  "userInfo" : {
                    "editable" : true,
                    "label" : "",
                    "autogeneratedLabel" : true,
                    "order" : 0
                  }
                } ],
                "type" : "COMPLEX"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        },
        "6b858580-05c8-7094-3062-4df3aa90dca7" : {
          "id" : "6b858580-05c8-7094-3062-4df3aa90dca7",
          "filter" : "Only alarms",
          "keyFilters" : [ {
            "key" : {
              "type" : "ATTRIBUTE",
              "key" : "state"
            },
            "valueType" : "STRING",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "EQUAL",
                "value" : {
                  "defaultValue" : "",
                  "dynamicValue" : {
                    "sourceType" : "CURRENT_USER",
                    "sourceAttribute" : "criticaAlarm",
                    "inherit" : false
                  }
                },
                "ignoreCase" : false,
                "type" : "STRING"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        },
        "09ed77ea-73af-2758-07bb-c77b2930b8c1" : {
          "id" : "09ed77ea-73af-2758-07bb-c77b2930b8c1",
          "filter" : "Only device with alarms",
          "keyFilters" : [ {
            "key" : {
              "type" : "ENTITY_FIELD",
              "key" : "alarms"
            },
            "valueType" : "BOOLEAN",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "EQUAL",
                "value" : {
                  "defaultValue" : true,
                  "dynamicValue" : null
                },
                "type" : "BOOLEAN"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        },
        "2ee4b67f-6953-531c-2b88-171bb5ef036d" : {
          "id" : "2ee4b67f-6953-531c-2b88-171bb5ef036d",
          "filter" : "dinamic filter",
          "keyFilters" : [ {
            "key" : {
              "type" : "ENTITY_FIELD",
              "key" : "name"
            },
            "valueType" : "STRING",
            "predicates" : [ {
              "keyFilterPredicate" : {
                "operation" : "IN",
                "value" : {
                  "defaultValue" : "01072039SKYD480",
                  "dynamicValue" : null
                },
                "ignoreCase" : false,
                "type" : "STRING"
              },
              "userInfo" : {
                "editable" : true,
                "label" : "",
                "autogeneratedLabel" : true,
                "order" : 0
              }
            } ]
          } ],
          "editable" : false
        }
      },
      "timewindow" : {
        "hideInterval" : false,
        "hideLastInterval" : false,
        "hideQuickInterval" : false,
        "hideAggregation" : false,
        "hideAggInterval" : false,
        "hideTimezone" : false,
        "selectedTab" : 0,
        "realtime" : {
          "realtimeType" : 0,
          "timewindowMs" : 7200000,
          "quickInterval" : "CURRENT_DAY",
          "interval" : 1800000
        },
        "aggregation" : {
          "type" : "NONE",
          "limit" : 25000
        },
        "timezone" : null
      },
      "settings" : {
        "stateControllerId" : "entity",
        "showTitle" : false,
        "showDashboardsSelect" : true,
        "showEntitiesSelect" : true,
        "showDashboardTimewindow" : true,
        "showDashboardExport" : true,
        "toolbarAlwaysOpen" : true
      }
    },
    "customerId" : null,
    "externalId" : null,
    "id" : {
      "entityType" : "DASHBOARD",
      "id" : "e89800b0-176b-11ef-8a81-796b974d7f03"
    },
    "image" : null,
    "mobileHide" : false,
    "mobileOrder" : null,
    "name" : "Sullair app (Admin)",
    "ownerId" : null,
    "title" : "Sullair app (Admin)"
  },
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}